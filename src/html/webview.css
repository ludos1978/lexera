:root {
  --whitespace: 16px;
  --whitespace-mul2: calc(var(--whitespace) * 2);
  --whitespace-div2: calc(var(--whitespace) / 2);
  --whitespace-div4: calc(var(--whitespace) / 4);
  --whitespace-div8: calc(var(--whitespace) / 8);
  --task-height: auto;
  --column-width: 450px;
  --collapsed-column-width: 40px;

  /* Z-index layers for consistent stacking */
  --z-base: 1;
  --z-overlay-button: 10;
  --z-corner-badge: 100;
  --z-dropdown: 1000;
  --z-modal: 10000;
  --z-modal-overlay: 10001;
  --z-search-modal: 100001;

  /* Task and section highlight colors */
  --task-focus-color: gray;
  --section-focus-color: gray;

  /* Week tag highlighting */
  --current-week-highlight-color: #ff0000;
  --current-week-border-width: 3px;
  --current-week-border-style: solid;
  --current-week-glow-size: 0 0 10px;

  --board-background: var(--vscode-editor-background);
  --column-background: var(--vscode-editor-background);
  --task-background: var(--vscode-editor-background);

  /* Primary Button Styles */
  --button-background: var(--vscode-button-background);
  --button-foreground: var(--vscode-button-foreground);
  --button-border: 1px solid var(--vscode-button-border, transparent);
  --button-background-hover: var(--vscode-button-hoverBackground);
  --button-foreground-hover: var(--vscode-button-foreground);
  --button-background-active: var(--vscode-button-background);
  --button-foreground-active: var(--vscode-button-foreground);
  --button-border-active: 1px solid var(--vscode-inputValidation-infoBorder, transparent);

  /* Secondary Button Styles */
  --button-secondary-background: var(--vscode-button-secondaryBackground);
  --button-secondary-foreground: var(--vscode-button-secondaryForeground);
  --button-secondary-border: 1px solid var(--vscode-button-border, transparent);
  --button-secondary-background-hover: var(--vscode-button-secondaryHoverBackground);

  /* Alternative Button Styles (for drag handles and card sources) */
  --button-alternative-background: var(--vscode-button-secondaryBackground);
  --button-alternative-foreground: var(--vscode-button-secondaryForeground);
  --button-alternative-border: 1px solid var(--vscode-button-border, transparent);
  --button-alternative-background-hover: var(--vscode-button-secondaryHoverBackground);
  --button-alternative-foreground-hover: var(--vscode-button-secondaryForeground);
  --button-alternative-border-hover: 1px solid var(--vscode-button-border, transparent);
  --button-alternative-background-active: var(--vscode-button-secondaryBackground);
  --button-alternative-foreground-active: var(--vscode-button-secondaryForeground);
  --button-alternative-border-active: 1px solid var(--vscode-inputValidation-infoBorder, transparent);
}

body {
  font-family: var(--vscode-font-family);
  color: var(--vscode-foreground);
  background-color: var(--board-color, var(--board-background));
  margin: 0;
  padding: 0;
  overflow: hidden; /* Prevent body scroll - container handles it */
  height: 100vh;

  transform-style: preserve-3d;
  perspective: 9999px;
}

/* File info bar - fixed at top */
.file-info-bar {
  background-color: var(--board-color, var(--board-background));
  border-bottom: 1px solid var(--vscode-panel-border);
  padding: var(--whitespace-div2);
  position: fixed;
  z-index: 100;
  top: 0;
  left: 0;
  right: 0;
  /* Container query support for responsive text hiding */
  container-type: inline-size;
  container-name: file-info-bar;
}

/* Hidden utility class */
.hidden {
  display: none !important;
}

/* Faded/disabled visual state */
.faded {
  opacity: 0.5;
}

/* Disabled section styling */
.disabled-section {
  opacity: 0.5;
  pointer-events: none;
}

.disabled-section input,
.disabled-section select,
.disabled-section button {
  cursor: not-allowed;
}

/* Base styling for overlay containers */
.image-path-overlay-container,
.video-path-overlay-container {
  display: inline-block;
  position: relative;
}

/* Color variants - Overlay (semi-transparent buttons on content) */
/* Shared base for ALL overlay menu buttons: image, video, diagram, include */
.btn-overlay-icon,
.image-path-overlay-container .image-menu-btn,
.video-path-overlay-container .video-menu-btn,
.diagram-overlay-container .diagram-menu-btn,
.include-path-overlay-container .include-menu-btn {
  position: absolute;
  top: 2px;
  right: 2px;
  width: 18px;
  height: 18px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 4px;
  color: white;
  font-size: 14px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
  z-index: 10;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn-overlay-icon:hover,
.image-path-overlay-container .image-menu-btn:hover,
.video-path-overlay-container .video-menu-btn:hover,
.diagram-overlay-container .diagram-menu-btn:hover,
.include-path-overlay-container .include-menu-btn:hover {
  background: rgba(0, 0, 0, 0.8);
}

/* Show on hover */
.image-path-overlay-container:hover .image-menu-btn,
.video-path-overlay-container:hover .video-menu-btn,
.diagram-overlay-container:hover .diagram-menu-btn,
.include-path-overlay-container:hover .include-menu-btn,
/* Diagram placeholders wrap the overlay container, so need to show button when hovering on placeholder */
.diagram-placeholder:hover .image-menu-btn {
  opacity: 1;
}

/* ============================================================================
   UNIFIED ERROR STYLING - All broken/error elements use the same appearance
   ============================================================================ */

/* Unified error text color for all broken link text */
.include-path-overlay-container.include-broken .columninclude-link,
.include-path-overlay-container.include-broken .include-filename-link,
.link-path-overlay-container.link-broken .markdown-link {
  color: var(--vscode-errorForeground, #f48771) !important;
}

/* Unified ERROR state for all broken/not-found menu buttons - FULL styling */
/* Overlay containers with .xxx-broken class */
.image-path-overlay-container.image-broken .image-menu-btn,
.video-path-overlay-container.video-broken .video-menu-btn,
.include-path-overlay-container.include-broken .include-menu-btn,
.link-path-overlay-container.link-broken .link-menu-btn,
/* Standalone not-found containers */
.image-not-found .image-menu-btn,
.video-not-found .video-menu-btn,
.link-not-found .link-menu-btn,
.include-not-found .include-menu-btn,
/* Legacy include-error patterns */
.include-error .include-path-overlay-container .include-menu-btn,
.include-container.include-error .include-path-overlay-container .include-menu-btn,
.kanban-full-height-column.include-error .include-path-overlay-container .include-menu-btn,
.card-item.include-error .include-path-overlay-container .include-menu-btn {
  position: absolute !important;
  top: 3px !important;
  right: 3px !important;
  width: 18px !important;
  height: 18px !important;
  margin: 0 !important;
  opacity: 1 !important;
  background: var(--vscode-errorBackground, rgba(255, 0, 0, 0.3)) !important;
  border: 1px solid var(--vscode-errorBorder, rgba(255, 0, 0, 0.4)) !important;
  border-radius: 3px !important;
  color: var(--vscode-errorForeground, #f48771) !important;
  font-size: 12px !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  outline: none !important;
  outline-offset: 0 !important;
}

/* Hover states for broken/not-found menu buttons */
/* Overlay containers with .xxx-broken class */
.image-path-overlay-container.image-broken .image-menu-btn:hover,
.video-path-overlay-container.video-broken .video-menu-btn:hover,
.include-path-overlay-container.include-broken .include-menu-btn:hover,
.link-path-overlay-container.link-broken .link-menu-btn:hover,
/* Standalone not-found containers */
.image-not-found .image-menu-btn:hover,
.video-not-found .video-menu-btn:hover,
.link-not-found .link-menu-btn:hover,
.include-not-found .include-menu-btn:hover,
/* Legacy include-error patterns */
.include-error .include-path-overlay-container .include-menu-btn:hover,
.include-container.include-error .include-path-overlay-container .include-menu-btn:hover,
.kanban-full-height-column.include-error .include-path-overlay-container .include-menu-btn:hover,
.card-item.include-error .include-path-overlay-container .include-menu-btn:hover {
  background: var(--vscode-errorBackground, rgba(255, 0, 0, 0.5)) !important;
}

/* ============================================
   UTILITY CLASSES
   Common reusable patterns
   ============================================ */

/* Flexbox utilities */
.flex { display: flex; }
.flex-inline { display: inline-flex; }
.flex-col { flex-direction: column; }
.flex-wrap { flex-wrap: wrap; }
.items-center { align-items: center; }
.items-start { align-items: flex-start; }
.items-end { align-items: flex-end; }
.justify-center { justify-content: center; }
.justify-between { justify-content: space-between; }
.justify-end { justify-content: flex-end; }

/* Gap utilities */
.gap-1 { gap: 4px; }
.gap-2 { gap: 8px; }
.gap-3 { gap: 12px; }
.gap-4 { gap: 16px; }

/* Transition utilities */
.transition-smooth {
  transition: all 0.15s ease;
}

.transition-colors {
  transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease;
}

/* Text utilities */
.text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.text-center { text-align: center; }
.text-right { text-align: right; }
.font-bold { font-weight: bold; }
.font-medium { font-weight: 500; }

/* Visibility */
.invisible { visibility: hidden; }
.pointer-events-none { pointer-events: none; }

.file-info-content {
  display: grid;
  /* Left: flexible but prefers natural size, Center: flexible with min width to prevent sudden collapse, Right: auto (natural size) */
  grid-template-columns: minmax(0, auto) minmax(120px, 1fr) auto;
  align-items: center;
  height: 100%;
  gap: 8px;
}

.file-info-left {
  display: flex;
  align-items: center;
  gap: 6px;
  min-width: 0;
  overflow: hidden;
  flex-shrink: 1;
}

.file-bar-spacer {
  width: 1px;
  height: 16px;
  background: var(--vscode-panel-border, #444);
  margin: 0 4px;
  flex-shrink: 0;
}

.file-info-center {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  min-width: 0;
  overflow: visible; /* Allow dropdowns to appear */
  flex-shrink: 1;
}

.file-icon {
  font-size: 16px;
  flex-shrink: 0;
}

.file-name {
  color: var(--vscode-titleBar-activeForeground);
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: fit-content;
  cursor: pointer;
  transition: color 0.2s ease;
}

.file-name:hover {
  color: var(--vscode-textLink-activeForeground);
  text-decoration: underline;
}

.file-info-right {
  display: flex;
  gap: 6px;
  align-items: center;
  justify-content: flex-end;
  overflow: hidden;
  flex-shrink: 0; /* Right section keeps its size, left/center shrink first */
}

/* ============================================================================
   RESPONSIVE FILE-INFO HEADER - Text hiding when space is limited
   Uses CSS Container Queries with media query fallback
   ============================================================================ */

/* Text elements that can be hidden - base styles */
.global-fold-text,
.sort-text,
.global-sticky-text,
.processes-text,
.refresh-text,
.layout-presets-text,
.clipboard-drop-label,
.trash-drop-label,
.archive-drop-label,
.marp-menu-text,
.file-bar-menu-text {
  display: inline;
  overflow: hidden;
  white-space: nowrap;
}

/* Container query: Hide text when file-info-bar is narrow (below 1200px) */
@container file-info-bar (max-width: 1200px) {
  .global-fold-text,
  .sort-text,
  .global-sticky-text,
  .processes-text,
  .refresh-text,
  .layout-presets-text,
  .clipboard-drop-label,
  .trash-drop-label,
  .archive-drop-label,
  .marp-menu-text,
  .file-bar-menu-text {
    display: none !important;
  }

  /* Make template select compact - just show dropdown arrow */
  .template-select {
    width: 20px !important;
    min-width: 20px !important;
    padding: 0 2px !important;
    color: transparent !important;
  }
}

/* Compact mode at medium widths */
@container file-info-bar (max-width: 850px) {
  .file-name {
    max-width: 100px;
  }

  .file-info-content {
    gap: 4px;
  }

  .file-info-left,
  .file-info-center,
  .file-info-right {
    gap: 4px;
  }
}

/* Very compact at narrow widths */
@container file-info-bar (max-width: 600px) {
  .file-name {
    max-width: 60px;
  }

  .file-info-content {
    gap: 2px;
  }

  .file-info-left,
  .file-info-center,
  .file-info-right {
    gap: 2px;
  }

  /* Hide marp menu at very narrow widths */
  .marp-global-menu {
    display: none;
  }
}

/* Extremely narrow - hide center section elements */
@container file-info-bar (max-width: 450px) {
  .file-info-content {
    /* Only left and right, no center - override the min-width */
    grid-template-columns: minmax(0, 1fr) 0 auto;
  }

  .file-info-center {
    display: none;
    min-width: 0 !important;
  }

  .file-name {
    max-width: 40px;
  }
}

/* Media query fallback for browsers without container query support */
@supports not (container-type: inline-size) {
  @media (max-width: 1200px) {
    .global-fold-text,
    .sort-text,
    .global-sticky-text,
    .processes-text,
    .refresh-text,
    .layout-presets-text,
    .clipboard-drop-label,
    .trash-drop-label,
    .archive-drop-label,
    .marp-menu-text,
    .file-bar-menu-text {
      display: none !important;
    }

    .file-name {
      max-width: 80px;
    }

    .file-info-content,
    .file-info-left,
    .file-info-center,
    .file-info-right {
      gap: 4px;
    }
  }
}

/* ============================================================================
   IMMEDIATE CSS TOOLTIPS - Shows on hover without delay
   ============================================================================ */

/* All file-info-bar elements with title get immediate tooltip */
.file-info-bar [title] {
  position: relative;
}

/* Tooltip appears immediately on hover - below the element */
.file-info-bar [title]:hover::after {
  content: attr(title);
  position: absolute;
  top: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--vscode-editorWidget-background, #252526);
  color: var(--vscode-editorWidget-foreground, #cccccc);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: normal;
  white-space: nowrap;
  z-index: 2000;
  pointer-events: none;
  border: 1px solid var(--vscode-editorWidget-border, #454545);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

/* Small arrow pointing up */
.file-info-bar [title]:hover::before {
  content: '';
  position: absolute;
  top: calc(100% + 2px);
  left: 50%;
  transform: translateX(-50%);
  border: 4px solid transparent;
  border-bottom-color: var(--vscode-editorWidget-border, #454545);
  z-index: 2001;
  pointer-events: none;
}

/* Don't show tooltip for elements without meaningful title or nested elements */
.file-info-bar [title=""]:hover::after,
.file-info-bar [title=""]:hover::before {
  display: none;
}

/* Prevent double tooltips - only show on direct interactive elements, not wrappers */
.file-info-bar .marp-global-menu:hover::after,
.file-info-bar .marp-global-menu:hover::before,
.file-info-bar .layout-presets-menu-container:hover::after,
.file-info-bar .layout-presets-menu-container:hover::before,
.file-info-bar .file-bar-menu:hover::after,
.file-info-bar .file-bar-menu:hover::before {
  display: none;
}

body.marp-settings-hidden .marp-global-menu,
body.marp-settings-hidden .marp-global-menu-dropdown,
body.marp-settings-hidden .donut-menu-item[data-submenu-type^="marp-"],
body.marp-settings-hidden .donut-menu-submenu[data-submenu-type^="marp-"],
body.marp-settings-hidden .donut-menu-submenu .marp-menu-panel {
  display: none !important;
  visibility: hidden !important;
}

/* ============================================================================
   DRAG MENU - Hover menus for Cards and Columns/Stacks
   ============================================================================ */

.drag-menu {
  position: relative;
  display: inline-block;
}

/* Base styles now in unified header buttons section - these are fallback defaults */
.drag-menu-trigger {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px;
  height: 22px;
  min-height: 22px;
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  border-radius: 3px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.15s ease;
  user-select: none;
}

.drag-menu-trigger:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
}

.drag-menu-icon {
  font-size: 14px;
  line-height: 1;
}

/* ============================================================================
   CSS ICONS - Replace emojis with geometric CSS shapes
   All icons: 12x12px, inline-flex centered, no overflow
   ============================================================================ */

/* Base icon style for drag menu icons */
.cards-menu .drag-menu-icon,
.columns-menu .drag-menu-icon,
.clipboard-drop-menu .clipboard-drop-icon,
.trash-drop-menu .trash-drop-icon,
.archive-drop-menu .archive-drop-icon {
  font-size: 0;
  width: 12px;
  height: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  position: relative;
}

/* Card icon - rectangle with lines */
.cards-menu .drag-menu-icon::before {
  content: "";
  width: 10px;
  height: 10px;
  border: 1px solid currentColor;
  border-radius: 1px;
  box-sizing: border-box;
}

/* Column icon - 3 bars aligned at top, different heights going down */
.columns-menu .drag-menu-icon::before {
  content: "";
  width: 10px;
  height: 10px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Crect x='1' y='0' width='2' height='12'/%3E%3Crect x='5' y='0' width='2' height='7'/%3E%3Crect x='9' y='0' width='2' height='9'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'%3E%3Crect x='1' y='0' width='2' height='12'/%3E%3Crect x='5' y='0' width='2' height='7'/%3E%3Crect x='9' y='0' width='2' height='9'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Park icon - folder with documents (outline) */
.clipboard-drop-menu .clipboard-drop-icon::before {
  content: "";
  width: 12px;
  height: 12px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3H13.5a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2zm1.46.13V13a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1H9.828a3 3 0 0 1-2.12-.879l-.83-.828A1 1 0 0 0 6.173 2H2.5a1 1 0 0 0-1 1z'/%3E%3Crect x='4' y='6' width='8' height='1' rx='.5'/%3E%3Crect x='4' y='8.5' width='6' height='1' rx='.5'/%3E%3Crect x='4' y='11' width='7' height='1' rx='.5'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3H13.5a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2zm1.46.13V13a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1H9.828a3 3 0 0 1-2.12-.879l-.83-.828A1 1 0 0 0 6.173 2H2.5a1 1 0 0 0-1 1z'/%3E%3Crect x='4' y='6' width='8' height='1' rx='.5'/%3E%3Crect x='4' y='8.5' width='6' height='1' rx='.5'/%3E%3Crect x='4' y='11' width='7' height='1' rx='.5'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Trash icon - litter bin */
.trash-drop-menu .trash-drop-icon::before {
  content: "";
  width: 12px;
  height: 12px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z'/%3E%3Cpath d='M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z'/%3E%3Cpath d='M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Archive icon - archive box (outline) */
.archive-drop-menu .archive-drop-icon::before {
  content: "";
  width: 12px;
  height: 12px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14z'/%3E%3Cpath d='M5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14z'/%3E%3Cpath d='M5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Right section icons - same base */
.global-fold-icon,
.sort-icon,
.global-sticky-icon,
.processes-icon,
.refresh-icon,
.layout-presets-icon {
  font-size: 0 !important;
  width: 12px;
  height: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  position: relative;
}

/* Pin icon in column headers - same as global-sticky-icon */
.pin-icon {
  font-size: 0 !important;
  width: 10px;
  height: 10px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  color: var(--button-foreground);
}

/* Columns fold - chevron */
.global-fold-icon {
  transform-origin: center;
  transition: transform 0.2s;
}
.global-fold-icon::before {
  content: "";
  width: 0;
  height: 0;
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-top: 5px solid currentColor;
}
.global-fold-btn.fold-all .global-fold-icon::before {
  border-top: none;
  border-bottom: 5px solid currentColor;
}

/* Sort - arrows */
.sort-icon {
  flex-direction: column;
  gap: 2px;
}
.sort-icon::before {
  content: "";
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-bottom: 4px solid currentColor;
}
.sort-icon::after {
  content: "";
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid currentColor;
}

/* Pushpin icon - unified for all sticky buttons */
.global-sticky-icon::before {
  content: "";
  width: 12px;
  height: 12px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Pin icon in column headers - same SVG as global-sticky-icon, smaller size */
.pin-icon::before {
  content: "";
  width: 10px;
  height: 10px;
  background: var(--button-foreground);
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Gear wheel icon using SVG */
.processes-icon::before {
  content: "";
  width: 12px;
  height: 12px;
  background: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M7 1h2v2.05a5 5 0 0 1 1.95.8l1.45-1.45 1.4 1.4-1.45 1.45a5 5 0 0 1 .8 1.95H15v2h-2.05a5 5 0 0 1-.8 1.95l1.45 1.45-1.4 1.4-1.45-1.45a5 5 0 0 1-1.95.8V15H7v-2.05a5 5 0 0 1-1.95-.8l-1.45 1.45-1.4-1.4 1.45-1.45a5 5 0 0 1-.8-1.95H1V7h2.05a5 5 0 0 1 .8-1.95L2.4 3.6l1.4-1.4 1.45 1.45a5 5 0 0 1 1.95-.8V1zM8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M7 1h2v2.05a5 5 0 0 1 1.95.8l1.45-1.45 1.4 1.4-1.45 1.45a5 5 0 0 1 .8 1.95H15v2h-2.05a5 5 0 0 1-.8 1.95l1.45 1.45-1.4 1.4-1.45-1.45a5 5 0 0 1-1.95.8V15H7v-2.05a5 5 0 0 1-1.95-.8l-1.45 1.45-1.4-1.4 1.45-1.45a5 5 0 0 1-.8-1.95H1V7h2.05a5 5 0 0 1 .8-1.95L2.4 3.6l1.4-1.4 1.45 1.45a5 5 0 0 1 1.95-.8V1zM8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z'/%3E%3C/svg%3E");
  -webkit-mask-size: contain;
  mask-size: contain;
}

/* Floppy disc icon for files */
.refresh-icon::before {
  content: "";
  width: 10px;
  height: 10px;
  border: 1px solid currentColor;
  border-radius: 1px;
  box-sizing: border-box;
}
.refresh-icon::after {
  content: "";
  position: absolute;
  top: 1px;
  left: 3px;
  width: 6px;
  height: 4px;
  background: currentColor;
  border-radius: 0 0 1px 1px;
}

/* Font size icon - "A" letter */
.layout-presets-icon::before {
  content: "A";
  font-size: 11px;
  font-weight: bold;
  font-family: sans-serif;
  line-height: 1;
}

/* ============================================================================ */

.drag-menu-label {
  font-size: 12px;
  white-space: nowrap;
}

/* Dropdown menu - appears on hover */
.drag-menu-dropdown {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  min-width: 160px;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
  z-index: 2000;
  padding: 4px 0;
  padding-top: 8px; /* Extra padding at top for visual gap */
  margin-top: 0; /* No gap - continuous hover zone */
}

/* Invisible bridge to maintain hover when moving to dropdown */
.drag-menu-dropdown::before {
  content: '';
  position: absolute;
  top: -8px;
  left: 0;
  right: 0;
  height: 8px;
  background: transparent;
}

.drag-menu:hover .drag-menu-dropdown {
  display: block;
}

/* Menu items - draggable */
.drag-menu-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  cursor: grab;
  font-size: 12px;
  color: var(--vscode-dropdown-foreground);
  background: transparent;
  transition: background 0.1s ease;
  user-select: none;
  white-space: nowrap;
}

.drag-menu-item:hover {
  background: var(--vscode-list-hoverBackground);
}

.drag-menu-item:active,
.drag-menu-item.dragging {
  cursor: grabbing;
  opacity: 0.6;
}

.drag-menu-item-icon {
  font-size: 14px;
  line-height: 1;
  flex-shrink: 0;
}

.drag-menu-item-text {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Hide label text at narrow widths */
@container file-info-bar (max-width: 1200px) {
  .drag-menu-label {
    display: none;
  }
}

/* Prevent tooltip on drag menu (has its own dropdown) */
.file-info-bar .drag-menu-trigger:hover::after,
.file-info-bar .drag-menu-trigger:hover::before {
  display: none;
}

/* Consistent styling for all file-info header buttons and menu triggers */
.file-info-left .marp-global-menu-btn,
.file-info-center .drag-menu-trigger,
.file-info-center .template-source,
.file-info-center .clipboard-drop-target,
.file-info-center .trash-drop-target,
.file-info-center .archive-drop-target,
.file-info-left .global-fold-btn,
.file-info-left .sort-btn,
.file-info-right .global-fold-btn,
.file-info-right .sort-btn,
.file-info-right .global-sticky-btn,
.file-info-right .font-size-btn,
.file-info-right .refresh-btn,
.file-info-right .auto-export-btn,
.file-info-right .layout-presets-btn,
.file-info-right .file-bar-menu-btn,
.file-info-right .processes-menu-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  display: inline-flex;
  align-items: center;
  box-sizing: border-box;
  padding: 2px 2px;
  margin: 0;
  height: 22px;
  min-height: 22px;
  width: auto;
  min-width: 22px;
  justify-content: center;
  gap: 4px;
  font-size: 12px;
  line-height: 1;
  border-radius: 3px;
  cursor: pointer;
  transition: all 0.15s ease;
  user-select: none;
}

.file-info-left .marp-global-menu-btn:hover,
.file-info-center .drag-menu-trigger:hover,
.file-info-center .template-source:hover,
.file-info-center .clipboard-drop-target:hover,
.file-info-center .trash-drop-target:hover,
.file-info-center .archive-drop-target:hover,
.file-info-left .global-fold-btn:hover,
.file-info-left .sort-btn:hover,
.file-info-right .global-fold-btn:hover,
.file-info-right .sort-btn:hover,
.file-info-right .global-sticky-btn:hover,
.file-info-right .font-size-btn:hover,
.file-info-right .refresh-btn:hover,
.file-info-right .auto-export-btn:hover,
.file-info-right .layout-presets-btn:hover,
.file-info-right .file-bar-menu-btn:hover,
.file-info-right .processes-menu-btn:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
}


/* ===== Clipboard Drop Target (Parking Area) ===== */
.clipboard-drop-menu {
  position: relative;
  display: inline-flex;
  align-items: center;
}

/* Base styles now in unified header buttons section above */

.clipboard-drop-target:hover {
  border-color: var(--vscode-focusBorder);
}

.clipboard-drop-target.drag-over {
  background: var(--vscode-list-hoverBackground);
  border-color: var(--vscode-focusBorder);
  border-style: solid;
  transform: scale(1.05);
}

/* .clipboard-drop-icon font-size moved to CSS icons section */

.clipboard-drop-label {
  font-size: 12px;
}

.clipboard-drop-count {
  display: none;
  background: var(--vscode-badge-background);
  color: var(--vscode-badge-foreground);
  border-radius: 50%;
  min-width: 16px;
  height: 16px;
  font-size: 10px;
  line-height: 16px;
  text-align: center;
  padding: 0 4px;
}

.clipboard-drop-count.has-items {
  display: inline-block;
}

.clipboard-drop-dropdown {
  position: absolute;
  top: calc(100% + 4px); /* Small gap below trigger */
  left: 0;
  min-width: 200px;
  max-width: 300px;
  max-height: 400px;
  overflow-y: scroll; /* Always reserve scrollbar space */
  overflow-x: hidden;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  z-index: var(--z-dropdown);
  display: none;
}

/* Hide scrollbar but keep space reserved */
.clipboard-drop-dropdown::-webkit-scrollbar {
  width: 8px;
}
.clipboard-drop-dropdown::-webkit-scrollbar-track {
  background: transparent;
}
.clipboard-drop-dropdown::-webkit-scrollbar-thumb {
  background: transparent;
}
.clipboard-drop-dropdown:hover::-webkit-scrollbar-thumb {
  background: var(--vscode-scrollbarSlider-background);
}

/* Bridge element on parent to maintain hover through gap - prevents scrollbar issues */
.clipboard-drop-menu::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  height: 8px; /* Bridge the gap */
  background: transparent;
  pointer-events: auto; /* Capture hover to keep dropdown open */
}

.clipboard-drop-menu:hover .clipboard-drop-dropdown,
.clipboard-drop-dropdown.show,
.clipboard-drop-menu.dragging-from .clipboard-drop-dropdown {
  display: block;
}

/* Hide dropdown when receiving a drag (something being dropped INTO park) */
.clipboard-drop-menu:has(.clipboard-drop-target.drag-over) .clipboard-drop-dropdown {
  display: none !important;
}

.clipboard-drop-header {
  padding: 8px 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--vscode-descriptionForeground);
  border-bottom: 1px solid var(--vscode-dropdown-border);
}

.clipboard-drop-items {
  padding: 4px 0;
}

.clipboard-drop-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  cursor: grab;
  transition: background 0.1s ease;
}

.clipboard-drop-item:hover {
  background: var(--vscode-list-hoverBackground);
}

.clipboard-drop-item-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.clipboard-drop-item-text {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 12px;
}

.clipboard-drop-item-restore {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-textLink-foreground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.clipboard-drop-item-remove {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-errorForeground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.clipboard-drop-item:hover .clipboard-drop-item-restore,
.clipboard-drop-item:hover .clipboard-drop-item-remove {
  opacity: 1;
}

.clipboard-drop-empty {
  padding: 12px;
  text-align: center;
  color: var(--vscode-descriptionForeground);
  font-size: 12px;
  font-style: italic;
}

/* ===== Trash Drop Target ===== */
.trash-drop-menu {
  position: relative;
  display: inline-flex;
  align-items: center;
}

/* Base styles now in unified header buttons section above */

.trash-drop-target:hover {
  border-color: var(--vscode-errorForeground, #f66);
}

.trash-drop-target.drag-over {
  background: var(--vscode-inputValidation-errorBackground, rgba(255, 68, 68, 0.2));
  border-color: var(--vscode-errorForeground, #f66);
  border-style: solid;
  transform: scale(1.05);
}

/* .trash-drop-icon font-size moved to CSS icons section */

.trash-drop-label {
  font-size: 12px;
}

.trash-drop-count {
  display: none;
  background: var(--vscode-errorBackground, rgba(255, 68, 68, 0.3));
  color: var(--vscode-errorForeground, #f66);
  border-radius: 50%;
  min-width: 16px;
  height: 16px;
  font-size: 10px;
  line-height: 16px;
  text-align: center;
  padding: 0 4px;
}

.trash-drop-count.has-items {
  display: inline-block;
}

.trash-drop-dropdown {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  min-width: 200px;
  max-width: 300px;
  max-height: 400px;
  overflow-y: scroll; /* Always reserve scrollbar space */
  overflow-x: hidden;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  z-index: var(--z-dropdown);
  display: none;
}

/* Hide scrollbar but keep space reserved */
.trash-drop-dropdown::-webkit-scrollbar {
  width: 8px;
}
.trash-drop-dropdown::-webkit-scrollbar-track {
  background: transparent;
}
.trash-drop-dropdown::-webkit-scrollbar-thumb {
  background: transparent;
}
.trash-drop-dropdown:hover::-webkit-scrollbar-thumb {
  background: var(--vscode-scrollbarSlider-background);
}

/* Bridge element on parent to maintain hover through gap */
.trash-drop-menu::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  height: 8px;
  background: transparent;
  pointer-events: auto;
}

.trash-drop-menu:hover .trash-drop-dropdown,
.trash-drop-dropdown.show,
.trash-drop-menu.dragging-from .trash-drop-dropdown {
  display: block;
}

/* Hide dropdown when receiving a drag (something being dropped INTO trash) */
.trash-drop-menu:has(.trash-drop-target.drag-over) .trash-drop-dropdown {
  display: none !important;
}

.trash-drop-header {
  padding: 8px 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--vscode-errorForeground, #f66);
  border-bottom: 1px solid var(--vscode-dropdown-border);
}

.trash-drop-items {
  padding: 4px 0;
}

.trash-drop-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  cursor: grab;
  transition: background 0.1s ease;
}

.trash-drop-item:hover {
  background: var(--vscode-list-hoverBackground);
}

.trash-drop-item-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.trash-drop-item-text {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 12px;
}

.trash-drop-item-restore {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-textLink-foreground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.trash-drop-item-remove {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-errorForeground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.trash-drop-item:hover .trash-drop-item-restore,
.trash-drop-item:hover .trash-drop-item-remove {
  opacity: 1;
}

.trash-drop-empty {
  padding: 12px;
  text-align: center;
  color: var(--vscode-descriptionForeground);
  font-size: 12px;
  font-style: italic;
}

.trash-drop-footer {
  padding: 8px 12px;
  border-top: 1px solid var(--vscode-dropdown-border);
  text-align: center;
}

.trash-empty-btn {
  background: var(--vscode-errorBackground, rgba(255, 68, 68, 0.2));
  color: var(--vscode-errorForeground, #f66);
  border: 1px solid var(--vscode-errorBorder, rgba(255, 68, 68, 0.4));
  border-radius: 4px;
  padding: 4px 12px;
  font-size: 11px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.trash-empty-btn:hover {
  background: var(--vscode-errorBackground, rgba(255, 68, 68, 0.4));
}

/* ===== Archive Drop Target ===== */
.archive-drop-menu {
  position: relative;
  display: inline-flex;
  align-items: center;
}

/* Base styles now in unified header buttons section above */

.archive-drop-target:hover {
  border-color: var(--vscode-textLink-activeForeground, #58a6ff);
}

.archive-drop-target.drag-over {
  background: var(--vscode-list-hoverBackground);
  border-color: var(--vscode-textLink-activeForeground, #58a6ff);
  border-style: solid;
  transform: scale(1.05);
}

.archive-drop-icon {
  font-size: 14px;
}

.archive-drop-label {
  font-size: 12px;
}

.archive-drop-count {
  display: none;
  background: var(--vscode-badge-background);
  color: var(--vscode-badge-foreground);
  border-radius: 50%;
  min-width: 16px;
  height: 16px;
  font-size: 10px;
  line-height: 16px;
  text-align: center;
  padding: 0 4px;
}

.archive-drop-count.has-items {
  display: inline-block;
}

.archive-drop-dropdown {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  min-width: 200px;
  max-width: 300px;
  max-height: 400px;
  overflow-y: scroll;
  overflow-x: hidden;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  z-index: var(--z-dropdown);
  display: none;
}

/* Hide scrollbar but keep space reserved */
.archive-drop-dropdown::-webkit-scrollbar {
  width: 8px;
}
.archive-drop-dropdown::-webkit-scrollbar-track {
  background: transparent;
}
.archive-drop-dropdown::-webkit-scrollbar-thumb {
  background: transparent;
}
.archive-drop-dropdown:hover::-webkit-scrollbar-thumb {
  background: var(--vscode-scrollbarSlider-background);
}

/* Bridge element on parent to maintain hover through gap */
.archive-drop-menu::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  height: 8px;
  background: transparent;
  pointer-events: auto;
}

.archive-drop-menu:hover .archive-drop-dropdown,
.archive-drop-dropdown.show,
.archive-drop-menu.dragging-from .archive-drop-dropdown {
  display: block;
}

/* Hide dropdown when receiving a drag (something being dropped INTO archive) */
.archive-drop-menu:has(.archive-drop-target.drag-over) .archive-drop-dropdown {
  display: none !important;
}

.archive-drop-header {
  padding: 8px 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--vscode-textLink-foreground, #3794ff);
  border-bottom: 1px solid var(--vscode-dropdown-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.archive-open-file-btn,
.archive-export-all-btn {
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 14px;
  padding: 2px 4px;
  border-radius: 3px;
  transition: background 0.15s ease;
}

.archive-open-file-btn:hover,
.archive-export-all-btn:hover {
  background: var(--vscode-list-hoverBackground);
}

.archive-drop-items {
  padding: 4px 0;
}

.archive-drop-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  cursor: grab;
  transition: background 0.1s ease;
}

.archive-drop-item:hover {
  background: var(--vscode-list-hoverBackground);
}

.archive-drop-item-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.archive-drop-item-text {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 12px;
}

.archive-drop-item-restore {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-textLink-foreground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.archive-drop-item-export {
  opacity: 0;
  padding: 2px 4px;
  cursor: pointer;
  color: var(--vscode-textLink-foreground);
  transition: opacity 0.1s ease;
  flex-shrink: 0;
}

.archive-drop-item:hover .archive-drop-item-restore,
.archive-drop-item:hover .archive-drop-item-export {
  opacity: 1;
}

.archive-drop-empty {
  padding: 12px;
  text-align: center;
  color: var(--vscode-descriptionForeground);
  font-size: 12px;
  font-style: italic;
}

/* Text styling for button labels */
.menu-text {
  font-weight: 500;
}

.menu-icon {
  font-size: 14px;
  line-height: 1;
  vertical-align: middle;
}

/* ============================================================================
   TOOLBAR BUTTONS - Consolidated primary button styles
   ============================================================================ */

/* Shared primary button base styles */
.refresh-btn,
.auto-export-btn,
.global-sticky-btn,
.layout-presets-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
}

/* Shared hover states */
.refresh-btn:hover,
.auto-export-btn:hover,
.global-sticky-btn:hover,
.layout-presets-btn:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
}

/* Shared active states */
.auto-export-btn.active,
.layout-presets-btn.active {
  background: var(--button-background-active);
  color: var(--button-foreground-active);
  border: var(--button-border-active);
}

/* Button-specific styles */
.global-sticky-btn {
  font-size: 14px;
}

.global-sticky-btn.active .global-sticky-icon::after {
  content: "";
  position: absolute;
  top: -2px;
  left: -2px;
  width: 16px;
  height: 16px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%23ff0000' stroke-width='1.5' d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
  background-color: transparent;
}

.refresh-btn.pending {
  background: var(--vscode-inputValidation-warningBackground);
  color: var(--vscode-inputValidation-warningForeground);
  border-color: var(--vscode-inputValidation-warningBorder);
}

.refresh-btn.saved {
  background: var(--vscode-inputValidation-infoBackground);
  color: var(--vscode-inputValidation-infoForeground);
  border-color: var(--vscode-inputValidation-infoBorder);
}

.auto-export-btn.active {
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

/* ============= PROCESSES MENU ============= */
.processes-menu {
  position: relative;
  z-index: 100;
}

.processes-menu.active {
  z-index: 1000;
  isolation: isolate;
}

/* .processes-menu-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 4px;
  position: relative;
} */

.processes-indicator {
  position: absolute;
  top: 2px;
  right: 2px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--vscode-statusBarItem-warningBackground, #f0ad4e);
}

.processes-indicator.active {
  background: var(--vscode-charts-green, #4caf50);
  animation: pulse 1.5s infinite;
}

/* Shared dropdown surfaces */
.donut-menu-dropdown,
.file-bar-menu-dropdown,
.processes-menu-dropdown,
.layout-presets-dropdown,
.marp-global-menu-dropdown {
  display: none;
  position: fixed;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
}

.donut-menu-dropdown,
.file-bar-menu-dropdown,
.processes-menu-dropdown,
.marp-global-menu-dropdown {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.processes-menu-dropdown {
  padding: 8px;
  min-width: 220px;
  z-index: 5000;
}

.processes-menu.active .processes-menu-dropdown {
  display: block;
}

.processes-menu-header {
  font-weight: 600;
  padding: 4px 8px;
  color: var(--vscode-foreground);
  border-bottom: 1px solid var(--vscode-panel-border);
  margin-bottom: 8px;
}

.processes-section {
  padding: 4px 0;
}

.processes-section-title {
  font-weight: 500;
  padding: 4px 8px;
  color: var(--vscode-foreground);
  display: flex;
  align-items: center;
  gap: 6px;
}

.processes-section-content {
  padding: 4px 8px;
}

.processes-status-row {
  display: flex;
  justify-content: space-between;
  padding: 2px 0;
  font-size: 12px;
}

.processes-status-label {
  color: var(--vscode-descriptionForeground);
}

.processes-status-value {
  color: var(--vscode-foreground);
}

.processes-status-value.scanning {
  color: var(--vscode-charts-yellow, #f0ad4e);
}

.processes-status-value.complete {
  color: var(--vscode-charts-green, #4caf50);
}

.processes-actions {
  margin-top: 8px;
  display: flex;
  gap: 8px;
}

.processes-action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  padding: 2px 6px;
  margin: 0;
  font-size: 12px;
  line-height: 1;
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border: 1px solid var(--vscode-button-border, transparent);
  border-radius: 3px;
  cursor: pointer;
  height: 22px;
  min-height: 22px;
}

.processes-action-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.processes-action-btn.stop-btn {
  background: var(--vscode-statusBarItem-errorBackground, #d32f2f);
  color: white;
}

.processes-action-btn.stop-btn:hover {
  opacity: 0.9;
}

.processes-menu-divider {
  height: 1px;
  background: var(--vscode-panel-border);
  margin: 8px 0;
}

/* Layout Presets Menu */
.layout-presets-menu-container {
  position: relative;
  display: inline-block;
}

.layout-presets-dropdown {
  min-width: 200px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  z-index: 1000;
  padding: 4px 0;
}

.layout-presets-dropdown.show {
  display: block;
}

.layout-preset-item {
  display: flex;
  flex-direction: column;
  padding: 8px 12px;
  cursor: pointer;
  border: none;
  background: none;
  color: var(--vscode-dropdown-foreground);
  text-align: left;
  width: 100%;
}

.layout-preset-item:hover {
  background: var(--vscode-list-hoverBackground);
}

.layout-preset-item.active {
  background: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
}

.layout-preset-label {
  font-weight: 500;
  font-size: 13px;
  margin-bottom: 2px;
}

.layout-preset-description {
  font-size: 11px;
  opacity: 0.8;
  color: var(--vscode-descriptionForeground);
}

/* NOTE: Responsive file-info header styles are consolidated near the top of this file
   under the .file-info-bar container query section */

/* Small font mode for cards */
body.small-card-fonts .card-item {
  font-size: 0.75em;
}

body.small-card-fonts .card-title-display,
body.small-card-fonts .card-description-display,
body.small-card-fonts .card-description-edit,
body.small-card-fonts .card-description-wysiwyg {
  font-size: 0.85em;
  line-height: 1.3;
}

body.small-card-fonts .card-item {
  padding: 6px;
}

body.small-card-fonts .card-header {
  gap: 6px;
  margin-bottom: 3px;
}

/* Smaller images in small font mode */
body.small-card-fonts .card-description-container .markdown-content img {
  max-width: 48%;
  max-height: 200px;
  display: inline-block;
  vertical-align: top;
  margin: 2px 2px;
}

body.small-card-fonts .card-title-container .markdown-content img {
  max-width: 48%;
  max-height: 30px;
  margin: 1px 1px;
}

/* Hide collapsed add task button in column header */
.collapsed-add-task-btn {
  display: none !important;
}

/* Clipboard hover preview */
.clipboard-preview {
  position: absolute;
  top: calc(100% + var(--whitespace-div2));
  left: 50%;
  transform: translateX(-50%);
  background: var(--vscode-editorHoverWidget-background);
  border: 1px solid var(--vscode-editorHoverWidget-border);
  border-radius: 6px;
  padding: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
  max-width: 300px;
  display: none;
  pointer-events: none;
}

.clipboard-preview.show {
  display: block;
}

.clipboard-preview-header {
  font-size: 12px;
  font-weight: 600;
  color: var(--vscode-editorHoverWidget-foreground);
  border-bottom: 1px solid var(--vscode-editorHoverWidget-border);
  padding-bottom: 4px;
}

.clipboard-preview-image {
  max-width: 280px;
  max-height: 200px;
  border-radius: 4px;
  border: 1px solid var(--vscode-editorHoverWidget-border);
}

.clipboard-preview-text {
  font-size: 11px;
  color: var(--vscode-editorHoverWidget-foreground);
  font-family: var(--vscode-editor-font-family);
  word-break: break-word;
  max-height: 100px;
  overflow-y: auto;
}

/* Small screen layout adjustments */
@media (max-width: 480px) {
  .file-info-center {
    gap: 4px;
  }
}

/* Main container - fills viewport below file bar */
#kanban-container {
  /* background-color: var(--board-background); */
  position: fixed;
  top: calc(var(--whitespace) + 4px + 24px);
  left: 0;
  right: 0;
  bottom: 0;
  overflow-x: auto;
  overflow-y: auto;
  overflow-anchor: none;
  display: flex;
  flex-direction: column;
}

/* Kanban board */
.kanban-board {
  display: flex;
  flex-wrap: nowrap;
  width: max-content; /* Allow horizontal expansion */
  align-items: flex-start;
  overflow-anchor: none;
}

.kanban-board * {
  overflow-anchor: none;
}

/* when it has no child - kanban-row */
.kanban-board:not(:has(.kanban-row)) {
	gap: var(--whitespace);
	padding-left: var(--whitespace);
	padding-right: var(--whitespace);
}

.kanban-board.multi-row {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
	overflow: auto;
  overflow-anchor: none;
}

.kanban-edit-scroll-spacer {
  width: 1px;
  flex: 0 0 auto;
  pointer-events: none;
}

/* Kanban columns - Full height wrapper for sticky positioning */
.kanban-full-height-column {
  /* Transparent wrapper that provides full height for sticky positioning */
  /* background-color: transparent; */
  border: none;
  width: var(--column-width);
  flex-shrink: 0;
  position: relative;
  min-height: 100%;
  transition: all 0.3s ease;
  overflow: visible;
  display: flex;
  flex-direction: column;
  padding: 0;
}

.kanban-full-height-column.collapsed-vertical {
    width: 32px;
}



/* Note: .column-footer is defined later in the file with complete styling */

.column-content {
  /* This contains the actual visual column with border and background */
  display: flex;
  flex-direction: column;
  padding-left:  var(--whitespace-div4);
  padding-right:  var(--whitespace-div4);
  /* padding: 0 var(--whitespace-div4) 0 var(--whitespace-div4); */
  flex: 1 1 auto;
  /* background-color: var(--vscode-editor-background); */
  /* border-radius: 0 0 var(--whitespace-div4) var(--whitespace-div4); */
  /* border: 0.5px solid var(--vscode-panel-border); */
  border-top: none;
  margin: 0 var(--whitespace) var(--whitespace) var(--whitespace);
  overflow: visible;
  overflow-x: visible;
  max-height: min-content;
  background-color: var(--column-background);
  /* gap: var(--whitespace-div2); */
}

.header-bars-container,
.footer-bars-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  flex-shrink: 0;
}

.header-bars-container {
  order: -1;
  /* position: sticky; */ /* should be sticky, but for the moment we dont implement it as the column header must not be overlapped when scrolling */
  /* top: 0px; */
  z-index: 9;
  background-color: var(--vscode-editor-background);
}

.footer-bars-container {
  order: 999;
  margin-top: auto;
}

/* Footer bars in stacked columns are part of sticky column-footer */
.kanban-column-stack .column-footer > .stacked-footer-bars {
  position: relative;
  /* background-color: var(--vscode-titleBar-activeBackground);; */
  margin-top: 0;
  width: 100%;
  flex-shrink: 0;
}

/* Ensure header/footer bars work in task items */
.card-item .header-bars-container {
  order: -1;
  flex-shrink: 0;
}

.card-item .footer-bars-container {
  order: 999;
  flex-shrink: 0;
}

/* Column header - receives tag-based header bars, can be styled/faded independently */
.column-header {
  z-index: 11;
	padding-bottom: var(--whitespace-div4);
	position: sticky;
	border-radius: 4px 4px 0px 0px;
  background-color: var(--column-background);
}

/* Column title */
.column-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 1000001;
  background-color: var(--column-background);
  border-top: none;
  border-bottom: none;
  margin-bottom: 0;
  flex-direction: column;
  position: relative;
  /* Force new stacking context to ensure title is above full-height column content */
  transform: translateZ(10px);
}

/* --- column title : dashed top and bottom borders --- */
.column-title::before,
.column-title::after {
  content: '';
  position: absolute;
  left: var(--whitespace-div2);
  right: var(--whitespace-div2);
  height: 1px;
  background-image: repeating-linear-gradient(
    90deg,
    color-mix(in srgb, var(--vscode-panel-border) 50%, transparent),  /* 50% transparent dash */
    color-mix(in srgb, var(--vscode-panel-border) 50%, transparent) 4px,
    transparent 4px,
    transparent 10px  /* Dash + gap total */
  );
}

.column-title::before {
  top: 0px;
}

.column-title::after {
  bottom: 0px;
}

/* --- column title : dashed top and bottom borders --- end --- */


.column-title::before {
  margin-top: 0;
}

/* .column-title::after {
  bottom: 0;
} */

.column-footer {
	/* padding-top: var(--whitespace-div4); */
  background-color: var(--column-background);
	position: sticky;
  /* min-height: 4px; */
	/* top: 28px; */
	/* border-bottom: 0.5px solid var(--vscode-panel-border); */
	border-radius: 0px 0px 4px 4px;
}

/* Column title section */
.kanban-full-height-column.collapsed-vertical .column-title-section {
	flex-direction: column !important;
	align-items: center;
  /* padding: var(--whitespace-div4) 0px; */
}

.column-title-section {
  padding: 0 var(--whitespace-div4); /* left & right */
  display: flex;
	align-items: center;
  gap: var(--whitespace-div4);
  flex: 1;
  min-width: 0;
  margin-top: 0;
  width: -webkit-fill-available;
  /* margin-bottom: var(--whitespace-div4); */
}


/* Title container that should expand to fill available space */
.column-title-container {
  flex: auto;
  margin-left: 2px;
  /* min-width: 0;
  display: flex;
  flex-direction: column; */
}

.kanban-full-height-column.collapsed-vertical .column-title-container {
  margin-left: 0px;
}

/* Column title text */
.column-title-text {
  cursor: pointer;
  border-radius: 3px;
  min-width: 0;
  word-break: break-word;
  display: block;
  margin: 0;
  min-height: 16px;
  width: 100%;
  flex: 1;
  white-space: normal;
  overflow-wrap: break-word;
  max-height: none;
}

.column-title-text:has(:not(include-broken)):hover {
  background-color: var(--vscode-list-hoverBackground);
}

/* Column and Task include link styling */
.columninclude-link,
.include-filename-link {
  color: var(--vscode-textLink-foreground);
  text-decoration: underline;
  cursor: pointer;
  word-break: break-all;
  font-weight: 500;
}

.columninclude-link:hover,
.include-filename-link:hover {
  color: var(--vscode-textLink-activeForeground);
  background-color: rgba(var(--vscode-textLink-activeForeground-rgb, 0, 122, 204), 0.1);
}

/* Strikethrough styling */
.strikethrough-container {
  position: relative;
  display: inline;
}

/* Strikethrough visual effects for broken images and links */
.strikethrough-content img,
.strikethrough-content a {
  text-decoration: line-through !important;
  opacity: 0.6;
  filter: grayscale(100%);
}

.strikethrough-content img {
  /* Add visual indicator for broken images */
  border: 1px dashed var(--vscode-errorForeground, #f48771);
  background-color: var(--vscode-errorBackground, rgba(244, 135, 113, 0.1));
  /* Make broken images smaller and not full width */
  max-width: 200px !important;
  width: auto !important;
  height: auto !important;
  display: inline-block !important;
}

.strikethrough-content a {
  /* Style for broken links */
  color: var(--vscode-errorForeground, #f48771) !important;
}

/* ============================================================================
   UNIFIED NOT-FOUND STYLES (images, videos, links, includes)
   Uses ERROR colors (red) consistently for broken/missing files
   ============================================================================ */

/* Base styles for all not-found placeholders */
.image-not-found,
.video-not-found,
.link-not-found,
.include-not-found {
  display: inline-flex;
  align-items: center;
  position: relative;
  padding: 4px 6px;
  padding-right: 36px; /* Space for burger menu */
  background-color: var(--vscode-inputValidation-errorBackground, rgba(255, 0, 0, 0.1));
  border: 1px solid var(--vscode-inputValidation-errorBorder, rgba(255, 0, 0, 0.4));
  border-radius: 3px;
  color: var(--vscode-errorForeground, #f48771);
  font-size: 0.9em;
  cursor: pointer;
  box-sizing: border-box;
  max-width: 100%;
}

.image-not-found:hover,
.video-not-found:hover,
.link-not-found:hover,
.include-not-found:hover {
  background-color: var(--vscode-inputValidation-errorBackground, rgba(255, 0, 0, 0.15));
  border-color: var(--vscode-errorBorder, rgba(255, 0, 0, 0.6));
}

/* Text inside not-found placeholders */
.image-not-found-text,
.video-not-found-text,
.link-not-found-text,
.include-not-found-text {
  overflow: hidden;
  text-overflow: ellipsis;
  /* white-space: nowrap; */
  font-size: 1.0em;
  line-break: anywhere;
}
/* Standalone not-found containers - all media types */
.image-not-found-container,
.video-not-found-container,
.link-not-found-container,
.include-not-found-container {
  position: relative;
  display: block;
  width: 100%;
}

/* Full width for broken overlay containers - all media types */
.image-path-overlay-container.image-broken,
.video-path-overlay-container.video-broken,
.link-path-overlay-container.link-broken,
.include-path-overlay-container.include-broken {
  display: block;
  width: 100%;
}

/* Column/task/regular broken includes - inline error styling (no .include-not-found wrapper) */
.include-path-overlay-container.include-broken[data-include-type="column"],
.include-path-overlay-container.include-broken[data-include-type="task"],
.include-path-overlay-container.include-broken[data-include-type="regular"] {
  display: inline-flex;
  align-items: center;
  position: relative;
  width: auto;
  padding: 4px 8px;
  padding-right: 32px; /* Space for burger menu */
  background-color: var(--vscode-inputValidation-errorBackground, rgba(255, 0, 0, 0.1));
  border: 1px solid var(--vscode-inputValidation-errorBorder, rgba(255, 0, 0, 0.4));
  border-radius: 3px;
  box-sizing: border-box;
  min-height: 22px;
}

.include-path-overlay-container.include-broken[data-include-type="column"]:hover,
.include-path-overlay-container.include-broken[data-include-type="task"]:hover,
.include-path-overlay-container.include-broken[data-include-type="regular"]:hover {
  background-color: var(--vscode-inputValidation-errorBackground, rgba(255, 0, 0, 0.15));
  border-color: var(--vscode-errorBorder, rgba(255, 0, 0, 0.6));
}

/* Full width for all broken displays - all media types */
.image-not-found-container > .image-not-found,
.video-not-found-container > .video-not-found,
.link-not-found-container > .link-not-found,
.include-not-found-container > .include-not-found,
.image-path-overlay-container.image-broken > .image-not-found,
.video-path-overlay-container.video-broken > .video-not-found,
.link-path-overlay-container.link-broken > .link-not-found,
.include-path-overlay-container.include-broken > .include-not-found {
  display: block;
  width: 100%;
}

/* Note: Burger menu button styling is now consolidated at the top of the file
   in the "Unified ERROR state for all broken/not-found menu buttons" section */

/* Not-found dropdown menus - all media types */
.image-not-found-menu,
.video-not-found-menu,
.link-not-found-menu,
.include-not-found-menu {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  min-width: 180px;
  background: var(--vscode-menu-background, #252526);
  border: 1px solid var(--vscode-menu-border, #454545);
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  padding: 4px 0;
  pointer-events: auto;
}

.image-not-found-menu.visible,
.video-not-found-menu.visible,
.link-not-found-menu.visible,
.include-not-found-menu.visible {
  display: block;
}

.image-not-found-menu .image-path-menu-item,
.video-not-found-menu .video-path-menu-item,
.link-not-found-menu .link-path-menu-item,
.include-not-found-menu .include-path-menu-item {
  pointer-events: auto;
}

.image-not-found-menu .image-path-menu-item:not(.disabled):not(:disabled),
.video-not-found-menu .video-path-menu-item:not(.disabled):not(:disabled),
.link-not-found-menu .link-path-menu-item:not(.disabled):not(:disabled),
.include-not-found-menu .include-path-menu-item:not(.disabled):not(:disabled) {
  cursor: pointer;
}

.diagram-placeholder {
  width: 100%;
}

/* Broken diagram placeholders should fit content, not expand */
.diagram-placeholder:has(.image-broken),
.diagram-placeholder:has(.image-not-found) {
  display: inline-block;
  width: fit-content;
  max-width: 100%;
}

/* Figure containing broken diagram should also fit content */
figure:has(.diagram-placeholder .image-broken),
figure:has(.diagram-placeholder .image-not-found) {
  flex: none;
  width: fit-content;
  max-width: 100%;
}


/* ============================================================================
   VIDEO PATH OVERLAY CONTAINER
   ============================================================================ */

/* Video path overlay container */
.video-path-overlay-container {
  position: relative;
  display: inline-block;
}

/* ============================================================================
   EMBED CONTAINER - For iframe embeds (miro, figma, youtube, etc.)
   ============================================================================ */

.embed-container {
  position: relative;
  display: block;
  width: 100%;
  margin: 0.5em 0;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  overflow: hidden;
  background: var(--vscode-editor-background);
}

.embed-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  background: var(--vscode-titleBar-activeBackground, rgba(0, 0, 0, 0.1));
  border-bottom: 1px solid var(--vscode-panel-border);
  font-size: 0.85em;
}

.embed-icon {
  flex-shrink: 0;
}

.embed-title {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: var(--vscode-foreground);
  opacity: 0.9;
}

.embed-menu-btn {
  flex-shrink: 0;
  background: transparent;
  border: none;
  padding: 2px 6px;
  cursor: pointer;
  color: var(--vscode-foreground);
  opacity: 0.5;
  font-size: 1em;
  border-radius: 3px;
  transition: opacity 0.2s, background-color 0.2s;
}

.embed-menu-btn:hover {
  opacity: 1;
  background: rgba(255, 255, 255, 0.1);
}

.embed-frame-wrapper {
  position: relative;
  width: 100%;
  min-height: 300px;
  background: var(--vscode-editor-background);
}

.embed-frame-wrapper:has(.web-preview-fallback) {
  min-height: auto;
}

.embed-frame-wrapper iframe {
  display: block;
  width: 100%;
  border: none;
}

/* Embed placeholder overlay  shown when openAutomatically is false */
.embed-activate-overlay {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 200px;
  background: var(--vscode-editor-background);
  cursor: pointer;
}

.embed-activate-btn {
  padding: 12px 24px;
  border: 1px solid var(--vscode-button-border, var(--vscode-panel-border));
  border-radius: 6px;
  background: var(--vscode-button-secondaryBackground, rgba(255, 255, 255, 0.05));
  color: var(--vscode-button-secondaryForeground, var(--vscode-foreground));
  cursor: pointer;
  font-size: 0.9em;
  max-width: 90%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.embed-activate-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground, rgba(255, 255, 255, 0.1));
}

/* Responsive embed height adjustments */
@media (max-width: 600px) {
  .embed-frame-wrapper {
    min-height: 200px;
  }

  .embed-frame-wrapper iframe {
    height: 300px !important;
  }
}

/* Embed container inside task description */
.task-description .embed-container,
.card-description-wysiwyg .embed-container {
  margin: 0.5em 0;
}

/* Hide embed menu button until hover */
.embed-container:not(:hover) .embed-menu-btn {
  opacity: 0;
}

.embed-container:hover .embed-menu-btn {
  opacity: 0.5;
}

.embed-container:hover .embed-menu-btn:hover {
  opacity: 1;
}

/* ============================================================================
   WEB PREVIEW - Inline iframe for non-image HTTP(S) URLs
   ============================================================================ */

.web-preview-container {
  position: relative;
  display: block;
  width: 100%;
  margin: 0.5em 0;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  overflow: hidden;
  background: var(--vscode-editor-background);
}

.web-preview-container iframe {
  display: block;
  width: 100%;
  border: none;
}

.web-preview-fallback {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2em 1em;
  gap: 8px;
  color: var(--vscode-descriptionForeground);
  text-align: center;
}

.web-preview-fallback-icon {
  font-size: 1.5em;
}

.web-preview-fallback-text {
  font-size: 0.9em;
}

.web-preview-fallback-link {
  display: inline-block;
  margin-top: 4px;
  padding: 4px 12px;
  border: 1px solid var(--vscode-button-border, var(--vscode-panel-border));
  border-radius: 4px;
  color: var(--vscode-textLink-foreground);
  text-decoration: none;
  font-size: 0.85em;
  transition: background 0.15s;
}

.web-preview-fallback-link:hover {
  background: var(--vscode-list-hoverBackground);
}

.web-preview-caption {
  display: block;
  padding: 4px 0;
  font-size: 0.85em;
  color: var(--vscode-descriptionForeground);
  text-align: center;
  font-style: italic;
}

.task-description .web-preview-container,
.card-description-wysiwyg .web-preview-container {
  margin: 0.5em 0;
}

/* ============================================================================
   INLINE FILE EMBEDS - Text/Markdown-like files rendered in iframe containers
   ============================================================================ */

.inline-file-embed-container {
  display: block;
  width: 100%;
  margin: 0.5em 0;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  overflow: hidden;
  background: var(--vscode-editor-background);
}

.inline-file-embed-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  border-bottom: 1px solid var(--vscode-panel-border);
  background: var(--vscode-sideBar-background);
  color: var(--vscode-foreground);
  font-size: 0.85em;
}

.inline-file-embed-type {
  font-family: var(--vscode-editor-font-family);
  font-weight: 700;
  letter-spacing: 0.03em;
  opacity: 0.9;
}

.inline-file-embed-label {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  opacity: 0.85;
  flex: 1;
  cursor: pointer;
}

.inline-file-embed-label:hover {
  opacity: 1;
  text-decoration: underline;
}

.inline-file-menu-btn {
  flex-shrink: 0;
  background: transparent;
  border: none;
  padding: 2px 6px;
  cursor: pointer;
  color: var(--vscode-foreground);
  opacity: 0.5;
  font-size: 1em;
  border-radius: 3px;
  transition: opacity 0.2s, background-color 0.2s;
}

.inline-file-menu-btn:hover {
  opacity: 1;
  background: rgba(255, 255, 255, 0.1);
}

.inline-file-embed-container:not(:hover) .inline-file-menu-btn {
  opacity: 0;
}

.inline-file-embed-container:hover .inline-file-menu-btn {
  opacity: 0.5;
}

.inline-file-embed-container:hover .inline-file-menu-btn:hover {
  opacity: 1;
}

.inline-file-embed-frame-wrapper {
  width: 100%;
  max-height: min(55vh, 520px);
  overflow: auto;
  background: var(--vscode-editor-background);
}

.inline-file-embed-frame-wrapper iframe {
  display: block;
  width: 100%;
  min-height: 240px;
  border: none;
  background: var(--vscode-editor-background);
}

.inline-file-embed-caption {
  display: block;
  padding: 4px 0;
}

/* ============================================================================
   MEDIA CAPTIONS - For images, videos, audio, and embeds
   ============================================================================ */

.media-figure {
  margin: 0.5em 0;
  padding: 0;
  display: block;
}

.media-caption,
.embed-caption {
  display: block;
  padding: 4px 0;
  font-size: 0.85em;
  color: var(--vscode-descriptionForeground);
  text-align: center;
  font-style: italic;
}

/* Task items */
.card-item {
  /* background-color: var(--task-background); */
  border-radius: 4px;
  /* margin-bottom: var(--whitespace-div2); */
  min-height: var(--task-height);
  transition: all 0.2s ease;
  position: relative;
  overflow: visible;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* margin-bottom: var(--whitespace-div4); */
  /* padding-bottom: 4px; */
}




/* --- header vertical spacer --- */

/* causes problems when the tasks are folded */
/* .card-item { 
  gap: var(--whitespace-div8);
} */

.card-header {
  margin-top: var(--whitespace-div8);
  margin-bottom: var(--whitespace-div8);
}

/* .card-item .collapsed {

} */

/* .card-item.collapsed .card-header {
  padding-bottom: var(--whitespace-div8);
} */

.card-item.collapsed .card-header:not(:has()) {
  padding-bottom: var(--whitespace-div8);
}

.card-description-display {
  margin: 0px;
}

.card-section > p:first-child {
  padding-top: 0px;
  margin: 0px;
}

/* .card-description-display {
  padding-bottom: var(--whitespace-div8);
} */

.card-description-display {
  padding-bottom: var(--whitespace-div8);
}

.card-section > p:last-child {
  margin: 0px;
  padding-bottom: 0px;
}

/* .card-header {
  margin-top: var(--whitespace-div8);
} */

/* .kanban-full-height-column:not(.collapsed-vertical):not(.collapsed-horizontal) .card-header {
  margin-bottom: var(--whitespace-div8);
} */

/* --- header vertical spacer --- end --- */


/* --- tasks vertical spacer --- */

.card-item:first-of-type {
  margin-top: var(--whitespace-div4);
}

/* .card-item {
  margin-bottom: var(--whitespace-div4);
} */

.card-item:last-of-type {
  margin-bottom: 0;
}

.column-footer {
  padding-top: var(--whitespace-div4);
}

.column-content {
  gap: var(--whitespace-div2);
  /* padding: 0 var(--whitespace-div4) 0 var(--whitespace-div4); */
  padding-bottom: 0px;
  margin: 0;
}

.kanban-full-height-column:not(.collapsed-vertical):not(.collapsed-horizontal) .column-content {
  /* padding: 0 var(--whitespace-div4) var(--whitespace-div4) var(--whitespace-div4); */
}

.card-item:not(:first-child)::after {
  content: '';
  position: absolute;
  top: calc(0px - var(--whitespace-div4) - 1px);
  left: 0;
  width: 100%;
  height: 1px;
  background: repeating-linear-gradient(
    to right,
    #000 0,
    var(--vscode-panel-border) 4px,
    transparent 4px,
    transparent 8px
  );
}

/* --- tasks vertical spacer --- end --- */





/* CRITICAL FIX: Prevent task content from being draggable (only drag handle should be draggable) */
/* This prevents text selections from being dragged and creating unintended tasks */
.card-item * {
  -webkit-user-drag: none;
  -khtml-user-drag: none;
  -moz-user-drag: none;
  -o-user-drag: none;
  user-drag: none;
}

/* Allow only the drag handle to be draggable */
.card-drag-handle {
  -webkit-user-drag: element !important;
  -khtml-user-drag: element !important;
  -moz-user-drag: element !important;
  -o-user-drag: element !important;
  user-drag: element !important;
}

.card-drag-handle:active {
  cursor: grabbing;
}

/* CRITICAL FIX: Prevent column content from being draggable */
.kanban-full-height-column * {
  -webkit-user-drag: none;
  -khtml-user-drag: none;
  -moz-user-drag: none;
  -o-user-drag: none;
  user-drag: none;
}

/* Allow only the column drag handle to be draggable */
.column-drag-handle {
  background: var(--vscode-button-background, #0e639c);
  color: var(--vscode-button-foreground, #ffffff);
  border: none;
  -webkit-user-drag: element !important;
  cursor: grab;
  border-radius: 3px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.column-drag-handle:hover {
  background: var(--vscode-button-hoverBackground, #1177bb);
}

.column-drag-handle:active {
  cursor: grabbing;
}

/* Apply min and max height when task height is limited */
.card-height-limited .card-item {
  min-height: var(--task-height) !important;
  max-height: var(--task-height) !important;
}

/* .card-item:last-child {
  margin-bottom: 0;
} */

.card-item:hover {
  border: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card-item.collapsed .card-description-container {
  display: none;
}

.card-item:not(.collapsed) .card-title-container {
  display: none;
}

.card-item.collapsed .card-title-container {
  display: flex;
}

/* Hidden content reveal button - only visible when #hidden tag is active */
.card-item:not([data-hidden-content="true"]) .hidden-content-toggle,
.kanban-full-height-column:not([data-hidden-content="true"]) .hidden-content-toggle {
  display: none;
}

/* Hidden content overlay - tasks with #hidden tag */
.card-item[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-description-container {
  position: relative;
}

.card-item[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-description-container::after {
  content: 'Content hidden  use the menu to show the contents';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--vscode-editor-background);
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  font-size: 12px;
  z-index: var(--z-base);
}

/* Prevent selecting/editing hidden content */
.card-item[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-description-display {
  pointer-events: none;
  user-select: none;
}

/* Hide title when collapsed task has #hidden tag */
.card-item.collapsed[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-title-container {
  position: relative;
}

.card-item.collapsed[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-title-display {
  color: transparent;
  user-select: none;
  pointer-events: none;
}

.card-item.collapsed[data-hidden-content="true"]:not([data-hidden-revealed="true"]) .card-title-container::after {
  content: '(hidden content)';
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  font-size: 12px;
  pointer-events: none;
}

/* #hide/#hidden on column  tasks are individually hidden (no column overlay) */
/* Column "Reveal all" button visibility is handled by .hidden-content-toggle rule above */




.card-header {
  position: relative; /* Needed for absolutely positioned badge containers */
  display: flex;
  align-items: center;
  gap: var(--whitespace-div4);
	padding-left: 4px;
	padding-right: 4px;
  margin-left: 0;
  /* margin-top: var(--whitespace-div4); */
  order: 1;
  flex-shrink: 0;
}

/* Task header controls align to header center (single-line titles) */

/* Drag handles */
.drag-handle,
.card-drag-handle {
  /* background: var(--button-alternative-background); */
  /* color: var(--button-alternative-foreground); */
  /* border: var(--button-alternative-border); */
  cursor: grab;
  transition: all 0.2s;
  user-select: none;
  flex-shrink: 0;
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  font-size: 14px;
  margin: 0px;
}

.drag-handle:hover,
.card-drag-handle:hover {
  background: var(--button-alternative-background-hover);
  color: var(--button-alternative-foreground-hover);
}

.drag-handle:active,
.card-drag-handle:active {
  cursor: grabbing;
}

.card-drag-handle {
  line-height: 1;
  /* Accent color + border to distinguish from column drag handles */
  background: var(--vscode-button-background, #0e639c);
  color: var(--vscode-button-foreground, #ffffff);
  /* border: 2px solid var(--vscode-focusBorder, #007fd4) !important; */
}

.card-drag-handle:hover {
  background: var(--vscode-button-hoverBackground, #1177bb);
  border-color: var(--vscode-button-hoverBackground, #1177bb) !important;
}

/* Collapse toggles */
.collapse-toggle,
.card-collapse-toggle {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
  font-size: 10px;
  transition: all 0.2s;
  user-select: none;
  flex-shrink: 0;
  width: 16px;
  height: 16px;
  transform: rotate(90deg);
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0px;
}

.collapse-toggle:hover,
.card-collapse-toggle:hover {
  background: var(--button-secondary-background-hover);
}

.collapse-toggle.rotated,
.card-collapse-toggle.rotated {
  transform: rotate(0deg);
}

.card-collapse-toggle {
}

/* Task title container */
.card-title-container {
  flex: auto;
  display: flex;
  align-items: center;
  /* width: -webkit-fill-available; */
  /* max-width: var(--task-title-width); */
  cursor: pointer;
  overflow: hidden;

}

.card-title-container:hover {
  background-color: var(--vscode-list-hoverBackground);
}

.card-title-display {
  word-break: break-word;
  overflow-wrap: break-word;
  /* padding: 0px 4px; */
  /* border: 1px solid transparent; */
  /* box-sizing: border-box; */
  border-radius: 3px;
  box-sizing: border-box;
  cursor: pointer;
  /* min-height: 20px; */
  line-height: 1.4;
}

.card-item.collapsed .card-title-display {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.card-title-display:hover {
  background-color: var(--vscode-list-hoverBackground);
}

/* Task description */
.card-description-container {
  /* margin-top: 4px; */
  margin-left: 4px;
  order: 3;
  flex: 1 1 auto;
}

/* External URLs that can't load in webview due to security */
.external-url-blocked {
  display: inline-block;
  padding: 8px 12px;
  background: var(--vscode-textBlockQuote-background, rgba(100, 100, 100, 0.2));
  border: 1px dashed var(--vscode-textLink-foreground, #3794ff);
  border-radius: 4px;
  color: var(--vscode-textLink-foreground, #3794ff);
  font-size: 0.9em;
}

.external-url-blocked:hover {
  background: var(--vscode-textLink-foreground, #3794ff);
  color: var(--vscode-editor-background, #1e1e1e);
}

.external-url-text {
  display: inline;
}

.card-description-display {
  font-size: 13px;
  border: 1px solid transparent;
  border-radius: 3px;
  box-sizing: border-box;
  cursor: pointer;
  /* padding: 0px 8px; */
  /* padding-left: 4px;
  padding-right: 4px; */
  min-height: 20px;
  line-height: 1.4;
  overflow-wrap: break-word;
  max-height: inherit;
}

.md-task-checkbox,
.card-description-display .md-task-checkbox,
.wysiwyg-task-checkbox {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 3px;
  margin-right: 6px;
  vertical-align: text-top;
  background: var(--vscode-editor-background);
  color: var(--vscode-button-foreground);
  cursor: pointer;
}

.md-task-checkbox.checked,
.card-description-display .md-task-checkbox.checked,
.wysiwyg-task-checkbox.checked,
.wysiwyg-task-checkbox[data-checked="true"] {
  background: var(--vscode-button-background);
  border-color: var(--vscode-button-background);
}

.md-task-checkbox.checked::after,
.card-description-display .md-task-checkbox.checked::after,
.wysiwyg-task-checkbox.checked::after,
.wysiwyg-task-checkbox[data-checked="true"]::after {
  content: '';
  font-size: 11px;
  line-height: 1;
}

.md-task-checkbox:hover,
.card-description-display .md-task-checkbox:hover,
.wysiwyg-task-checkbox:hover {
  border-color: var(--vscode-focusBorder);
}

/* Task section styling for content between HRs */
.card-section {
  max-height: inherit;
  max-width: inherit;
  display: inline;
  flex-direction: column;
  outline: none;
}

/* Focus styling for task sections */
.card-section:focus {
  outline: 3px solid var(--section-focus-color);
  outline-offset: -3px;
}

/* CSS-based placeholders for empty display elements */
.column-title-text:empty::before {
  content: "Add title...";
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  opacity: 0.7;
}

.card-title-display:empty::before {
  content: "Add title...";
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  opacity: 0.7;
}

.card-description-display:empty::before,
.card-description-display:has(> .card-section:only-child:empty)::before {
  content: "Add description...";
  color: var(--vscode-descriptionForeground);
  font-size: 13px;
  font-style: italic;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 3px;
}

/* Broken task include - show disabled message instead of "Add description" */
.card-item.include-error .card-description-display:empty::before,
.card-item.include-error .card-description-display:has(> .card-section:only-child:empty)::before {
  content: "Description unavailable for broken include";
  cursor: not-allowed;
  opacity: 0.5;
}

/* Broken column include - placeholder message - uses unified error colors */
.broken-include-placeholder {
  color: var(--vscode-errorForeground, #f48771);
  font-style: italic;
  padding: 12px 8px;
  text-align: center;
  cursor: not-allowed;
}

/* Edit fields */
.column-title-edit,
.card-title-edit,
.card-description-edit {
  border: 1px solid var(--vscode-focusBorder);
  border-radius: 3px;
  background: var(--vscode-input-background);
  color: var(--vscode-foreground);
  font-family: inherit;
  resize: none;
  overflow: hidden;
}

.column-title-edit:focus,
.card-title-edit:focus,
.card-description-edit:focus {
  outline: none;
  border-color: var(--vscode-focusBorder);
}

.column-title-edit {
  font-size: 14px;
  flex: 1;
  padding: 2px 4px;
  min-height: 24px;
  width: 100%;
  min-width: 0;
}

.card-title-edit {
  font-size: 14px;
  line-height: 1.4;
  word-break: break-word;
  padding: 2px 4px;
  resize: none;
  min-height: 20px;
  width: 100%;
  /* width: var(--task-title-width); */
}

.card-description-edit {
  font-size: 13px;
  line-height: 1.25;
  padding: 4px 8px;
  width: 100%;
  min-height: 20px;
  overflow-anchor: none; /* Prevent scroll adjustment when size changes */
  box-sizing: border-box;
  max-width: 100%;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.card-description-wysiwyg {
  font-size: 13px;
  line-height: 1.4;
  padding: 0 8px;
  width: 100%;
  min-height: 20px;
  background: transparent;
  color: var(--vscode-foreground);
  border: 0;
  border-radius: 3px;
  outline: 1px solid transparent;
  box-sizing: border-box;
  overflow-anchor: none;
  caret-color: var(--vscode-editorCursor-foreground, currentColor);
}

.card-description-wysiwyg:focus-within {
  outline-color: transparent;
}

.card-description-wysiwyg .ProseMirror {
  display: block;
  outline: none;
  white-space: pre-wrap;
  word-break: break-word;
  word-wrap: break-word;
  max-height: inherit;
  max-width: inherit;
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  font-variant-ligatures: normal;
  font-feature-settings: normal;
  margin: 0;
  padding: 0;
  min-height: 1em;
  cursor: text;
  color: var(--vscode-foreground);
  caret-color: var(--vscode-editorCursor-foreground, var(--vscode-foreground, #000));
}

.card-description-wysiwyg .ProseMirror-focused,
.card-overlay-wysiwyg .ProseMirror-focused {
  outline: none;
  box-shadow: none;
  border: none;
}

.card-description-wysiwyg .ProseMirror:focus {
  caret-color: var(--vscode-editorCursor-foreground, var(--vscode-foreground, #000));
}

.card-description-wysiwyg .ProseMirror * {
  caret-color: inherit;
}

.card-description-wysiwyg .ProseMirror ::selection {
  background: var(--vscode-editor-selectionBackground, rgba(0, 120, 215, 0.3));
}

.card-description-wysiwyg .ProseMirror .ProseMirror-selectednode {
  outline: 2px solid var(--vscode-focusBorder, #007acc);
}

.card-description-wysiwyg .ProseMirror h1,
.card-description-wysiwyg .ProseMirror h2,
.card-description-wysiwyg .ProseMirror h3,
.card-description-wysiwyg .ProseMirror h4,
.card-description-wysiwyg .ProseMirror h5,
.card-description-wysiwyg .ProseMirror h6 {
  margin: 0.25em 0;
}

.card-description-wysiwyg .ProseMirror p {
  margin: 0.5em 0 !important;
  padding: 0;
}

.card-description-wysiwyg .ProseMirror ul,
.card-description-wysiwyg .ProseMirror ol {
  margin: 0.125em 0;
  padding-left: 1.5em;
}

.card-description-wysiwyg .ProseMirror code {
  padding: 0.1em 0.3em;
  border-radius: 3px;
  font-size: 0.9em;
}

.card-description-wysiwyg .ProseMirror pre {
  padding: 0.5em;
  border-radius: 3px;
  overflow-x: auto;
  margin: 0.25em 0;
}

.card-description-wysiwyg .wysiwyg-diagram {
  background: var(--vscode-editor-background);
  border: 1px solid var(--vscode-panel-border);
}

.card-description-wysiwyg .wysiwyg-diagram-block .wysiwyg-edit-btn {
  align-self: flex-start;
}

.card-description-wysiwyg .wysiwyg-diagram code {
  font-family: var(--vscode-editor-font-family);
}

.card-description-wysiwyg .ProseMirror a {
  color: var(--vscode-textLink-foreground);
  text-decoration: none;
}

.card-description-wysiwyg img {
  max-width: 100%;
  max-height: 400px;
  width: auto;
  height: auto;
  margin: 0;
  display: block;
  object-fit: contain;
}

.card-description-wysiwyg .wysiwyg-diagram-file {
  display: block;
  width: fit-content;
  max-width: 100%;
}

.card-description-wysiwyg .wysiwyg-diagram-file .diagram-placeholder,
.card-description-wysiwyg .wysiwyg-diagram-file .diagram-rendered {
  display: block;
  width: 100%;
  max-width: 100%;
}

.card-description-wysiwyg .wysiwyg-diagram-file .diagram-rendered {
  height: auto;
  max-height: 400px;
  object-fit: contain;
}

.card-description-wysiwyg .wysiwyg-media-block {
  display: block;
  width: fit-content;
  max-width: 100%;
  margin: 0 3px;
}

.card-description-wysiwyg .image-path-overlay-container.wysiwyg-media-block {
  display: block;
  width: fit-content;
  max-width: 100%;
}

.card-description-wysiwyg .video-path-overlay-container {
  display: block;
  width: 100%;
  max-width: 100%;
}

.card-description-wysiwyg .video-path-overlay-container video,
.card-description-wysiwyg .video-path-overlay-container audio {
  display: block;
  width: 100%;
  max-width: 100%;
}

.card-description-wysiwyg .wysiwyg-include-inline,
.card-description-wysiwyg .wysiwyg-include-block,
.card-description-wysiwyg .wysiwyg-media,
.card-description-wysiwyg .wysiwyg-wiki-link,
.card-description-wysiwyg .wysiwyg-tag,
.card-description-wysiwyg .wysiwyg-date-tag,
.card-description-wysiwyg .wysiwyg-person-tag,
.card-description-wysiwyg .wysiwyg-temporal-tag,
.card-description-wysiwyg .wysiwyg-footnote,
.card-overlay-wysiwyg .wysiwyg-include-inline,
.card-overlay-wysiwyg .wysiwyg-include-block,
.card-overlay-wysiwyg .wysiwyg-media,
.card-overlay-wysiwyg .wysiwyg-wiki-link,
.card-overlay-wysiwyg .wysiwyg-tag,
.card-overlay-wysiwyg .wysiwyg-date-tag,
.card-overlay-wysiwyg .wysiwyg-person-tag,
.card-overlay-wysiwyg .wysiwyg-temporal-tag,
.card-overlay-wysiwyg .wysiwyg-footnote {
  background: var(--button-secondary-background);
  color: var(--button-secondary-foreground);
  border-radius: 3px;
  padding: 0 3px;
  margin: 0 3px;
  display: inline-block;
}

.card-description-wysiwyg .wysiwyg-media[data-type="image"],
.card-description-wysiwyg .wysiwyg-media[data-type="video"],
.card-description-wysiwyg .wysiwyg-media[data-type="audio"] {
  background: transparent;
}

.card-description-wysiwyg .wysiwyg-edit-btn {
  margin-right: 6px;
  padding: 0 6px;
  border: 1px solid var(--vscode-panel-border);
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border-radius: 3px;
  font-size: 0.75em;
  line-height: 1.4;
  cursor: pointer;
}

.card-description-wysiwyg .wysiwyg-edit-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.card-description-wysiwyg .wysiwyg-include-block,
.card-description-wysiwyg .wysiwyg-media {
  display: inline-flex;
  align-items: center;
}

.card-description-wysiwyg .wysiwyg-include-block {
  display: flex;
  gap: 6px;
}

.card-description-wysiwyg .wysiwyg-diagram-block {
  display: flex;
  flex-direction: column;
  gap: 6px;
  position: relative;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  padding: 8px;
}

.card-description-wysiwyg .wysiwyg-diagram-block:not(.is-editing) .wysiwyg-diagram {
  display: none;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing {
  display: grid;
  grid-template-columns: minmax(220px, 1fr) minmax(220px, 1fr);
  gap: 10px;
  align-items: start;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview {
  grid-column: 1;
  border-right: 1px solid var(--vscode-panel-border);
  padding-right: 8px;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram {
  grid-column: 2;
  margin: 0;
  border-left: 1px solid var(--vscode-panel-border);
  padding-left: 8px;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram::before,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram::before {
  content: "```" attr(data-lang);
  display: block;
  color: var(--vscode-descriptionForeground);
  font-size: 0.8em;
  margin-bottom: 4px;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram::after,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram::after {
  content: "```";
  display: block;
  color: var(--vscode-descriptionForeground);
  font-size: 0.8em;
  margin-top: 4px;
}

.card-description-wysiwyg .wysiwyg-diagram-block .wysiwyg-edit-btn {
  display: none;
}

.card-description-wysiwyg .wysiwyg-multicolumn {
  position: relative;
  margin: 10px 3px;
  padding: 0;
  border-radius: 4px;
  background: transparent;
  outline: 1px dashed color-mix(in srgb, var(--vscode-panel-border) 70%, transparent);
  overflow: visible;
}

.card-overlay-wysiwyg .wysiwyg-multicolumn {
  position: relative;
  margin: 10px 3px;
  padding: 0;
  border-radius: 4px;
  background: transparent;
  outline: 1px dashed color-mix(in srgb, var(--vscode-panel-border) 70%, transparent);
  overflow: visible;
}

.card-description-wysiwyg .wysiwyg-multicolumn-toolbar {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: space-between;
  pointer-events: none;
  z-index: 20;
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-toolbar {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: space-between;
  pointer-events: none;
  z-index: 20;
}

.card-description-wysiwyg .wysiwyg-multicolumn-btn {
  width: 14px;
  height: 14px;
  padding: 0;
  border: 1px solid var(--vscode-panel-border);
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border-radius: 3px;
  font-size: 0.7em;
  line-height: 1;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
  transform: translateY(-6px);
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-btn {
  width: 14px;
  height: 14px;
  padding: 0;
  border: 1px solid var(--vscode-panel-border);
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border-radius: 3px;
  font-size: 0.7em;
  line-height: 1;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
  transform: translateY(-6px);
}

.card-description-wysiwyg .wysiwyg-multicolumn-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.card-description-wysiwyg .wysiwyg-multicolumn-columns {
  display: flex;
  gap: 10px;
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-columns {
  display: flex;
  gap: 10px;
}

.card-description-wysiwyg .wysiwyg-multicolumn-column {
  flex: 1 1 0;
  min-width: 0;
  padding: 10px;
  border-left: none;
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-column {
  flex: 1 1 0;
  min-width: 0;
  padding: 10px;
  border-left: none;
}

.card-description-wysiwyg .wysiwyg-multicolumn-column + .wysiwyg-multicolumn-column {
  border-left: 1px solid var(--vscode-panel-border);
}

.card-overlay-wysiwyg .wysiwyg-multicolumn-column + .wysiwyg-multicolumn-column {
  border-left: 1px solid var(--vscode-panel-border);
}


.card-description-wysiwyg .wysiwyg-diagram-preview,
.card-overlay-wysiwyg .wysiwyg-diagram-preview {
  margin: 0;
  display: block;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview {
  /* height: 240px; */
  /* max-height: 240px; */
  overflow: auto;
}

.card-description-wysiwyg .wysiwyg-diagram-preview .diagram-overlay-container,
.card-overlay-wysiwyg .wysiwyg-diagram-preview .diagram-overlay-container,
.card-description-wysiwyg .wysiwyg-diagram-preview .mermaid-diagram,
.card-overlay-wysiwyg .wysiwyg-diagram-preview .mermaid-diagram,
.card-description-wysiwyg .wysiwyg-diagram-preview .plantuml-diagram,
.card-overlay-wysiwyg .wysiwyg-diagram-preview .plantuml-diagram {
  /* width: 100%; */
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .diagram-overlay-container,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .diagram-overlay-container,
.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .mermaid-diagram,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .mermaid-diagram,
.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .plantuml-diagram,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview .plantuml-diagram {
  height: -webkite-fill-available;
  width: -webkite-fill-available;
}

.card-description-wysiwyg .wysiwyg-diagram-preview svg,
.card-overlay-wysiwyg .wysiwyg-diagram-preview svg {
  width: 100%;
  height: auto;
  max-width: 100%;
  display: block;
}

.card-description-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview svg,
.card-overlay-wysiwyg .wysiwyg-diagram-block.is-editing .wysiwyg-diagram-preview svg {
  max-height: none;
}

.card-description-wysiwyg .diagram-overlay-container,
.card-description-wysiwyg .mermaid-diagram,
.card-description-wysiwyg .plantuml-diagram,
.card-description-wysiwyg .mermaid-placeholder,
.card-description-wysiwyg .plantuml-placeholder,
.card-description-wysiwyg .diagram-placeholder {
  margin: 0;
}

.card-description-wysiwyg .wysiwyg-include-block,
.card-overlay-wysiwyg .wysiwyg-include-block {
  margin: 2px 3px;
  padding: 2px 6px;
}

/* the add task button is styled horizontally and is listed after the last card */
.add-task-btn {
  width: calc(100%);
  background: var(--button-secondary-background);
  color: var(--button-secondary-foreground);
  border: 1px dashed var(--vscode-panel-border);
  border-radius: 6px;
  padding: 8px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  margin-top: var(--whitespace-div2);
}

.add-task-btn:hover {
  background: var(--button-secondary-background-hover);
  border-color: var(--vscode-focusBorder);
}

/* Hide add-task button when column has tasks */
.column-content:has(.card-item) .add-task-btn {
  display: none;
}

/* the column button should be styled vertically and is displayed at the end of each row after the last column */
.add-column-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: 1px dashed var(--vscode-panel-border);
  border-radius: 6px;
  padding: 16px 8px;  /* Adjust padding for vertical text */
  font-size: 14px;
	margin-top: var(--whitespace-div2);
  cursor: pointer;
  transition: background-color 0.2s;
  align-self: flex-start;
  flex-shrink: 0;
  transform: rotate(180deg);
  writing-mode: vertical-rl;  /* Always vertical */
  min-height: 100px;  /* Ensure minimum height for vertical text */
}

.add-column-btn:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
  border-color: var(--vscode-focusBorder);
}

.kanban-board.multi-row .add-column-btn.multi-row-add-btn {
  transform: rotate(180deg);
  writing-mode: vertical-rl;
  padding: 12px 8px;
}

/* Initialize board container */
.initialize-container {
  text-align: center;
  padding: 40px;
  color: var(--vscode-descriptionForeground);
}

.initialize-container .initialize-message {
  margin-bottom: 20px;
  font-size: 16px;
  text-align: left;
}

.initialise-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  padding: 16px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
  align-self: flex-start;
  display: block;
}

/* Count badge */
.task-count {
  border: 1px solid var(--vscode-badge-background);
  color: var(--vscode-badge-foreground);
  border-radius: 4px;
  box-sizing: border-box;
  /* padding: 3px 6px 3px 6px; */
  font-size: 12px;
  font-weight: 500;
  display: flex;
  gap: 4px;
  padding: 0px 0px 0px 4px;

  height: 18px;
  align-items: center;
}

.kanban-full-height-column.collapsed-vertical .task-count,
.kanban-full-height-column.collapsed-horizontal .task-count {
	display: none;
}

/* Fix task count color in light mode */
body.vscode-light .task-count,
body.vscode-high-contrast-light .task-count {
  color: var(--vscode-foreground);
}

/* Fold buttons */
.fold-all-btn,
.global-fold-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
  border-radius: 3px;
  transition: all 0.2s;
  display: flex;
  align-items: flex-end;
  justify-content: center;
}

.fold-all-btn {
  padding: 2px;
  font-size: 10px;
  line-height: 1;
  min-width: 18px;
  height: 18px;
  width: 18px;
}

/* Pin button (sticky toggle) - matches collapse-toggle styling */
.pin-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
  font-size: 10px;
  line-height: 1;
  transition: all 0.2s;
  user-select: none;
  flex-shrink: 0;
  width: 18px;
  height: 18px;
  min-width: 18px;
  min-height: 18px;
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pin-btn:hover {
  background: var(--button-secondary-background-hover);
}

.pin-btn.unpinned .pin-icon {
  opacity: 0.5;
}

/* Global override: show red outline on all pins */
.pin-btn.global-override .pin-icon::after {
  content: "";
  position: absolute;
  top: -2px;
  left: -2px;
  width: 14px;
  height: 14px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%23ff0000' stroke-width='1.5' d='M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a6 6 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182a.5.5 0 0 1-.707-.707l3.182-3.182-2.829-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a6 6 0 0 1 1.013.16l3.134-3.133a3 3 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146'/%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
  background-color: transparent;
}

/* Unpinned + global override: hide white fill, show only red outline */
.pin-btn.unpinned.global-override .pin-icon::before {
  opacity: 0;
}

/* Pinned + global override: show white fill + red outline */
.pin-btn:not(.unpinned).global-override .pin-icon {
  opacity: 1;
}

.fold-all-btn:hover,
.global-fold-btn:hover {
  background: var(--button-secondary-background-hover);
}

.global-fold-btn {
  padding: 4px 8px;
  font-size: 12px;
  line-height: 1;
  gap: 4px;
  flex-shrink: 0;
  margin-left: 8px;
}

.fold-icon {
  display: block;
  line-height: 1;
  transform-origin: center;
  transition: transform 0.2s;
}

/* .global-fold-icon styles moved to CSS icons section */

.fold-all-btn.fold-collapsed .fold-icon,
.global-fold-btn.fold-collapsed .global-fold-icon {
  transform: rotate(0deg);
}

.fold-all-btn.fold-mixed .fold-icon,
.global-fold-btn.fold-mixed .global-fold-icon {
  color: var(--vscode-charts-orange);
  opacity: 0.8;
}

/* Menus */
.donut-menu,
.file-bar-menu {
  position: relative;
  z-index: 200;
  display: inline-flex;
  align-items: center;
}

/* All active menus need maximum z-index to appear above all interface elements */
.donut-menu.active,
.file-bar-menu.active {
  z-index: 1000;
  isolation: isolate;
}

.donut-menu-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  box-sizing: border-box;
  cursor: pointer;
  padding: 0;
  transition: all 0.2s;
  border-radius: 3px;
  width: 18px;
  height: 18px;
  font-size: 0; /* Hide the  text */
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

/* CSS hamburger icon - three horizontal lines */
.donut-menu-btn::before {
  content: "";
  width: 7px;
  height: 1px;
  background: currentColor;
  box-shadow: 0 -3px 0 currentColor, 0 3px 0 currentColor;
}

.donut-menu-btn:hover {
  background: var(--button-secondary-background-hover);
}

.file-bar-menu-btn {
  cursor: pointer;
  padding: 4px 8px;
  transition: all 0.2s;
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  min-height: 22px;
}

/* Hide the  text in file-bar burger button and use CSS icon */
.file-bar-menu-btn .menu-icon {
  font-size: 0;
  width: 7px;
  height: 1px;
  background: currentColor;
  box-shadow: 0 -3px 0 currentColor, 0 3px 0 currentColor;
}

.donut-menu-dropdown,
.file-bar-menu-dropdown {
  z-index: 1000;
  /* Add hover border for easier targeting */
  padding: 3px;
}

.donut-menu-dropdown {
  min-width: 150px;
}

.file-bar-menu-dropdown {
  min-width: 180px;
}

/* Collapsed column dropdowns are handled by JavaScript positioning */

.donut-menu.active .donut-menu-dropdown,
.file-bar-menu.active .file-bar-menu-dropdown,
.donut-menu-dropdown.moved-to-body,
.file-bar-menu-dropdown.moved-to-body {
  display: block;
}

.donut-menu-item,
.file-bar-menu-item {
  padding: 4px 8px;
  cursor: pointer;
  font-size: 13px;
  color: var(--vscode-dropdown-foreground);
  border: none;
  background: none;
  width: 100%;
  text-align: left;
  position: relative;
  transition: background-color 0.2s;
  white-space: nowrap;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.file-bar-menu-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.file-bar-menu-item .menu-icon {
  flex-shrink: 0;
  width: 16px;
  text-align: center;
}

button.donut-menu-item,
button.file-bar-menu-item {
  width: 100%;
  text-align: left;
}

.donut-menu-item:hover,
.file-bar-menu-item:hover {
  background-color: var(--vscode-list-hoverBackground);
}

.file-bar-menu-item.selected {
  background-color: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
  font-weight: 500;
}

.file-bar-menu-item .menu-checkmark {
  color: var(--vscode-list-activeSelectionForeground);
  font-weight: bold;
  margin-left: auto;
  flex-shrink: 0;
}

.donut-menu-item.has-submenu,
.file-bar-menu-item.has-submenu {
  padding-right: 32px;
  position: relative;
  box-sizing: border-box;
}

.donut-menu-item.has-submenu::after {
  content: '';
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-top: 6px solid transparent;
  border-bottom: 6px solid transparent;
  border-left: 6px solid var(--vscode-dropdown-foreground);
  pointer-events: none;
}

.kanban-full-height-column .donut-menu-item.has-submenu {
  padding-left: 32px;
}

.kanban-full-height-column .donut-menu-item.has-submenu::after {
  right: auto;
  left: 12px;
  border-left: none;
  border-right: 6px solid var(--vscode-dropdown-foreground);
}

.file-bar-menu-item.has-submenu::after {
  content: '';
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 10px;
  opacity: 0.6;
}

.donut-menu-item.has-submenu::before,
.kanban-full-height-column .donut-menu-item.has-submenu::before,
.file-bar-menu-item.has-submenu::before {
  content: '';
  position: absolute;
  top: 0;
  width: 10px;
  height: 100%;
  z-index: 50;
  pointer-events: none;
  background: var(--vscode-dropdown-background);
  border-top: 1px solid var(--vscode-dropdown-border);
  border-bottom: 1px solid var(--vscode-dropdown-border);
  border-right: 1px solid var(--vscode-dropdown-border);
  border-left: none;
  border-radius: 0 4px 4px 0;
}

.donut-menu-item.has-submenu::before {
  left: 100%;
}

.kanban-full-height-column .donut-menu-item.has-submenu::before,
.file-bar-menu-item.has-submenu::before {
  right: 100%;
  border-left: 1px solid var(--vscode-dropdown-border);
  border-right: none;
  border-radius: 4px 0 0 4px;
}

.donut-menu-submenu,
.file-bar-menu-submenu {
  display: none;
  position: fixed;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  min-width: 180px;
  max-width: 280px;
	width: auto;
  max-height: 80vh;
  z-index: 1000;
  pointer-events: all !important;
  overflow-x: hidden;
  overflow-y: auto;
  word-wrap: break-word;
}

/* Tag grid submenus need constrained width for wrapping */
.donut-menu-submenu:has(.donut-menu-tags-grid) {
  min-width: 250px;
  max-width: 350px;
  width: 320px;
}

/* Submenus are positioned by JavaScript */

.file-bar-menu-submenu {
  min-width: 140px;
  box-sizing: border-box;
}

/* Ensure all submenu content respects container bounds */
.donut-menu-submenu *,
.file-bar-menu-submenu * {
  max-width: 100%;
}

/* Tag grids in submenus use flex layout */
.donut-menu-submenu .donut-menu-tags-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 2px;
  padding: 2px;
  width: 100%;
}

/* Submenu items prevent overflow */
.donut-menu-submenu .donut-menu-item,
.file-bar-menu-submenu .file-bar-menu-item {
  width: calc(100% - 2px);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Menu icons don't shrink */
.donut-menu-submenu .menu-icon,
.file-bar-menu-submenu .menu-icon {
  flex-shrink: 0;
}

/* Tag chips in submenus */
.donut-menu-submenu .donut-menu-tag-chip {
  display: flex;
  align-items: center;
  /* min-width: 60px; */
  /* max-width: calc(50% - 2px); */
  overflow: hidden;
  gap: 3px;
  margin: 2px;
  padding: 2px 6px;
  pointer-events: all !important;
  cursor: pointer;
  border-radius: 3px;
  transition: background-color 0.2s ease;
  position: relative;
  z-index: 10;
}

/* Tag chip text truncates */
.donut-menu-submenu .donut-menu-tag-chip .tag-chip-name {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: 11px;
}

/* Tag chip check icon fixed size */
.donut-menu-submenu .donut-menu-tag-chip .tag-chip-check {
  flex: none;
  width: 16px;
  height: 16px;
}

.donut-menu-submenu button.donut-menu-item,
.file-bar-menu-submenu button.file-bar-menu-item {
  display: block;
  width: 100%;
  text-align: left;
  border: none;
  background: none;
  padding: 8px 12px;
  margin: 0;
  white-space: nowrap;
  cursor: pointer !important;
  font-size: 13px;
  color: var(--vscode-dropdown-foreground);
  transition: background-color 0.2s ease;
  pointer-events: all !important;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
  position: relative;
  z-index: 10;
  /* Ensure buttons are always interactive */
  touch-action: manipulation;
  user-select: none;
}

.donut-menu-submenu button.donut-menu-item:hover,
.file-bar-menu-submenu button.file-bar-menu-item:hover,
.donut-menu-submenu .donut-menu-tag-chip:hover {
  background-color: var(--vscode-list-hoverBackground);
}

.donut-menu-divider,
.file-bar-menu-divider {
  height: 1px;
  background: var(--vscode-panel-border);
  margin: 4px 0;
}

.donut-menu-item.danger {
  color: var(--vscode-errorForeground);
}

/* Span width controls in column menu */
.donut-menu-item.span-width-control {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* padding: 8px 12px; */
}

.span-width-label {
  font-size: 13px;
  color: var(--vscode-menu-foreground);
}

.span-width-controls {
  display: flex;
  align-items: center;
  gap: 6px;
}

.span-width-btn {
  background: var(--button-background);
  border: var(--button-border);
  color: var(--button-foreground);
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  border-radius: 3px;
  transition: background-color 0.1s ease;
}

.span-width-btn:hover {
  background: var(--button-background-hover);
}

.span-width-btn:active {
  background: var(--button-background);
  transform: scale(0.95);
}

.span-width-value {
  font-size: 13px;
  color: var(--vscode-menu-foreground);
  min-width: 12px;
  text-align: center;
  font-weight: 500;
}

.donut-menu-item.stack-control {
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* padding: 8px 12px; */
}

.stack-label {
  font-size: 13px;
  color: var(--vscode-menu-foreground);
}

.stack-toggle-btn {
  background: var(--button-background);
  border: var(--button-border);
  color: var(--button-foreground);
  padding: 4px 8px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  cursor: pointer;
  border-radius: 3px;
  min-width: 32px;
  transition: all 0.1s ease;
}

.stack-toggle-btn:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
}

.stack-toggle-btn.active {
  background: var(--button-background-active);
  color: var(--button-foreground-active);
  border: var(--button-border-active);
}

.kanban-column-stack {
  display: grid;
  grid-template: 1fr / 1fr;
  position: relative;
  height: 100%;
  /* preserve-3d enables children's translateZ to work; stack at z=0 */
  transform-style: preserve-3d;
  transform: translateZ(0px);
}

/* All columns in grid */
.kanban-column-stack .kanban-full-height-column {
  grid-row: 1;
  grid-column: 1;
  align-self: start;
  /* preserve-3d needed so children's translateZ works; column at z=0 */
  transform-style: preserve-3d;
  transform: translateZ(0px);
}

/* Only expanded columns overlay with pointer-events */
.kanban-column-stack .kanban-full-height-column {
  pointer-events: none;
}

/* Re-enable pointer events on interactive child elements */
.kanban-column-stack .kanban-full-height-column .column-header,
.kanban-column-stack .kanban-full-height-column .column-title,
.kanban-column-stack .kanban-full-height-column .column-footer,
.kanban-column-stack .kanban-full-height-column .column-content {
  pointer-events: auto;
}

/* Sticky headers and titles at bottom with dynamic offsets (set by JavaScript inline styles) */
.kanban-column-stack .kanban-full-height-column .column-margin,
.kanban-column-stack .kanban-full-height-column .column-header,
.kanban-column-stack .kanban-full-height-column .column-title,
.kanban-column-stack .kanban-full-height-column .column-footer {
  position: sticky;
  background: var(var(--task-background));
  z-index: 100;
}

/* ==========================================================================
   3D STACKING ORDER FOR STACKED COLUMNS - DO NOT MODIFY!
   ==========================================================================

   This stacking order uses CSS 3D transforms (translateZ) to ensure proper
   layering of column elements across multiple stacked columns.

   STACKING ORDER (back to front):
   -----------------------------------------------------------------------
   1. column-offset, column-margin: translateZ(0.1px)  - FURTHEST BACK
   2. column-content             : translateZ(0.2px)
   3. column-header, column-footer: translateZ(0.3px)
   4. column-title               : translateZ(10px)   - ALWAYS ON TOP
   -----------------------------------------------------------------------

   CRITICAL SETUP:
   - .kanban-column-stack: preserve-3d + translateZ(0) - creates 3D space
   - .kanban-full-height-column: preserve-3d + translateZ(0) - passes 3D to children
   - Child elements: only translateZ() for stacking (no preserve-3d)

   Both stack and column need preserve-3d so grandchildren's translateZ works!

   The column-title has a high translateZ(10px) to ensure it's ALWAYS
   visible above all other content, including content from other columns.

   DO NOT CHANGE THESE VALUES! They are carefully calibrated to:
   - Keep column backgrounds behind interactive content
   - Ensure column-title is always clickable and visible
   - Maintain proper visual layering across stacked columns

   ========================================================================== */

.kanban-column-stack .kanban-full-height-column .column-offset,
.kanban-column-stack .kanban-full-height-column .column-margin {
  transform: translateZ(0.1px);
}

.kanban-column-stack .kanban-full-height-column .column-margin {
  height: var(--whitespace-div2);
}

.kanban-column-stack .kanban-full-height-column .column-content {
  transform: translateZ(0.2px);
}

.kanban-column-stack .kanban-full-height-column .column-header,
.kanban-column-stack .kanban-full-height-column .column-footer {
  transform: translateZ(0.3px);
}

.kanban-column-stack .kanban-full-height-column .column-title {
  transform: translateZ(10px);
}

/* Stack sticky mode: titleonly - only title is sticky (only for columns with #sticky tag) */
body.sticky-stack-mode-titleonly .kanban-column-stack .kanban-full-height-column[data-column-sticky="true"] .column-header {
  position: relative !important;
}

body.sticky-stack-mode-titleonly .kanban-column-stack .kanban-full-height-column[data-column-sticky="true"] .column-footer {
  position: relative !important;
}

body.sticky-stack-mode-titleonly .kanban-column-stack .kanban-full-height-column[data-column-sticky="true"] .column-margin {
  position: relative !important;
}

/* Per-column sticky control: when data-column-sticky="false", nothing is sticky */
.kanban-column-stack .kanban-full-height-column[data-column-sticky="false"] .column-header {
  position: relative !important;
}

.kanban-column-stack .kanban-full-height-column[data-column-sticky="false"] .column-title {
  position: relative !important;
}

.kanban-column-stack .kanban-full-height-column[data-column-sticky="false"] .column-footer {
  position: relative !important;
}

.kanban-column-stack .kanban-full-height-column[data-column-sticky="false"] .column-margin {
  position: relative !important;
}

/* Base styling for collapsed columns */
.kanban-full-height-column.collapsed-vertical,
.kanban-full-height-column.collapsed-horizontal {
  overflow: visible;
  /* width: min-content; */
  position: sticky;
  top: 0;
  align-self: flex-start;
  /* z-index: 5; */
}

.kanban-column-stack.all-vertical-folded .kanban-full-height-column.collapsed-vertical {
	width: min-content;
}

/* Collapsed column content */
.kanban-full-height-column.collapsed-vertical .column-content,
.kanban-full-height-column.collapsed-horizontal .column-content {
  overflow: visible;
  flex: none;
  display: flex;
  flex-direction: column;
  height: auto;
  min-height: auto;
}

/* Vertical fold: rotate text vertically */
.kanban-full-height-column.collapsed-vertical .column-title-text {
  width: min-content;
  writing-mode: sideways-rl;
  transform: rotate(180deg);
  display: flex;
  align-items: center;
  /* justify-content: center; */
  /* flex: 1; */
  /* width: 100%; */
  padding: 5px 0;
  /* margin: 0; */
  gap: 4px;
  white-space: nowrap;
  /* rotate:-90deg; */
}

.kanban-full-height-column.collapsed-vertical .markdown-content ::before {
  rotate: 90deg;
  margin-bottom: 2px;
}

.kanban-full-height-column.collapsed-vertical .kanban-tag,
.kanban-full-height-column.collapsed-vertical .kanban-temporal-tag {
  padding: 1px;
  margin: 3px;
}

/* Horizontal fold: keep text horizontal but narrow */
.kanban-full-height-column.collapsed-horizontal .column-title-text {
  /* display: flex; */
  align-items: center;
  flex: 1;
  width: 100%;
  margin: 0;
  gap: 4px;
}

/* Hide column-content when collapsed in stacks */
.kanban-column-stack .kanban-full-height-column.collapsed-vertical .column-content,
.kanban-column-stack .kanban-full-height-column.collapsed-horizontal .column-content {
  display: none !important;
}

/* Column drop zones for horizontal positioning */
.column-drop-zone-stack {
  display: flex;
  flex-direction: column;
  height: 100%;
  flex-shrink: 0;
}

.column-drop-zone {
  min-width: var(--whitespace);
  height: 100%;
  flex-shrink: 0;
  background: transparent;
  transition: min-width 0.15s ease 0.1s, background 0.2s ease, width 0.15s ease 0.1s;
}

/* BEGIN style with only lines not with borders */

.column-drop-zone-stack:not(:first-child) .column-drop-zone {
  background: linear-gradient(var(--vscode-panel-border), var(--vscode-panel-border)) no-repeat center / 2px 100%;
}

.kanban-column-stack .kanban-full-height-column:not(:first-child) .column-margin {
  background: linear-gradient(var(--vscode-panel-border), var(--vscode-panel-border)) no-repeat center / 100% 1px;
}

.stack-bottom-drop-zone {
  background: linear-gradient(var(--vscode-panel-border), var(--vscode-panel-border)) no-repeat 0 4px / 100% 1px;
}


/* END style with only lines not with borders */

/* Visual feedback for drop zones - no scaling */
.column-drop-zone.drag-over,
.column-drop-zone-stack .column-drop-zone.drag-over,
.stack-bottom-drop-zone.drag-over {
  background: var(--vscode-editor-selectionBackground) !important;
  border: 2px dashed var(--vscode-editor-selectionForeground);
  border-radius: 4px;
}

/* Horizontal drop zones between columns in stack - background only, no border */
.column-margin.drag-over,
.kanban-column-stack .kanban-full-height-column .column-margin.drag-over {
  background: var(--vscode-editor-selectionBackground) !important;
}

/* Visual feedback when dropping task at end of column (hovering over column-title) */
.column-title.task-drop-target {
  background: var(--vscode-editor-selectionBackground);
  outline: 2px dashed var(--vscode-focusBorder);
  outline-offset: -2px;
  border-radius: 4px;
}

/* Visual separation - add padding to content of stacked columns
.kanban-column-stack .kanban-full-height-column:nth-child(n+2) .column-content {
  padding-top: var(--whitespace);
} */

/* When all columns in a stack are vertically folded (.collapsed), display them horizontally */
.kanban-column-stack.all-vertical-folded {
  display: flex !important;
  flex-direction: row !important;
  align-items: flex-start;
  gap: var(--whitespace);
  min-height: auto;
}

.kanban-column-stack.all-vertical-folded .kanban-full-height-column {
  min-height: auto;
}

/* Vertically folded columns use sticky positioning based on sticky stack mode setting */
/* Removed position: relative override to allow JavaScript sticky positioning control */

.card-header > .donut-menu {
  margin-left: auto;
  flex-shrink: 0;
}

/* Tags menu - base styles (overridden for submenus) */
.donut-menu-tags-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  padding: 8px;
  background: var(--vscode-menu-background);
  border: 1px solid var(--vscode-menu-border);
  border-radius: 4px;
  max-width: 300px;
  width: 100%;
}

.donut-menu-tag-chip {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border: 2px solid;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--vscode-menu-foreground);
  white-space: nowrap;
  flex: 0 0 auto;
  max-width: none;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  z-index: 100;
  position: relative !important;
}

.donut-menu-tag-chip:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  transform: translateY(-1px);
}

.donut-menu-tag-chip.active {
  /* font-weight: bold; */
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
}

.donut-menu-tag-chip .tag-chip-check {
  font-size: 10px;
  font-weight: bold;
  min-width: 10px;
  display: inline-block;
}

.donut-menu-tag-chip .tag-chip-name {
  text-transform: capitalize;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: none;
  flex: 1;
  min-width: 0;
}

/* Marp submenu layout helpers */
.marp-menu-panel {
  padding: 8px;
}

.marp-menu-panel--wide {
  max-width: 450px;
  min-width: 300px;
}

.marp-menu-panel--compact {
  max-width: 350px;
  min-width: 250px;
}

.marp-menu-section {
  margin-bottom: 12px;
}

.marp-menu-section-title,
.marp-menu-label {
  font-weight: bold;
  color: #ddd;
  font-size: 10px;
}

.marp-menu-section-title {
  margin-bottom: 6px;
}

.marp-menu-label {
  white-space: nowrap;
}

.marp-menu-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.marp-menu-row--stacked {
  flex-direction: column;
  align-items: baseline;
  margin-bottom: 8px;
}

.marp-menu-inputs {
  display: flex;
  gap: 8px;
  margin-bottom: 4px;
}

.marp-menu-input {
  flex: 1;
  padding: 6px;
  background: var(--board-background);
  border: 1px solid transparent;
  color: var(--vscode-foreground);
  border-radius: 4px;
  font-size: 11px;
}

.marp-menu-input--local {
  border-color: #4a90e2;
}

.marp-menu-input--scoped {
  border-color: #ff9500;
}

.marp-tag-chip {
  background: var(--vscode-menu-background);
}

.marp-tag-chip--local {
  border-color: #4a90e2;
}

.marp-tag-chip--scoped {
  border-color: #ff9500;
}

.marp-tag-chip--local.active {
  background: #4a90e2;
}

.marp-tag-chip--scoped.active {
  background: #ff9500;
}

.marp-menu-paginate {
  display: flex;
  gap: 8px;
}

.marp-menu-paginate-button {
  flex: 1;
  padding: 6px 8px;
  font-size: 11px;
  border: 1px solid transparent;
  border-radius: 4px;
  background: var(--board-background);
  color: var(--vscode-foreground);
  cursor: pointer;
  text-align: center;
}

.marp-menu-paginate-button--local {
  border-color: #4a90e2;
}

.marp-menu-paginate-button--scoped {
  border-color: #ff9500;
}

.marp-menu-paginate-button--local.is-active {
  background: #4a90e2;
}

.marp-menu-paginate-button--scoped.is-active {
  background: #ff9500;
}

.donut-menu-item.has-submenu:hover .donut-menu-tags-grid {
  display: flex;
}

/* Tag grid submenus are positioned by JavaScript like all other submenus */

/* Removed conflicting max-width rules - using flexible container instead */

.donut-menu-dropdown {
  overflow: visible;
}

/* Tag chip border colors are set dynamically via inline styles based on tag configuration */

/* Modal */
.modal {
  display: none;
  position: fixed;
  z-index: 2000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.5);
}

#input-modal {
  align-items: center;
  justify-content: center;
}

#input-modal .modal-content {
  margin: 0;
  min-width: 200px;
  width: min(90%, 420px);
}

.modal-content {
  background-color: var(--vscode-editor-background);
  margin: 5vh auto;
  padding: 0px 8px 8px 8px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 8px;
  width: min-content;
  max-width: 80%;
  height: min-content;
  max-height: 80%;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.input-modal-error {
  display: none;
  margin-top: 6px;
  color: var(--vscode-errorForeground, #f14c4c);
  font-size: 12px;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 4px;
  padding-bottom: 3px;
  border-bottom: 1px solid var(--vscode-panel-border);
  flex-shrink: 0;
  min-height: 24px;
}

.modal-header-actions {
  display: flex;
  gap: 4px;
  align-items: center;
}

.btn-export-header {
  padding: 3px 8px;
  font-size: 12px;
  line-height: 1.2;
  border: var(--button-border);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

.btn-export-header:hover {
  box-shadow: 0 0 0 2px var(--vscode-focusBorder);
}

.modal-title {
  font-size: 16px;
  font-weight: 500;
  line-height: 1.2;
	margin: 0px;
}

.close-btn {
  background: var(--button-secondary-background);
  border: var(--button-border);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
  border-radius: 4px;
  font-size: 16px;
  line-height: 1;
  cursor: pointer;
  color: var(--button-secondary-foreground);
  padding: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
	margin: 4px 0px 0px 6px;
}

.close-btn:hover {
  background: var(--button-secondary-background-hover);
  box-shadow: 0 0 0 2px var(--vscode-focusBorder);
}

.form-input {
  width: 100%;
  box-sizing: border-box;
  padding: 4px;
  border: 1px solid var(--vscode-input-border);
  border-radius: 4px;
  background-color: var(--vscode-input-background);
  color: var(--vscode-input-foreground);
  font-family: inherit;
  font-size: 14px;
}

.form-input:focus {
  outline: none;
  border-color: var(--vscode-focusBorder);
}

.form-input::placeholder {
  color: var(--vscode-input-placeholderForeground, #888);
  font-style: italic;
}

.modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--vscode-panel-border);
  flex-shrink: 0;
}

.btn {
  padding: 2px 8px;
	margin: 6px 0px 2px 0px;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.btn-primary {
  background: var(--button-background);
  color: var(--button-foreground);
}

.btn-primary:hover {
  background: var(--button-background-hover);
}

.btn-secondary {
  background: var(--button-secondary-background);
  color: var(--button-secondary-foreground);
  border: var(--button-border);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

.btn-secondary:hover {
  background: var(--button-secondary-background-hover);
  box-shadow: 0 0 0 2px var(--vscode-focusBorder);
}

.modal-body {
  flex: 1;
  overflow-y: auto;
  padding-right: 4px;
}

.export-field {
  margin-bottom: 12px;
}

.export-field-compact {
  margin-top: 8px;
}

.export-field-row {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.export-field-half {
  flex: 1;
}

.export-field-third {
  flex: 1;
}

.export-field-half label,
.export-field-third label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  font-size: 13px;
}

.export-field label {
  display: block;
  font-weight: 500;
  margin-bottom: 6px;
  color: var(--vscode-foreground);
  font-size: 13px;
}

.export-folder-input {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.export-folder-input input {
  flex: 1;
  word-wrap: break-word;
  overflow-wrap: break-word;
  white-space: normal;
  min-height: 28px;
  height: auto;
}

.export-checkboxes {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 4px;
  margin-top: 6px;
}

.export-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-weight: normal;
}

.export-checkbox input[type="checkbox"] {
  width: 16px;
  height: 16px;
  margin: 0;
}

/* Marp Status Indicator */
.marp-status {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--vscode-editor-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  font-size: 12px;
}

.status-label {
  font-weight: 500;
  color: var(--vscode-foreground);
}

.status-text {
  font-weight: 400;
}

.status-success {
  color: var(--vscode-testing-iconPassed, #73c991);
}

.status-warning {
  color: var(--vscode-editorWarning-foreground, #cca700);
}

.status-pending {
  color: var(--vscode-foreground);
  opacity: 0.7;
}

/* Export Visual Selector (Kanban-style layout) */
.export-tree-container {
  flex: 1;
  overflow-x: auto;
  overflow-y: auto;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 6px;
  background-color: var(--vscode-editor-background);
  margin-top: 6px;
}

.export-selector-empty {
  text-align: center;
  padding: 20px;
  color: var(--vscode-descriptionForeground);
  font-style: italic;
}

.export-selector-main {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: max-content;
}

/* Full Kanban option */
.export-selector-full {
  padding: 2px 10px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  background-color: var(--vscode-input-background);
  cursor: pointer;
  font-weight: 600;
  text-align: center;
  transition: border-color 0.15s ease, background-color 0.15s ease;
}

.export-selector-full:hover {
  border-color: var(--vscode-list-hoverBackground);
  background-color: var(--vscode-list-hoverBackground);
}

.export-selector-full.selected {
  border-color: var(--vscode-focusBorder);
  background-color: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

/* Row container */
.export-selector-row {
  display: flex;
  gap: 4px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 2px;
  background-color: var(--vscode-input-background);
  transition: border-color 0.15s ease, background-color 0.15s ease;
}

.export-selector-row:hover {
  border-color: var(--vscode-list-hoverBackground);
  background-color: var(--vscode-list-hoverBackground);
}

.export-selector-row.selected {
  border-color: var(--vscode-focusBorder);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
  background-color: var(--vscode-list-activeSelectionBackground);
}

.export-selector-row-label {
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  padding: 2px 4px;
  font-weight: 500;
  cursor: pointer;
  border-radius: 2px;
  background-color: var(--button-secondary-background);
  color: var(--button-secondary-foreground);
  font-size: 0.85em;
  white-space: nowrap;
  flex-shrink: 0;
  text-align: center;
}

.export-selector-row-label:hover {
  background-color: var(--button-secondary-background-hover);
}

/* Columns container (horizontal) */
.export-selector-columns-container {
  display: flex;
  gap: 4px;
  flex-wrap: nowrap;
  align-items: flex-start;
  flex: 1;
}

/* Stack (vertical container) */
.export-selector-stack {
  display: flex;
  flex-direction: column;
  gap: 2px;
  border: 1px dashed var(--vscode-panel-border);
  border-radius: 3px;
  padding: 2px;
  background-color: rgba(128, 128, 128, 0.05);
  cursor: pointer;
  transition: border-color 0.15s ease, background-color 0.15s ease;
  min-width: 120px;
  max-width: 250px;
  width: fit-content;
  flex-shrink: 0;
}

.export-selector-stack:hover {
  border-color: var(--vscode-list-hoverBackground);
  background-color: var(--vscode-list-hoverBackground);
}

.export-selector-stack.selected {
  border-color: var(--vscode-focusBorder);
  border-style: solid;
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
  background-color: var(--vscode-list-activeSelectionBackground);
}

.export-selector-stack-label {
  font-size: 0.75em;
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  padding: 2px 4px;
  text-align: center;
}

/* Regular column (not stacked) */
.export-selector-column {
  padding: 2px 8px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 3px;
  background-color: var(--button-background);
  color: var(--button-foreground);
  cursor: pointer;
  font-size: 0.9em;
  white-space: normal;
  word-wrap: break-word;
  transition: border-color 0.15s ease, background-color 0.15s ease;
  flex-shrink: 0;
  min-width: 80px;
  max-width: 250px;
}

.export-selector-column:hover {
  border-color: var(--vscode-list-hoverBackground);
  background-color: var(--vscode-list-hoverBackground);
  color: var(--vscode-list-hoverForeground);
}

.export-selector-column.selected {
  border-color: var(--vscode-focusBorder);
  background-color: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

/* Stacked column (horizontal line in stack) */
.export-selector-stacked-column {
  padding: 2px 6px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 2px;
  background-color: var(--button-background);
  color: var(--button-foreground);
  cursor: pointer;
  font-size: 0.85em;
  white-space: normal;
  word-wrap: break-word;
  transition: border-color 0.15s ease, background-color 0.15s ease;
}

.export-selector-stacked-column:hover {
  border-color: var(--vscode-list-hoverBackground);
  background-color: var(--vscode-list-hoverBackground);
  color: var(--vscode-list-hoverForeground);
}

.export-selector-stacked-column.selected {
  border-color: var(--vscode-focusBorder);
  background-color: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
  box-shadow: 0 0 0 1px var(--vscode-focusBorder);
}

.export-selector-column.excluded,
.export-selector-stacked-column.excluded {
  opacity: 0.4;
  cursor: default;
  border-style: dashed;
}

/* Link Handling Options */
.link-handling-options {
  margin-left: 24px;
  margin-top: 12px;
  padding-left: 12px;
  border-left: 2px solid var(--vscode-panel-border);
}

.export-field-label {
  font-size: 12px;
  color: var(--vscode-descriptionForeground);
  margin-bottom: 8px;
  font-weight: 500;
}

#file-type-options {
  margin-bottom: 12px;
}

#file-size-option {
  margin-top: 8px;
}

/* single row layout */
.kanban-row {
  position: relative;
  transition: all 0.2s;
  display: flex;
  gap: 0px;
  align-items: flex-start;
	/* padding: var(--whitespace); */
  width: 100%;
	
	height: auto; 
	min-height: auto; 
	max-height: none; 
	overflow: visible;
}

/* single-row layout: rows without nested rows get full height */
.kanban-board:not(.multi-row) .kanban-row:not(:has(.kanban-row)) {
  height: 100%;
}

.kanban-board.multi-row .kanban-row {
  position: relative;
	margin-bottom: var(--whitespace-div2);
	border-top: 0.5px dashed var(--vscode-panel-border);
}

.kanban-board.multi-row .kanban-row.drag-over {
  background-color: rgba(var(--vscode-focusBorder-rgb, 0, 122, 204), 0.1);
  outline: 2px dashed var(--vscode-focusBorder);
  outline-offset: -2px;
}

.kanban-board.multi-row .row-drop-zone-spacer {
  position: relative;
  z-index: 1;
}

.kanban-board.multi-row .kanban-row:last-child {
  border-bottom: none;
}

.kanban-board.multi-row .kanban-full-height-column {
  flex-shrink: 0;
}

.kanban-row-header {
  position: sticky;
  left: 0;
  background: var(--vscode-editor-background);
  padding: 8px;
  margin-right: var(--whitespace);
  min-width: 60px;
  text-align: center;
  border-radius: 4px;
  border: 1px solid var(--vscode-panel-border);
  font-size: 12px;
  color: var(--vscode-descriptionForeground);
  align-self: flex-start;
  z-index: 10;
  user-select: none;
}

.kanban-row.drag-over {
  background-color: rgba(var(--vscode-focusBorder), 0.1);
  border-radius: 8px;
  box-shadow: inset 0 0 0 2px var(--vscode-focusBorder);
  min-height: 200px;
}

.kanban-row.drag-over::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(var(--vscode-focusBorder), 0.05) 50%, 
    transparent 100%);
  pointer-events: none;
}

.kanban-row:has(.kanban-full-height-column.dragging) {
  opacity: 0.9;
}

.kanban-row:not(:has(.kanban-full-height-column)) {
  border: 2px dashed var(--vscode-panel-border);
  background-color: var(--vscode-list-hoverBackground);
  opacity: 0.5;
  padding: 20px;
  text-align: center;
  min-width: 100%;
  width: 100%;
}

.kanban-row:not(:has(.kanban-full-height-column))::after {
  content: "Drop columns here";
  color: var(--vscode-descriptionForeground);
  font-style: italic;
}

.kanban-row:has(.kanban-full-height-column.dragging):not(:has(.kanban-full-height-column:not(.dragging))) {
  border: none;
  background-color: transparent;
  justify-content: flex-start;
  align-items: flex-start;
  width: 100%;
}

.kanban-row:not(:has(.kanban-full-height-column:not(.dragging))) {
  border: 2px dashed var(--vscode-panel-border);
  background-color: var(--vscode-list-hoverBackground);
  justify-content: center;
  align-items: center;
}

.kanban-row:not(:has(.kanban-full-height-column:not(.dragging)))::after {
  content: "Drop columns here for Row " attr(data-row-number);
  color: var(--vscode-descriptionForeground);
  font-style: italic;
  font-size: 14px;
  opacity: 0.7;
}

.kanban-row.drag-over:not(:has(.kanban-full-height-column:not(.dragging)))::after {
  opacity: 1;
  font-weight: bold;
}

.kanban-row:has(.kanban-full-height-column)::after {
  display: none;
}

.kanban-row.drag-over::after {
  display: none;
}

.row-drop-zone-spacer {
  flex: 1 1 auto;
  min-height: 200px;
  pointer-events: all;
  position: relative;
}

.kanban-row.drag-over .row-drop-zone-spacer {
  min-width: 100px;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(var(--vscode-focusBorder), 0.05) 50%, 
    transparent 100%);
}

.column-title-text:not(:has(.column-row-tag)) {
  min-height: inherit;
}

/* Row tags */

/* Drag and drop styles */
.card-item.dragging {
  opacity: 0.5;
  will-change: transform, opacity;
}

.kanban-full-height-column.drag-over .column-title,
.kanban-full-height-column.drag-over .column-content {
  position: relative;
  background-color: var(--vscode-list-hoverBackground);
}

.kanban-full-height-column.dragging {
  z-index: 1000 !important;
  pointer-events: none;
  will-change: transform, opacity;
}

/* Multi-row drag overlay fix: ensure proper stacking context for rows */
.kanban-board.multi-row .kanban-row {
  z-index: 1;
}

/* When dragging in multi-row mode, hide column content and set auto height */
.kanban-board.multi-row .kanban-row:has(.kanban-full-height-column.dragging) {
  z-index: 1001; /* Ensure dragging row appears above other rows */
}

/* Hide column content during drag in multi-row to reduce visual clutter */
.kanban-board.multi-row .kanban-full-height-column.dragging .column-content {
  max-height: 100px;
  overflow: hidden;
  opacity: 0.3;
}

/* Show stacked columns during drag operations */
.kanban-board.multi-row .kanban-full-height-column.dragging.column-span-2,
.kanban-board.multi-row .kanban-full-height-column.dragging.column-span-3,
.kanban-board.multi-row .kanban-full-height-column.dragging.column-span-4 {
  opacity: 1;
  pointer-events: auto;
}

.kanban-full-height-column.dragging .column-drag-handle {
  pointer-events: auto !important;
}

.drag-preview {
  opacity: 0.8;
}

.drag-transitioning {
  transition: transform 0.05s ease;
  will-change: transform;
  contain: layout;
}

.kanban-full-height-column.drag-over .column-title::before {
  content: '';
  position: absolute;
  left: -4px;
  top: 0;
  width: 4px;
  height: 100%;
  background-color: var(--vscode-focusBorder);
  z-index: 10;
  border-radius: 2px;
}

.kanban-full-height-column.drag-over .column-content::before {
  content: '';
  position: absolute;
  left: -4px;
  top: 0;
  width: 4px;
  height: 100%;
  background-color: var(--vscode-focusBorder);
  z-index: 10;
  border-radius: 2px;
}

#kanban-container.drag-highlight {
  background-color: rgba(0, 122, 204, 0.1);
  border: 2px dashed var(--vscode-focusBorder);
  border-radius: 8px;
  position: relative;
}

/* Visual feedback when dragging over column header/areas outside tasks */
.kanban-full-height-column.drag-over-append .column-title {
  background-color: var(--vscode-list-hoverBackground) !important;
  border-bottom: 3px solid var(--vscode-focusBorder);
  position: sticky;
}

.kanban-full-height-column.drag-over-append .column-title::after {
  content: 'Drop to add at end';
  position: absolute;
  bottom: -18px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--vscode-editor-background);
  color: var(--vscode-focusBorder);
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 10px;
  white-space: nowrap;
  z-index: 1000;
  pointer-events: none;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
}

.kanban-full-height-column.external-drag-over .column-title,
.kanban-full-height-column.external-drag-over .column-content {
  background-color: var(--vscode-list-hoverBackground);
  border: 2px dashed var(--vscode-focusBorder);
  border-radius: 8px 0px 8px 0px;
  position: relative;
}

/* UNIFIED: Single drop indicator for all drag types (tasks, external files, etc.) */
.drop-indicator {
  position: fixed;
  height: 3px;
  background-color: var(--vscode-focusBorder);
  border-radius: 2px;
  z-index: 2000; /* Above everything */
  pointer-events: none;
  display: none;
  box-shadow: 0 0 6px var(--vscode-focusBorder);
  will-change: transform, opacity, top, left;
}

.drop-indicator.active {
  display: block;
}

/* Dim the dragged task during drag (stays in original position) */
.card-item.drag-source {
  opacity: 0.3;
  filter: grayscale(50%);
  will-change: transform, opacity;
}

.kanban-full-height-column.drag-source {
  opacity: 0.3;
  filter: grayscale(50%);
  will-change: transform, opacity;
}

/* Markdown content */
.markdown-content {
  word-wrap: break-word;
  max-height: inherit;
  max-width: inherit;
  /* flex-shrink: 0; */
}

.special-char-overlay {
  position: absolute;
  pointer-events: none;
  white-space: pre-wrap;
  overflow-wrap: break-word;
  overflow: hidden;
  z-index: 2;
}

.special-char-overlay-inner {
  display: block;
  width: 100%;
  height: 100%;
}

.special-char-overlay .special-char {
  display: inline;
  color: transparent;
  pointer-events: none;
}

/* Space: centered dot via CSS radial-gradient (zero layout impact, CodeMirror technique) */
.special-char-overlay .special-space {
  background-image: radial-gradient(circle at 50% 55%, var(--vscode-editorWhitespace-foreground, var(--vscode-descriptionForeground)) 13%, transparent 13%);
}

/* Tab: arrow indicator (tabs are rare, position: relative only on this element) */
.special-char-overlay .special-tab {
  position: relative;
}
.special-char-overlay .special-tab::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  font-size: 0.9em;
  color: var(--vscode-editorWhitespace-foreground, var(--vscode-descriptionForeground));
  user-select: none;
  pointer-events: none;
}

/* Newline: marker at end of line (empty span, no flow impact) */
.special-char-overlay .special-newline {
  position: relative;
}
.special-char-overlay .special-newline::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  font-size: 0.9em;
  color: var(--vscode-editorWhitespace-foreground, var(--vscode-descriptionForeground));
  user-select: none;
  pointer-events: none;
}

/* Carriage return: marker (empty span, no flow impact) */
.special-char-overlay .special-carriage-return {
  position: relative;
}
.special-char-overlay .special-carriage-return::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  font-size: 0.9em;
  color: var(--vscode-editorWhitespace-foreground, var(--vscode-descriptionForeground));
  user-select: none;
  pointer-events: none;
}

.special-char-textarea {
  color: transparent !important;
  caret-color: var(--vscode-foreground) !important;
  background-color: transparent !important;
  position: relative;
  z-index: 1;
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4,
.markdown-content h5,
.markdown-content h6 {
  padding: 0.25em 0 0.25em 0;
}

.markdown-content p {
  padding: 0.5em 0;
}

.markdown-content li > p {
    padding: 0;
    margin: 0;
}

.column-title-text p,
.column-title-text h1,
.column-title-text h2,
.column-title-text h3,
.column-title-text h4,
.column-title-text h5,
.column-title-text h6 {
  padding: 0;
  margin: 0;
}

.markdown-content ul,
.markdown-content ol {
  margin: 0.125em 0;
  padding-left: 1.5em;
}

.markdown-content code {
  padding: 0.1em 0.3em;
  border-radius: 3px;
  font-size: 0.9em;
}

.markdown-content pre {
  padding: 0.5em;
  border-radius: 3px;
  overflow-x: auto;
  margin: 0.25em 0;
}

.markdown-content a {
  color: var(--vscode-textLink-foreground);
  text-decoration: none;
  word-break: break-all;
}

.markdown-content a:hover {
  text-decoration: underline;
}

.card-title-container .markdown-content h1,
.card-title-container .markdown-content h2,
.card-title-container .markdown-content h3,
.card-title-container .markdown-content h4,
.card-title-container .markdown-content h5,
.card-title-container .markdown-content h6 {
  margin: 0;
  line-height: inherit;
}

.card-title-container .markdown-content p {
  margin: 0;
  display: inline;
}

h1,
h2,
h3,
h4,
h5,
h6 {
	font-weight: 500;
	font-size: 1em;
}

blockquote {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
  margin-inline-start: 10px;
  margin-inline-end: 20px;
  padding-left: 10px;
  border-left: 2px solid #1371b8;
}

/* Images and files */
.markdown-content img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 4px 0;
  /* box-shadow: 0 2px 4px rgba(0,0,0,0.1); */
  /* border: 1px solid var(--vscode-panel-border); */
  /* background-color: white; */
  display: inline-block;
  vertical-align: middle;
}

.card-title-container .markdown-content img {
  max-width: 100%;
  max-height: 60px;
  margin: 2px 0;
  display: inline-block;
  vertical-align: middle;
}

.card-description-container .markdown-content img {
  max-width: 100%;
  max-height: 400px;
  width: auto;
  height: auto;
  margin: 0;
  display: block;
  object-fit: contain;
}

/* Image path conversion overlay */
.image-path-overlay-container {
  position: relative;
  display: inline-block;
  max-width: 100%;
  overflow-wrap: anywhere;
  word-wrap: normal;
  min-height: 28px;
}

/* Image menu button - styles inherited from unified overlay button styles at top of file */

/* Link path conversion overlay - for markdown file links [text](path) */
.link-path-overlay-container {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 2px;
}

.link-path-overlay-container .link-menu-btn {
  width: 16px;
  height: 16px;
  padding: 0;
  margin: 0;
  border: none;
  background: rgba(0, 0, 0, 0.3);
  color: white;
  border-radius: 2px;
  font-size: 10px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  flex-shrink: 0;
}

.link-path-overlay-container:hover .link-menu-btn {
  opacity: 1;
}

.link-path-overlay-container .link-menu-btn:hover {
  background: rgba(0, 0, 0, 0.7);
}

/* Link broken state - strikethrough (button styling in unified section at top) */
.link-path-overlay-container.link-broken .markdown-link {
  text-decoration: line-through;
}

/* ============================================================================
   WIKI LINK CONTAINER - Wiki link burger menus
   ============================================================================ */

.wiki-link-container {
  display: inline-flex;
  align-items: center;
  gap: 2px;
}

.wiki-link-container .wiki-menu-btn {
  width: 16px;
  height: 16px;
  padding: 0;
  margin: 0;
  border: none;
  background: rgba(0, 0, 0, 0.3);
  color: white;
  border-radius: 2px;
  font-size: 10px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  flex-shrink: 0;
}

.wiki-link-container:hover .wiki-menu-btn {
  opacity: 1;
}

.wiki-link-container .wiki-menu-btn:hover {
  background: rgba(0, 0, 0, 0.7);
}

/* Wiki link broken state */
.wiki-link-container.wiki-broken .wiki-link {
  text-decoration: line-through;
}

.wiki-link-container.wiki-broken .wiki-menu-btn {
  opacity: 1;
  background: rgba(255, 100, 100, 0.8);
}

/* ============================================================================
   DIAGRAM OVERLAY CONTAINER - Mermaid, PlantUML burger menus
   ============================================================================ */

.diagram-overlay-container {
  position: relative;
  display: block;
}

/* Note: Diagram menu button styles are now unified with other overlay menu buttons
   in the shared rule at the top of the file (.diagram-overlay-container .diagram-menu-btn) */

/* ============================================================================
   RESOURCE PATH MENUS - Consolidated styles for image/include path menus
   ============================================================================ */

/* Shared menu container styles */
.image-path-menu,
.include-path-menu {
  position: absolute;
  right: 0;
  background: var(--vscode-menu-background, #252526);
  border: 1px solid var(--vscode-menu-border, #454545);
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  min-width: 160px;
  display: none;
}

/* Menu-specific positioning */
.image-path-menu {
  top: 32px;
  right: 4px;
  max-width: 220px;
  width: max-content;
}

.include-path-menu {
  top: 100%;
  margin-top: 2px;
}

/* Visible state */
.image-path-menu.visible,
.include-path-menu.visible {
  display: block;
}

/* Shared menu item styles */
.image-path-menu-item,
.include-path-menu-item,
.video-path-menu-item {
  display: block;
  width: 100%;
  padding: 6px 12px;
  border: none;
  background: transparent;
  color: var(--vscode-menu-foreground, #cccccc);
  text-align: left;
  cursor: pointer;
  white-space: nowrap;
}

.image-path-menu-item,
.include-path-menu-item {
  font-size: 12px;
}

.video-path-menu-item {
  font-size: 13px;
}

/* Hover states */
.image-path-menu-item:hover:not(:disabled),
.include-path-menu-item:hover:not(:disabled),
.video-path-menu-item:hover:not(.disabled):not(:disabled) {
  background: var(--vscode-menu-selectionBackground, #094771);
  color: var(--vscode-menu-selectionForeground, #ffffff);
}

/* Disabled states */
.image-path-menu-item:disabled,
.image-path-menu-item.disabled,
.include-path-menu-item:disabled,
.include-path-menu-item.disabled {
  opacity: 0.4;
  cursor: not-allowed;
  color: var(--vscode-disabledForeground, #888888);
}

.video-path-menu-item.disabled,
.video-path-menu-item:disabled {
  color: var(--vscode-disabledForeground, #6e6e6e);
  cursor: not-allowed;
}

/* Dividers */
.image-path-menu-divider,
.include-path-menu-divider,
.video-path-menu-divider {
  height: 1px;
  background: var(--vscode-menu-separatorBackground, #454545);
  margin: 4px 0;
}

/* Include path conversion overlay */
.include-path-overlay-container {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  line-height: 1.2;
}

/* Include menu button - size overrides (base styles in unified overlay button section) */
.include-path-overlay-container .include-menu-btn {
  position: static;
  width: 16px;
  height: 16px;
  margin: 0;
  border-radius: 3px;
  font-size: 10px;
  line-height: 1;
  flex-shrink: 0;
}

/* COLUMN/TASK INCLUDES: Show menu button on hover for working includes
   Broken includes get opacity: 1 from the unified error styles at top of file */

/* Broken state styles are in the unified overlay button section at top of file */

.markdown-content a[href$=".pdf"],
.markdown-content a[href$=".doc"],
.markdown-content a[href$=".docx"],
.markdown-content a[href$=".txt"],
.markdown-content a[href$=".zip"],
.markdown-content a[href$=".rar"] {
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: var(--button-secondary-background);
  color: var(--button-secondary-foreground);
  border-radius: 4px;
  text-decoration: none;
  margin: 2px;
  font-size: 0.9em;
  transition: background-color 0.2s;
}

.markdown-content a[href$=".pdf"]:hover,
.markdown-content a[href$=".doc"]:hover,
.markdown-content a[href$=".docx"]:hover,
.markdown-content a[href$=".txt"]:hover,
.markdown-content a[href$=".zip"]:hover,
.markdown-content a[href$=".rar"]:hover {
  background-color: var(--button-secondary-background-hover);
}

.markdown-content a[href$=".pdf"]::before { content: " "; }
.markdown-content a[href$=".doc"]::before,
.markdown-content a[href$=".docx"]::before { content: " "; }
.markdown-content a[href$=".txt"]::before { content: " "; }
.markdown-content a[href$=".zip"]::before,
.markdown-content a[href$=".rar"]::before { content: " "; }
.markdown-content a[href$=".jpg"]::before,
.markdown-content a[href$=".jpeg"]::before,
.markdown-content a[href$=".png"]::before,
.markdown-content a[href$=".gif"]::before,
.markdown-content a[href$=".svg"]::before { content: " "; }

/* Speaker Notes */
.speaker-note {
  color: var(--vscode-textCodeBlock-foreground, #888);
  background-color: var(--vscode-textCodeBlock-background, rgba(0, 0, 0, 0.05));
  padding: 8px 12px;
  margin: 4px 0;
  border-left: 3px solid var(--vscode-editorInfo-foreground, #4a9eff);
  border-radius: 3px;
  font-size: 0.9em;
  font-style: italic;
  opacity: 0.75;
  transition: opacity 0.2s ease;
}

.speaker-note:hover {
  opacity: 1;
}

/* HTML Comment Markers */
.html-comment-marker {
  /* color: var(--vscode-editor-foreground, #cccccc);
  background-color: var(--vscode-input-background, rgba(60, 120, 60, 0.25)); */
  color: var(--vscode-textPreformat-foreground, #666);
  background-color: var(--vscode-textPreformat-background, transparent);
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 0.85em;
  font-family: 'Courier New', monospace;
  font-style: normal;
  font-weight: 500;
  white-space: pre-wrap;
  word-break: break-all;
  user-select: none;
  border: 1px solid var(--vscode-editorInfo-foreground, #4a9eff);
  opacity: 0.9;
  transition: all 0.2s ease;
  display: inline;
  vertical-align: middle;
}

.html-comment-marker:hover {
  opacity: 1;
  /* background-color: var(--vscode-input-background, rgba(60, 120, 60, 0.4)); */
  border-color: var(--vscode-focusBorder, #007acc);
}

/* HTML Content rendered as text */
.html-content-text {
  color: var(--vscode-textPreformat-foreground);
  background-color: var(--vscode-textPreformat-background);
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 0.85em;
  font-family: 'Courier New', monospace;
  font-style: normal;
  font-weight: 500;
  white-space: pre-wrap;
  word-break: break-all;
  user-select: text;
  border: 1px dashed var(--vscode-editorWarning-foreground, #cc6600);
  opacity: 0.8;
  transition: all 0.2s ease;
  display: inline-block;
  vertical-align: middle;
}

.html-content-text:hover {
  opacity: 1;
  border-color: var(--vscode-focusBorder, #007acc);
  border-style: solid;
}

/* Tags */
.kanban-tag {
  color: var(--vscode-badge-foreground);
  background-color: var(--vscode-badge-background);
  padding: 0px 2px;
  border-radius: 4px;
  font-size: 0.85em;
  font-weight: 500;
  white-space: nowrap;
  user-select: none;
  border: 1px solid var(--vscode-badge-background);
  transition: all 0.2s ease;
}

.kanban-tag:hover {
  opacity: 0.8;
}

/* Highlight lines/paragraphs containing tags in description */
.card-description-display p:has(.kanban-tag),
.card-description-display li:has(.kanban-tag),
.card-description-display div:has(.kanban-tag):not(.include-container):not(.card-section):not(.include-content-area) {
  background-color: var(--vscode-list-hoverBackground);
  padding: 2px 4px;
  /* margin: 2px 0; */
  border-radius: 3px;
  border-left: 2px solid var(--vscode-badge-background);
}

/* Normalize spacing for paragraphs split from <br> lines for per-line tag styling.
   Without this, consecutive tagged lines (#++, #--) in the same paragraph would
   all inherit the last matching CSS :has() rule. The split creates separate <p>
   elements so each line gets independent tag styling. */
.card-description-display p.md-tag-line {
  margin: 0;
}

/* Special styling for span and row tags */
.kanban-tag[data-tag^="span"],
.kanban-tag[data-tag^="row"],
.kanban-tag[data-tag^="stack"] {
  color: #666;
  background-color: transparent;
  border: 1px dashed #999;
  opacity: 0.7;
}

.kanban-full-height-column[data-column-tag] {
  transition: padding 0.2s ease;
}

.card-item[data-task-tag] {
  transition: padding 0.2s ease;
}

.column-title-text .kanban-tag,
.card-title-display .kanban-tag {
  vertical-align: left;
  display: inline-table;
}

/* Ensure tags in task descriptions are strictly inline without any card-level styling */
/* Double class selector increases specificity to override [data-tag] rules without !important */
.card-description-display .kanban-tag.kanban-tag {
  vertical-align: middle;
  display: inline;
  position: static;
  /* Ensure inline-only styling - no headers/footers */
  border: 1px solid var(--vscode-badge-background);
  background-color: var(--vscode-badge-background);
  margin: 0;
  padding: 0px 2px;
  /* Reset any overrides from specialized tag rules */
  color: var(--vscode-badge-foreground);
  opacity: 1;
  box-shadow: none;
}

/* Explicitly prevent any pseudo-elements on description tags */
.card-description-display .kanban-tag.kanban-tag::before,
.card-description-display .kanban-tag.kanban-tag::after {
  display: none;
  content: none;
}

/* Corner badge containers - flexbox based positioning */
.corner-badges-container {
  position: absolute;
  display: flex;
  pointer-events: none;
  z-index: 10;
  gap: 16px;
  transform: translateZ(1px) translate(0px, -2px);
}

/* Positioning for each corner - horizontal by default */
.corner-badges-container.top-left {
  top: 0px;
  left: -7px;
  flex-direction: row;
}

.corner-badges-container.top-right {
  top: 0px;
  right: -7px;
  flex-direction: row;
}

.corner-badges-container.bottom-left {
  bottom: -8px;
  left: -7px;
  flex-direction: row;
}

.corner-badges-container.bottom-right {
  bottom: -8px;
  right: -7px;
  flex-direction: row;
}

/* Vertical layout for vertically folded columns */
.collapsed-vertical .corner-badges-container.top-left,
.collapsed-vertical .corner-badges-container.top-right {
  flex-direction: column;
}

.collapsed-vertical .corner-badges-container.bottom-left,
.collapsed-vertical .corner-badges-container.bottom-right {
  flex-direction: column;
}

/* Corner badges */
.corner-badge {
  position: relative; /* Changed from absolute since container handles positioning */
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 11px;
  z-index: 100; /* Increased from 50 to appear above borders */
  pointer-events: none;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  background: #666; /* Default background color as fallback */
  color: #fff; /* Default text color as fallback */
  padding: 4px;
}

/* Ensure corner badges for specific tags (like corner-badge-feature) appear above borders */
[class*="corner-badge-"] {
  z-index: 100 !important; /* Ensure all corner badges appear above borders */
  pointer-events: none;
}

/* Numeric corner badges - need explicit sizing and border-radius like numeric-badge */
.corner-badge[class*="corner-badge-numeric-"] {
  min-width: 24px;
  height: 24px;
  padding: 0 6px;
  border-radius: 4px;
  font-size: 12px;
  background-color: var(--vscode-badge-background, #4d4d4d) !important;
  color: var(--vscode-badge-foreground, #ffffff) !important;
}

/* Adjust corner badge container positioning to account for column padding */
.kanban-full-height-column .corner-badges-container {
  margin-top: calc(var(--whitespace) * -1);
}

.corner-badge[data-badge-index="1"] {
  z-index: 100;
}

.corner-badge[data-badge-index="2"] {
  z-index: 101;
}

.corner-badge[data-badge-index="3"] {
  z-index: 102;
}

/* REMOVED: CSS positioning creates initial wrong position, then JavaScript corrects it later causing delay
 * ONLY JavaScript dynamic positioning should be used (menuOperations.js)
 * NO CSS :has() rules for numeric badge positioning
 */

/* Temporal highlighting for columns and tasks */
/* Border style (default) - consolidated using :is() for week/day/weekday/time/hour */
.kanban-full-height-column:is(
  [data-current-week="true"],
  [data-current-day="true"],
  [data-current-weekday="true"],
  [data-current-time="true"],
  [data-current-hour="true"]
) :is(.column-header, .column-title, .column-content, .column-footer),
.card-item:is(
  [data-current-week="true"],
  [data-current-day="true"],
  [data-current-weekday="true"],
  [data-current-time="true"],
  [data-current-hour="true"]
) {
  border-right: var(--current-week-border-width) var(--current-week-border-style) var(--current-week-highlight-color) !important;
}

/* Direct selectors as fallback for temporal highlighting */
.card-item[data-current-time="true"],
.card-item[data-current-day="true"],
.card-item[data-current-week="true"],
.card-item[data-current-weekday="true"],
.card-item[data-current-hour="true"] {
  border-right: var(--current-week-border-width) var(--current-week-border-style) var(--current-week-highlight-color) !important;
}

/* Background style - add class 'week-highlight-background' to body to enable */
body.week-highlight-background .kanban-full-height-column[data-current-week="true"] .column-header,
body.week-highlight-background .kanban-full-height-column[data-current-week="true"] .column-title,
body.week-highlight-background .kanban-full-height-column[data-current-week="true"] .column-content,
body.week-highlight-background .kanban-full-height-column[data-current-week="true"] .column-footer {
  background-color: var(--current-week-highlight-color) !important;
  opacity: 0.2;
}

body.week-highlight-background .card-item[data-current-week="true"] {
  background-color: var(--current-week-highlight-color) !important;
  opacity: 0.9;
}

/* Glow style - add class 'week-highlight-glow' to body to enable */
body.week-highlight-glow .kanban-full-height-column[data-current-week="true"] .column-header,
body.week-highlight-glow .kanban-full-height-column[data-current-week="true"] .column-title,
body.week-highlight-glow .kanban-full-height-column[data-current-week="true"] .column-content,
body.week-highlight-glow .kanban-full-height-column[data-current-week="true"] .column-footer {
  box-shadow: var(--current-week-glow-size) var(--current-week-highlight-color) !important;
}

body.week-highlight-glow .card-item[data-current-week="true"] {
  box-shadow: var(--current-week-glow-size) var(--current-week-highlight-color) !important;
}

/* Line-level temporal highlighting for minute slots in task descriptions */
/* When a paragraph contains an active minute slot (!:15-:30), highlight the entire line */
.card-description-display p:has([data-temporal-line-active="true"]),
.card-description-display li:has([data-temporal-line-active="true"]) {
  border-right: var(--current-week-border-width) var(--current-week-border-style) var(--current-week-highlight-color) !important;
  padding-right: 8px;
  margin-right: -4px;
}

/* Highlight individual active temporal tags ONLY in task descriptions (not headers) */
.card-description-display .kanban-temporal-tag.temporal-active {
  border-right: var(--current-week-border-width) var(--current-week-border-style) var(--current-week-highlight-color) !important;
  padding-right: 4px;
  border-radius: 2px;
}

/* Header and footer bars */
.header-bar,
.footer-bar {
	position: relative;
  width: 100%;
  flex-shrink: 0;
  pointer-events: none;
  transition: all 0.2s ease;
}

/* Footer bars styling when in column-footer */
.column-footer > .footer-bars-container {
  position: relative;
  border-top: none;
}

.kanban-full-height-column:not(.collapsed-vertical):not(.collapsed-horizontal) .header-bar,
.kanban-full-height-column:not(.collapsed-vertical):not(.collapsed-horizontal) .footer-bar {
  position: relative;
}

.kanban-full-height-column::before,
.kanban-full-height-column::after,
.card-item::before,
.card-item::after {
  pointer-events: none;
}

[data-all-tags] {
  border-width: 0;
}

/* Collapsed-vertical column: rotate header/footer bar text to match vertical title orientation */
.kanban-full-height-column.collapsed-vertical .header-bar,
.kanban-full-height-column.collapsed-vertical .footer-bar {
  writing-mode: sideways-rl;
  transform: rotate(180deg);
  height: auto !important;
  width: 100%;
  padding: var(--whitespace) 0;
  white-space: nowrap;
}

.kanban-full-height-column.collapsed-vertical .header-bar-header[data-title-bar="true"]:not(:empty),
.kanban-full-height-column.collapsed-vertical .footer-bar-header[data-title-bar="true"]:not(:empty) {
  padding: var(--whitespace) 0;
}

/* .kanban-full-height-column.collapsed-vertical .header-bar:has() */

.kanban-full-height-column .corner-badge,
.kanban-full-height-column [class*="corner-badge-"] {
  z-index: 100 !important;
  pointer-events: none;
}

/* Custom (user-added) tags styling */
.donut-menu-tag-chip.custom-tag {
    font-style: italic;
    opacity: 0.9;
}

.donut-menu-tag-chip.custom-tag:not(.active) {
    border-style: dashed !important;
}

.donut-menu-tag-chip.custom-tag.active {
    font-style: normal;
}

/* Visual separator for custom tags section */
.donut-menu-item:has(.custom-tag)::before {
    content: '';
    position: absolute;
    top: 0;
    left: 12px;
    right: 12px;
    height: 1px;
    background: var(--vscode-panel-border);
}

.context-menu {
    position: fixed;
    background: var(--vscode-menu-background);
    border: 1px solid var(--vscode-menu-border);
    border-radius: 4px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    z-index: 2000;
    min-width: 150px;
    padding: 4px 0;
}

.context-menu-item {
    padding: 6px 12px;
    cursor: pointer;
    font-size: 13px;
    color: var(--vscode-menu-foreground);
}

.context-menu-item:hover {
    background: var(--vscode-menu-selectionBackground);
}

/* Fix collapsed add task button in dark mode */
/* light mode */
body.vscode-light .collapsed-add-task-btn,
body.vscode-high-contrast-light .collapsed-add-task-btn {
  background: #fff;
  color: #000;
  border: 1px solid #000;
}

body.vscode-light .collapsed-add-task-btn:hover,
body.vscode-high-contrast-light .collapsed-add-task-btn:hover {
  background: #fff;
  color: #000;
  border: 1px solid #000;
}

/* dark mode */
.vscode-dark .collapsed-add-task-btn,
.vscode-high-contrast .collapsed-add-task-btn {
    background: #000;
    color: var(--vscode-descriptionForeground);
    border: 1px solid var(--vscode-descriptionForeground);
}

.vscode-dark .collapsed-add-task-btn:hover,
.vscode-high-contrast .collapsed-add-task-btn:hover {
    /* background: #ffffff; */
    background: #1a1a1a;
    color: var(--vscode-descriptionForeground);
    border: 1px solid var(--vscode-descriptionForeground);
}

/* =============================================================================
   DATE AND PERSON TAGS - DEPRECATED
   NEW TAG SYSTEM:
   - # prefix: all tags INCLUDING people (kanban-person-tag is now obsolete)
   - @ prefix: all temporal (kanban-date-tag merged with kanban-temporal-tag)
   These styles are kept for backwards compatibility during transition.
   ============================================================================= */
.kanban-date-tag {
    color: var(--vscode-charts-blue);
    background-color: rgba(0, 122, 204, 0.1);
    padding: 0px 4px;
    display: inline;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: 500;
    white-space: nowrap;
    user-select: none;
    border: 1px solid var(--vscode-charts-blue);
    transition: all 0.2s ease;
    position: relative;
    padding-left: 16px;
}

.kanban-date-tag::before {
    content: '';
    position: absolute;
    left: 2px;
    font-size: 10px;
}

.kanban-person-tag {
    color: var(--vscode-charts-purple);
    background-color: rgba(138, 43, 226, 0.1);
    padding: 0px 4px;
    display: inline;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: 500;
    white-space: nowrap;
    user-select: none;
    border: 1px solid var(--vscode-charts-purple);
    transition: all 0.2s ease;
    position: relative;
    padding-left: 16px;
}

.kanban-person-tag::before {
    content: '';
    position: relative;
    left: 2px;
    /* top: -6px; */
    font-size: 10px;
}

kanban-full-height-column collapsed-vertical .kanban-person-tag::before {
    position: relative;
    left: -2px;
    top: -6px;
}

.kanban-date-tag:hover,
.kanban-person-tag:hover {
    opacity: 0.8;
}

/* Week tag styling (same as date tag but no icon) */
.kanban-week-tag {
    color: var(--vscode-charts-blue);
    background-color: rgba(0, 122, 204, 0.1);
    padding: 0px 4px;
    display: inline;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: 500;
    white-space: nowrap;
    user-select: none;
    border: 1px solid var(--vscode-charts-blue);
    transition: all 0.2s ease;
    position: relative;
}

.kanban-week-tag:hover {
    opacity: 0.8;
}

/* Ensure week tags stay inline in folded columns */
.collapsed .kanban-week-tag {
    display: inline !important;
}

/* =============================================================================
   TEMPORAL TAGS (.prefix) - Dates, Weeks, Weekdays, Times, Time Slots
   ============================================================================= */

/* Base styling for all temporal tags */
.kanban-temporal-tag {
    color: var(--vscode-charts-green, #4ec9b0);
    background-color: rgba(78, 201, 176, 0.1);
    padding: 0px 4px;
    display: inline;
    border-radius: 4px;
    font-size: 0.85em;
    font-weight: 500;
    white-space: nowrap;
    user-select: none;
    border: 1px solid var(--vscode-charts-green, #4ec9b0);
    transition: all 0.2s ease;
    position: relative;
}

/* Icon styling */
.kanban-temporal-tag .temporal-icon {
    font-size: 0.9em;
    margin-right: 2px;
    vertical-align: middle;
}

/* Hover effect */
.kanban-temporal-tag:hover {
    opacity: 0.8;
}

/* Active temporal tag - NO special highlight, task border is highlighted instead */

/* Type-specific color variations */
.kanban-temporal-date {
    color: var(--vscode-charts-blue, #007acc);
    background-color: rgba(0, 122, 204, 0.1);
    border-color: var(--vscode-charts-blue, #007acc);
}

.kanban-temporal-week {
    color: var(--vscode-charts-blue, #007acc);
    background-color: rgba(0, 122, 204, 0.1);
    border-color: var(--vscode-charts-blue, #007acc);
}

.kanban-temporal-weekday {
    color: var(--vscode-charts-purple, #8a2be2);
    background-color: rgba(138, 43, 226, 0.1);
    border-color: var(--vscode-charts-purple, #8a2be2);
}

.kanban-temporal-time {
    color: var(--vscode-charts-blue, #007acc);
    background-color: rgba(0, 122, 204, 0.1);
    border-color: var(--vscode-charts-blue, #007acc);
}

.kanban-temporal-timeSlot {
    color: var(--vscode-charts-blue, #007acc);
    background-color: rgba(0, 122, 204, 0.1);
    border-color: var(--vscode-charts-blue, #007acc);
}

/* Ensure temporal tags stay inline in collapsed columns */
.collapsed .kanban-temporal-tag {
    display: inline !important;
}

/* Sort button */
.sort-btn {
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
}

.sort-icon {
    font-size: 14px;
}

/* Focus highlight animation for undo/redo */
.focus-highlight {
    animation: focusHighlight 2s ease-out;
    position: relative;
}

@keyframes focusHighlight {
    0% {
        box-shadow: 0 0 0 4px var(--vscode-focusBorder);
        background-color: var(--vscode-list-activeSelectionBackground);
    }
    50% {
        box-shadow: 0 0 0 8px var(--vscode-focusBorder);
    }
    100% {
        box-shadow: 0 0 0 0 transparent;
        background-color: transparent;
    }
}

/* ============================================
   MARKDOWN ICON CSS - Compact Width Version
   ============================================ */

/* Auto-insert compact style indicators - only within .markdown-content */

/* Headings - Roman numeral style indicators (I, II, III, IV, V, VI) */
/* Uses mask-image for theme-adaptive colors */
.markdown-content h1::before,
.markdown-content h2::before,
.markdown-content h3::before,
.markdown-content h4::before,
.markdown-content h5::before,
.markdown-content h6::before {
  content: "";
  display: inline-block;
  width: 10px;
  height: 1cap;
  margin-right: 2px;
  vertical-align: middle;
  margin-block-start: calc(1ex - 1cap);
  background-color: var(--text-normal, currentColor);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-size: contain;
  mask-size: contain;
  opacity: 0.6;
}
/* H1 */
.markdown-content h1::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='8' y1='1' x2='8' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='8' y1='1' x2='8' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}
/* H2 */
.markdown-content h2::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='5.5' y1='1' x2='5.5' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='10.5' y1='1' x2='10.5' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='5.5' y1='1' x2='5.5' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='10.5' y1='1' x2='10.5' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}
/* H3 */
.markdown-content h3::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='3' y1='1' x2='3' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='8' y1='1' x2='8' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='13' y1='1' x2='13' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='3' y1='1' x2='3' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='8' y1='1' x2='8' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='13' y1='1' x2='13' y2='15' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='1' x2='15' y2='1' stroke='white' stroke-width='2'/%3E%3Cline x1='1' y1='15' x2='15' y2='15' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}
/* H4 */
.markdown-content h4::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='1' y1='0' x2='1' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='6' y1='0' x2='6' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='6' y1='16' x2='15' y2='0' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='1' y1='0' x2='1' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='6' y1='0' x2='6' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='6' y1='16' x2='15' y2='0' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}
/* H5 */
.markdown-content h5::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='3' y1='0' x2='8' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='13' y1='0' x2='8' y2='16' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='3' y1='0' x2='8' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='13' y1='0' x2='8' y2='16' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}
/* H6 */
.markdown-content h6::before {
  -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='1' y1='0' x2='10' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='10' y1='0' x2='10' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='15' y1='0' x2='15' y2='16' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
  mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cline x1='1' y1='0' x2='10' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='10' y1='0' x2='10' y2='16' stroke='white' stroke-width='2'/%3E%3Cline x1='15' y1='0' x2='15' y2='16' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
}

/* Bold - before and after */
.markdown-content strong::before, .markdown-content strong::after,
.markdown-content b::before, .markdown-content b::after {
  content: "**"; display: inline-block;
  /* width: 12px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 9px !important; font-weight: bold;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content strong::before, .markdown-content b::before { margin-right: 2px; }
.markdown-content strong::after, .markdown-content b::after { margin-left: 2px; }

/* Italic - before and after */
.markdown-content em::before, .markdown-content em::after,
.markdown-content i::before, .markdown-content i::after {
  content: "*"; display: inline-block;
  /* width: 12px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 9px !important; font-style: normal;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content em::before, .markdown-content i::before { margin-right: 2px; }
.markdown-content em::after, .markdown-content i::after { margin-left: 2px; }

/* Strikethrough - before and after */
.markdown-content del::before, .markdown-content del::after,
.markdown-content s::before, .markdown-content s::after,
.markdown-content strike::before, .markdown-content strike::after {
  content: "~"; display: inline-block;
  /* width: 12px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 9px !important;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; text-decoration: none; opacity: 0.6;
}
.markdown-content del::before, .markdown-content s::before, .markdown-content strike::before { margin-right: 2px; }
.markdown-content del::after, .markdown-content s::after, .markdown-content strike::after { margin-left: 2px; }

/* Inline code - before and after */
.markdown-content code::before, .markdown-content code::after {
  content: "```"; display: inline-block;
  /* width: 12px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 10px !important; font-weight: bold;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content code::before { margin-right: 2px; }
.markdown-content code::after { margin-left: 2px; }
.markdown-content pre code::before, .markdown-content pre code::after { display: none; }

/* Preformatted text / Code block - only before */
/* .markdown-content pre::before {
  content: "{}"; display: inline-block; float: left;
  width: 20px; 
  height: 16px; margin-right: 6px; margin-top: 2px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 9px !important; font-weight: bold;
  background: rgba(45, 45, 45, 0.6); color: rgba(255, 255, 255, 0.8);
  text-align: center; line-height: 16px !important;
  vertical-align: top; opacity: 0.7;
} */

/* Underline - before and after */
.markdown-content u::before, .markdown-content u::after {
  content: "u"; display: inline-block;
  /* width: 12px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 8px !important; font-weight: bold;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; text-decoration: none;
  text-transform: lowercase; opacity: 0.6;
}
.markdown-content u::before { margin-right: 2px; }
.markdown-content u::after { margin-left: 2px; }

/* Mark/Highlight - before and after */
.markdown-content mark::before, .markdown-content mark::after {
  content: "=="; display: inline-block;
  /* width: 14px;  */
  height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 9px !important; font-weight: bold;
  background: rgba(255, 235, 59, 0.4); color: rgba(51, 51, 51, 0.7);
  vertical-align: text-top;
  line-height: 14px !important;
  opacity: 0.6;
}
.markdown-content mark::before { margin-right: 2px; }
.markdown-content mark::after { margin-left: 2px; }

/* Links - before and after with brackets */
.markdown-content a::before, .markdown-content a::after {
  display: inline; 
  /* width: 10px;  */
  height: 14px;
  border: 1px solid rgba(74, 144, 226, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 10px !important; font-weight: bold;
  background: rgba(227, 242, 253, 0.6); color: rgba(25, 118, 210, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content a::before { content: "["; margin-right: 2px; }
.markdown-content a::after { content: "]"; margin-left: 2px; }

/* Superscript/Subscript - before and after */
.markdown-content sup::before, .markdown-content sup::after,
.markdown-content sub::before, .markdown-content sub::after {
  display: inline-block; 
  /* width: 10px;  */
  height: 12px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 8px !important; font-weight: bold;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 12px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content sup::before, .markdown-content sup::after { content: "^"; }
.markdown-content sub::before, .markdown-content sub::after { content: ""; }
.markdown-content sup::before, .markdown-content sub::before { margin-right: 1px; }
.markdown-content sup::after, .markdown-content sub::after { margin-left: 1px; }

/* Keyboard input - before and after */
.markdown-content kbd::before, .markdown-content kbd::after {
  content: ""; display: inline-block;
  width: 10px; height: 14px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 8px !important;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 14px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content kbd::before { margin-right: 2px; }
.markdown-content kbd::after { margin-left: 2px; }

/* Abbreviation - before and after */
.markdown-content abbr::before, .markdown-content abbr::after {
  content: "?"; display: inline-block;
  width: 10px; height: 12px;
  border: 1px solid rgba(102, 102, 102, 0.5); border-radius: 2px;
  font-family: monospace; font-size: 8px !important; font-weight: bold;
  background: rgba(240, 240, 240, 0.6); color: rgba(51, 51, 51, 0.7);
  text-align: center; line-height: 12px !important;
  vertical-align: middle; opacity: 0.6;
}
.markdown-content abbr::before { margin-right: 1px; }
.markdown-content abbr::after { margin-left: 1px; }

/* Collapsed state adjustments */

/* Column width is now handled via --column-width CSS variable set from baseOptions */
/* This allows all width values (px and vw) to be defined in one place: baseOptions.columnWidth */

/* Column Span Classes - for columns that span multiple widths */
.kanban-full-height-column.column-span-2 {
  width: calc(var(--column-width) * 2 + var(--whitespace)) !important; /* 2x width plus 1 gap */
  flex-shrink: 0;
}

.kanban-full-height-column.column-span-3 {
  width: calc(var(--column-width) * 3 + var(--whitespace) * 2) !important; /* 3x width plus 2 gaps */
  flex-shrink: 0;
}

.kanban-full-height-column.column-span-4 {
  width: calc(var(--column-width) * 4 + var(--whitespace) * 3) !important; /* 4x width plus 3 gaps */
  flex-shrink: 0;
}

/* Collapsed span columns should use normal collapsed width */
.kanban-full-height-column.collapsed-vertical.column-span-2,
.kanban-full-height-column.collapsed-horizontal.column-span-2,
.kanban-full-height-column.collapsed-vertical.column-span-3,
.kanban-full-height-column.collapsed-horizontal.column-span-3,
.kanban-full-height-column.collapsed-vertical.column-span-4,
.kanban-full-height-column.collapsed-horizontal.column-span-4 {
  width: var(--collapsed-column-width) !important;
  min-width: var(--collapsed-column-width) !important;
  max-width: var(--collapsed-column-width) !important;
}

/* Font size classes are now generated dynamically by JavaScript */

/* Note: Sticky header disabling for large fonts removed - now controlled manually via burger menu */

/* Disable sticky header for tall task minimum heights */
body.tall-task-height .column-title {
  position: relative !important;
  top: auto !important;
}

/* Local font definitions */
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/roboto-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/roboto-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/open-sans-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/open-sans-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Lato';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/lato-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Lato';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/lato-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Plus Jakarta Sans';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url('fonts/plus-jakarta-sans-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Plus Jakarta Sans';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url('fonts/plus-jakarta-sans-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Poppins';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/poppins-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Poppins';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/poppins-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/inter-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/inter-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Fira Code';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/fira-code-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Fira Code';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/fira-code-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/jetbrains-mono-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/jetbrains-mono-latin-700-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Source Code Pro';
  font-style: normal;
  font-weight: 400;
  src: url('fonts/source-code-pro-latin-400-normal.woff2') format('woff2');
}
@font-face {
  font-family: 'Source Code Pro';
  font-style: normal;
  font-weight: 700;
  src: url('fonts/source-code-pro-latin-700-normal.woff2') format('woff2');
}

/* Font family styles */
body.font-family-system {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-roboto {
  font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-opensans {
  font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-lato {
  font-family: 'Lato', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-plusjakarta {
  font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-inter {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-poppins {
  font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

body.font-family-helvetica {
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

body.font-family-arial {
  font-family: Arial, sans-serif;
}

body.font-family-georgia {
  font-family: Georgia, 'Times New Roman', serif;
}

body.font-family-times {
  font-family: 'Times New Roman', Times, serif;
}

body.font-family-firacode {
  font-family: 'Fira Code', 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
}

body.font-family-jetbrains {
  font-family: 'JetBrains Mono', 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
}

body.font-family-sourcecodepro {
  font-family: 'Source Code Pro', 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
}

body.font-family-consolas {
  font-family: Consolas, 'Courier New', monospace;
}

/* Card focus styles for keyboard navigation */
.card-item.card-focused {
    outline: 3px solid var(--task-focus-color);
    outline-offset: -3px;
    position: relative;
    z-index: 1;
}

/* Multi-column layout styles */
.multicolumn {
    display: flex !important;
    flex-direction: row !important;
    align-items: flex-start !important;
    gap: 10px;
    margin: 10px 0;
}

.multicolumn-column {
    flex-basis: 0 !important;
    /* padding: 10px; */
    min-width: 0; /* Allow columns to shrink */
}

/* Mark/highlight styling */
mark {
    background-color: #fdfd49;
    color: var(--vscode-editor-foreground);
    /* padding: 1px 2px; */
    border-radius: 2px;
    display: inline-block;
    word-break: break-word;
}

body.vscode-dark mark,
body.vscode-high-contrast mark {
    background-color: rgba(253, 253, 73, 0.25);
    color: var(--vscode-editor-foreground);
}

/* Additional markdown-it plugin styles */
sub, sup {
    font-size: 0.75em;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sub {
    bottom: -0.25em;
}

sup {
    top: -0.5em;
}

ins {
    text-decoration: underline;
    background-color: var(--vscode-editor-insertedTextBackground, rgba(0, 255, 0, 0.2));
    color: var(--vscode-editor-foreground);
}

u {
    text-decoration: underline;
}

s {
    text-decoration: line-through;
}

/* Container styles */
.note, .comment, .highlight {
    margin: 10px 0;
    padding: 10px;
    border-radius: 4px;
    border-left: 4px solid;
}

.note {
    background-color: var(--vscode-textBlockQuote-background, rgba(0, 122, 204, 0.1));
    border-left-color: var(--vscode-textBlockQuote-border, #007acc);
}

.comment {
    background-color: var(--vscode-editor-inactiveSelectionBackground, rgba(128, 128, 128, 0.1));
    border-left-color: var(--vscode-descriptionForeground, #888);
}

.highlight {
    background-color: var(--vscode-editor-findMatchHighlightBackground, rgba(255, 235, 59, 0.3));
    border-left-color: var(--vscode-editor-findMatchBorder, #ffeb3b);
}

.mark-red { background-color: rgba(255, 0, 0, 0.1); border-left-color: #ff0000; }
.mark-green { background-color: rgba(0, 255, 0, 0.1); border-left-color: #00ff00; }
.mark-blue { background-color: rgba(0, 0, 255, 0.1); border-left-color: #0000ff; }
.mark-cyan { background-color: rgba(0, 255, 255, 0.1); border-left-color: #00ffff; }
.mark-magenta { background-color: rgba(255, 0, 255, 0.1); border-left-color: #ff00ff; }
.mark-yellow { background-color: rgba(255, 255, 0, 0.1); border-left-color: #ffff00; }

body.vscode-dark .mark-red,
body.vscode-high-contrast .mark-red { background-color: rgba(255, 80, 80, 0.2); border-left-color: #ff6666; }
body.vscode-dark .mark-green,
body.vscode-high-contrast .mark-green { background-color: rgba(80, 255, 80, 0.2); border-left-color: #66ff66; }
body.vscode-dark .mark-blue,
body.vscode-high-contrast .mark-blue { background-color: rgba(80, 80, 255, 0.2); border-left-color: #6666ff; }
body.vscode-dark .mark-cyan,
body.vscode-high-contrast .mark-cyan { background-color: rgba(80, 255, 255, 0.2); border-left-color: #66ffff; }
body.vscode-dark .mark-magenta,
body.vscode-high-contrast .mark-magenta { background-color: rgba(255, 80, 255, 0.2); border-left-color: #ff66ff; }
body.vscode-dark .mark-yellow,
body.vscode-high-contrast .mark-yellow { background-color: rgba(255, 255, 80, 0.2); border-left-color: #ffff66; }

.center { text-align: center; }
.center100 { text-align: center; width: 100%; }
.right { text-align: right; }
.caption {
    font-style: italic;
    text-align: center;
    color: var(--vscode-descriptionForeground, #888);
    font-size: 0.9em;
}

/* Include file processing styles */
.columninclude-link,
.include-filename-link,
.include-placeholder,
.include-placeholder-block,
.broken-include-placeholder {
    font-size: 0.9em;
    font-family: var(--vscode-font-family);
}

.include-placeholder {
    display: inline-block;
    padding: 2px 6px;
    background-color: var(--vscode-badge-background, rgba(0, 122, 204, 0.2));
    color: var(--vscode-badge-foreground, var(--vscode-foreground));
    border-radius: 3px;
    border: 1px solid var(--vscode-panel-border, rgba(255, 255, 255, 0.1));
    animation: pulse 2s infinite;
}

.include-error .column-title {
    /* display: inline-block;
    padding: 2px 6px; */
    /* border-radius: 3px;
    font-size: 0.85em;
    font-family: var(--vscode-font-family); */
    /* background-color: var(--vscode-errorBackground, rgba(255, 0, 0, 0.1)) !important;
    color: var(--vscode-errorForeground, #ff6b6b) !important;
    border: 1px solid var(--vscode-errorBorder, rgba(255, 0, 0, 0.3)); */
}

/* Include container error state - red border and background */
.include-container.include-error {
    position: relative;
    border-color: var(--vscode-inputValidation-errorBorder, rgba(255, 0, 0, 0.4));
    background-color: var(--vscode-inputValidation-errorBackground, rgba(255, 0, 0, 0.1));
}

.include-container.include-error .include-title-bar {
    border-bottom-color: var(--vscode-inputValidation-errorBorder, rgba(255, 0, 0, 0.4));
    padding-right: 32px; /* Space for burger menu (positioned in unified error section at top) */
}

.included-content-inline {
    /* Inline included content should blend seamlessly */
    display: block;
    border-top: 1px dashed gray;
    border-bottom: 1px dashed gray;
    position: relative;
    padding-right: 25px; /* Make room for the icon in top-right */
    padding-top: 5px;
    padding-bottom: 5px;
    padding-left: 5px;
    min-height: 20px; /* Ensure minimum height for icon placement */
}

/* Add icon in top right corner of included content */
.included-content-inline::before {
    content: "";
    position: absolute;
    top: 2px;
    right: 2px;
    cursor: pointer;
    padding: 1px 3px;
    border-radius: 2px;
    font-size: 14px;
    opacity: 0.7;
    transition: all 0.2s ease;
    height: 14px;
    width: 14px;
    line-height: 14px;
    text-align: center;
    z-index: 1;
    background-color: var(--vscode-editor-background);
}

.included-content-inline:hover::before {
    opacity: 1;
    background-color: var(--button-background-hover);
    transform: scale(1.1);
}

.included-content-block {
    /* Block included content with visual indication */
    display: block;
		border: 0.5px dashed gray;
    /* border-top: 1px  gray;
    border-bottom: 1px solid gray;
    border-left: 2px solid var(--vscode-panel-border, rgba(255, 255, 255, 0.1)); */
    position: relative;
    padding-right: 25px; /* Make room for the icon in top-right */
    padding-top: 5px;
    padding-bottom: 5px;
    padding-left: 8px;
    margin: 4px 0;
    min-height: 20px; /* Ensure minimum height for icon placement */
}

/* Add icon in top right corner of block included content */
.included-content-block::before {
    content: "";
    position: absolute;
    top: 2px;
    right: 2px;
    cursor: pointer;
    padding: 1px 3px;
    border-radius: 2px;
    font-size: 14px;
    opacity: 0.7;
    transition: all 0.2s ease;
    height: 14px;
    width: 14px;
    line-height: 14px;
    text-align: center;
    z-index: 1;
    background-color: var(--vscode-editor-background);
}

.included-content-block:hover::before {
    opacity: 1;
    background-color: var(--button-background-hover);
    transform: scale(1.1);
}

/* Regular include bordered container with title bar */
.include-container {
    display: block;
    border: 1px solid var(--vscode-panel-border, rgba(255, 255, 255, 0.2));
    border-radius: 4px;
    margin: 0.5em 0;
    overflow: hidden;
}

.include-title-bar {
    display: flex;
    align-items: center;
    padding: 4px 8px;
    /* background-color: var(--vscode-sideBar-background, rgba(255, 255, 255, 0.05)); */
    border-bottom: 1px solid var(--vscode-panel-border, rgba(255, 255, 255, 0.1));
    font-size: 0.9em;
    font-family: var(--vscode-font-family);
    position: relative;
    overflow: visible;
}

/* Allow menu to escape include-container when visible */
.include-container:has(.include-path-menu.visible) {
    overflow: visible;
}

.include-content-area {
    padding: 8px 12px;
    /* background-color: var(--vscode-editor-background); */
}

/* A4 Scrollable Include View */
/* Toggle via body.include-a4-mode class */
body.include-a4-mode .include-content-area {
    /* A4 aspect ratio: 210mm x 297mm = 1:1.414 */
    aspect-ratio: 1 / 1.414;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 200px;
    max-height: 80vh;
    padding: 16px 20px;
    background: var(--vscode-editor-background);
    box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
}

/* Scrollbar styling for A4 view */
body.include-a4-mode .include-content-area::-webkit-scrollbar {
    width: 8px;
}

body.include-a4-mode .include-content-area::-webkit-scrollbar-thumb {
    background: var(--vscode-scrollbarSlider-background);
    border-radius: 4px;
}

@keyframes highlightFlash {
    0% {
        background-color: transparent;
        box-shadow: none;
        outline: 3px solid transparent;
        outline-offset: -3px;
    }
    50% {
        background-color: var(--vscode-editor-findMatchHighlightBackground, rgba(255, 235, 59, 0.4));
        box-shadow: 0 0 8px var(--vscode-editor-findMatchHighlightBackground, rgba(255, 235, 59, 0.6));
        outline: 3px solid var(--vscode-focusBorder, #007ACC);
        outline-offset: -3px;
    }
    100% {
        background-color: transparent;
        box-shadow: none;
        outline: 3px solid transparent;
        outline-offset: -3px;
    }
}

/* Tag Visibility Controls */
/* Standard Tags: Hide #span, #row, and #stack tags only */
.tag-visibility-allexcludinglayout .kanban-tag[data-tag^="span"],
.tag-visibility-allexcludinglayout .kanban-tag[data-tag^="row"],
.tag-visibility-allexcludinglayout .kanban-tag[data-tag^="stack"] {
    display: none !important;
}

/* Custom Tags Only: Hide #span, #row, #stack, and all configured tags (but show @ tags) */
.tag-visibility-customonly .kanban-tag[data-tag^="span"],
.tag-visibility-customonly .kanban-tag[data-tag^="row"],
.tag-visibility-customonly .kanban-tag[data-tag^="stack"],
.tag-visibility-customonly .kanban-tag:not([data-tag^="@"]):not(.custom-tag) {
    display: none !important;
}

/* @ Tags Only: Hide all tags except @ tags */
.tag-visibility-mentionsonly .kanban-tag:not([data-tag^="@"]) {
    display: none !important;
}

/* No Tags: Hide all tags */
.tag-visibility-none .kanban-tag {
    display: none !important;
}

/* Image figures with captions */
figure {
  margin: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  flex: 1;
  min-height: 0;
  /* max-height: inherit;
  max-width: inherit; */
}

figcaption {
  font-size: 0.85em;
  max-width: 100%; 
  overflow-wrap: break-word;
  color: var(--vscode-descriptionForeground);
  margin-top: 4px;
  text-align: center;
  font-style: italic;
}

/* =================== LOADING INDICATORS =================== */

.loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--vscode-editor-background);
    opacity: 0.9;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 100;
    gap: 12px;
}

.loading-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--vscode-editor-foreground);
    border-top-color: transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    opacity: 0.6;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loading-text {
    color: var(--vscode-editor-foreground);
    font-size: 13px;
    opacity: 0.8;
}

/* ============================================================================
   Activity Indicators - Progress notifications for long-running operations
   ============================================================================ */

#activity-indicators {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 8px;
  pointer-events: none;
  max-width: 280px;
}

.activity-indicator {
  background: var(--vscode-notifications-background);
  border: 1px solid var(--vscode-notifications-border);
  border-radius: 6px;
  padding: 12px 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  color: var(--vscode-notifications-foreground);
  font-size: calc(var(--vscode-font-size, 13px) - 1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  pointer-events: auto;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.3s ease;
  border-left: 3px solid var(--vscode-progressBar-foreground);
}

.activity-indicator.visible {
  opacity: 1;
  transform: translateX(0);
}

.activity-indicator .activity-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.activity-indicator .activity-spinner {
  width: 14px;
  height: 14px;
  border: 2px solid var(--vscode-progressBar-background);
  border-top: 2px solid var(--vscode-progressBar-foreground);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  flex-shrink: 0;
}

.activity-indicator .activity-text {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-weight: 500;
}

.activity-indicator .progress-container {
  height: 4px;
  background: var(--vscode-progressBar-background);
  border-radius: 2px;
  overflow: hidden;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.activity-indicator .progress-container.visible {
  opacity: 1;
}

.activity-indicator .progress-bar {
  height: 100%;
  background: var(--vscode-progressBar-foreground);
  border-radius: 2px;
  width: 0%;
  transition: width 0.3s ease;
}

/* ============================================================================
   Custom Modal Dialogs - Used by modalUtils.js
   ============================================================================ */

.modal.custom-modal,
.modal.loading-modal {
  display: flex;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.file-context-overlay {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.45);
  z-index: calc(var(--z-modal-overlay) + 2);
}

.file-context-overlay.visible {
  display: flex;
}

.file-context-dialog {
  background: var(--vscode-editor-background);
  color: var(--vscode-editor-foreground);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 10px;
  padding: 20px 22px;
  max-width: 520px;
  width: 90%;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.file-context-title {
  margin: 0;
  font-size: 1.05em;
}

.file-context-message,
.file-context-path {
  margin: 0;
  font-size: 0.95em;
}

.file-context-path {
  opacity: 0.85;
  word-break: break-all;
}

.file-context-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

/* Unified button style matching file-search-btn */
.file-context-btn {
  padding: 8px 16px;
  font-size: 13px;
  font-family: var(--vscode-font-family);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s;
  background: var(--vscode-button-secondaryBackground, #3c3c3c);
  color: var(--vscode-button-secondaryForeground, #cccccc);
}

.file-context-btn:hover {
  background: var(--vscode-button-secondaryHoverBackground, #4c4c4c);
}

.file-context-btn.primary {
  background: var(--vscode-button-background, #007acc);
  color: var(--vscode-button-foreground, #ffffff);
}

.file-context-btn.primary:hover {
  background: var(--vscode-button-hoverBackground, #0062a3);
}

/* Task overlay editor (structure-only styles) */
.task-overlay-editor {
  position: fixed;
  inset: 0;
  display: none;
  z-index: var(--z-modal-overlay);
  --task-overlay-font-scale: 1.2;
}

.task-overlay-editor.visible {
  display: block;
}

.task-overlay-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
}

.task-overlay-panel {
  position: absolute;
  inset: 10vh 10vw;
  max-width: 80vw;
  max-height: 80vh;
  background: var(--vscode-editor-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  font-family: var(--vscode-editor-font-family);
  box-sizing: border-box;
}

.task-overlay-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid var(--vscode-panel-border);
}

.task-overlay-header-left,
.task-overlay-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.task-overlay-header-left {
  flex: 1;
}

.task-overlay-title-input {
  min-width: 160px;
  width: 50%;
  max-width: none;
  flex: 0 0 50%;
  padding: 4px 8px;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  background: var(--vscode-editor-background);
  color: var(--vscode-editor-foreground);
  font-family: inherit;
  font-size: 0.95em;
  line-height: 1.4;
}

.task-overlay-title-input:focus {
  outline: 1px solid var(--vscode-focusBorder);
  outline-offset: 0;
}

.task-overlay-mode-toggle {
  display: flex;
  align-items: center;
  gap: 6px;
}

.task-overlay-settings {
  position: relative;
}

.task-overlay-settings-menu {
  position: absolute;
  top: calc(100% + 6px);
  right: 0;
  display: none;
  gap: 6px;
  padding: 6px;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  z-index: 1;
}

.task-overlay-settings.open .task-overlay-settings-menu {
  display: flex;
}

.task-overlay-tools {
  display: none;
  padding: 8px 12px;
  border-bottom: 1px solid var(--vscode-panel-border);
  flex-wrap: wrap;
  gap: 10px;
  width: 100%;
  box-sizing: border-box;
}

.task-overlay-editor[data-mode="wysiwyg"] .task-overlay-tools {
  display: flex;
}

.task-overlay-tool-group {
  display: flex;
  align-items: center;
  gap: 6px;
}

.task-overlay-tool {
  border: 1px solid var(--vscode-panel-border);
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
}

.task-overlay-tool:hover {
  background: var(--vscode-button-secondaryHoverBackground);
}

.task-overlay-tool.active {
  background: var(--button-background-active);
  color: var(--button-foreground-active);
  border: var(--button-border-active);
}

.task-overlay-btn.active {
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border-color: var(--vscode-button-background);
}

.task-overlay-tool-select {
  background: var(--vscode-dropdown-background);
  color: var(--vscode-dropdown-foreground);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px;
}

.task-overlay-tool .tool-underline {
  text-decoration: underline;
}

.task-overlay-tool .tool-strike {
  text-decoration: line-through;
}

.task-overlay-body {
  display: flex;
  flex: 1;
  min-height: 0;
  gap: 10px;
}

.task-overlay-markdown,
.task-overlay-preview,
.card-overlay-wysiwyg {
  flex: 1;
  min-width: 0;
  display: none;
  box-sizing: border-box;
}

.task-overlay-editor[data-mode="markdown"] .task-overlay-markdown {
  display: block;
}

.task-overlay-editor[data-mode="dual"] .task-overlay-markdown,
.task-overlay-editor[data-mode="dual"] .task-overlay-preview {
  display: block;
}

.task-overlay-editor[data-mode="dual"] .task-overlay-markdown {
  border-right: 1px solid var(--vscode-panel-border);
}

.task-overlay-editor[data-mode="wysiwyg"] .card-overlay-wysiwyg {
  display: block;
}

.card-overlay-wysiwyg {
  overflow: auto;
}

.card-overlay-wysiwyg .ProseMirror {
  width: 100%;
  box-sizing: border-box;
}

.card-overlay-wysiwyg .wysiwyg-diagram-block {
  display: flex;
  flex-direction: column;
  gap: 6px;
  position: relative;
  border: 1px solid var(--vscode-panel-border);
  border-radius: 6px;
  padding: 8px;
}

.card-overlay-wysiwyg .wysiwyg-diagram-block:not(.is-editing) .wysiwyg-diagram {
  display: none;
}

.card-overlay-wysiwyg .wysiwyg-diagram-block .wysiwyg-edit-btn {
  display: none;
}

.card-overlay-wysiwyg img,
.card-overlay-wysiwyg video,
.card-overlay-wysiwyg iframe,
.card-overlay-wysiwyg canvas,
.card-overlay-wysiwyg svg {
  max-width: 100%;
  max-height: var(--card-overlay-wysiwyg-height, 100%);
  height: auto;
}

.card-overlay-wysiwyg .image-path-overlay-container,
.card-overlay-wysiwyg .video-path-overlay-container,
.card-overlay-wysiwyg .wysiwyg-media,
.card-overlay-wysiwyg .wysiwyg-media-block,
.card-overlay-wysiwyg .wysiwyg-diagram-preview {
  max-width: 100%;
  max-height: var(--card-overlay-wysiwyg-height, 100%);
  box-sizing: border-box;
}

.card-overlay-wysiwyg .wysiwyg-media-block {
  margin: 0 3px;
}

.task-overlay-textarea {
  width: 100%;
  height: 100%;
  border: none;
  padding: 12px;
  resize: none;
  background: transparent;
  color: var(--vscode-editor-foreground);
  font-family: var(--vscode-editor-font-family);
  font-size: calc(1em * var(--task-overlay-font-scale)); /* Requires: font scale control */
  outline: none;
  box-sizing: border-box;
}

.modal.loading-modal {
  background: rgba(0, 0, 0, 0.3);
}

.custom-modal .modal-dialog {
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 8px;
  padding: 20px;
  max-width: 400px;
  min-width: 280px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
}

.custom-modal .modal-dialog-title {
  margin: 0 0 15px 0;
  color: var(--vscode-foreground);
  font-size: 16px;
}

.custom-modal .modal-dialog-message {
  margin: 0 0 20px 0;
  color: var(--vscode-descriptionForeground);
  line-height: 1.4;
}

.custom-modal .modal-dialog-details {
  margin: -10px 0 16px 0;
  color: var(--vscode-descriptionForeground);
  font-size: 12px;
  line-height: 1.4;
  word-break: break-word;
}

.custom-modal .modal-dialog-checkbox {
  margin: 0 0 16px 0;
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--vscode-foreground);
  font-size: 12px;
}

.custom-modal .modal-dialog-checkbox input {
  margin: 0;
}

.custom-modal .modal-dialog-buttons {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

.custom-modal .modal-dialog-btn {
  padding: 8px 16px;
  border: 1px solid var(--vscode-button-border);
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
}

.custom-modal .modal-dialog-btn.primary {
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
}

.custom-modal .modal-dialog-btn.danger {
  background: var(--vscode-errorForeground);
  color: var(--vscode-button-foreground);
}

.custom-modal .modal-dialog-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
}

.loading-modal .loading-spinner {
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 8px;
  padding: 20px;
  display: flex;
  align-items: center;
  gap: 15px;
  color: var(--vscode-foreground);
}

.loading-modal .loading-spinner .spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--vscode-progressBar-background);
  border-top: 2px solid var(--vscode-progressBar-foreground);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.column-loading {
    position: relative;
}

.task-loading {
    position: relative;
}

.column-loading-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    min-height: 200px;
    height: 200px; /* Fixed height to ensure column takes space during loading */
    gap: 16px;
}

.column-loading-placeholder .loading-spinner {
    width: 32px;
    height: 32px;
    border-width: 3px;
}

.column-loading-placeholder .loading-text {
    font-size: 12px;
    opacity: 0.7;
    text-align: center;
}

/* Alternative title styling (shown when task is collapsed with no title) */
.task-alternative-title {
    font-style: italic;
    opacity: 0.7;
    color: var(--vscode-descriptionForeground);
    font-size: 0.95em;

    /* Single line with overflow hidden */
    display: block;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

#file-manager {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    font-family: var(--vscode-font-family);
    font-size: var(--vscode-font-size);
    pointer-events: none;
}

#file-manager-toggle-toast {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: var(--vscode-editorPane-background, rgba(60, 63, 65, 0.95));
    color: var(--vscode-editor-foreground, #fff);
    padding: 0.5rem 0.9rem;
    border-radius: 4px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    font-size: 0.85rem;
    opacity: 0;
    transform: translateY(-10px);
    transition: opacity 200ms ease, transform 200ms ease;
    z-index: 2500;
    pointer-events: none;
}

#file-manager-toggle-toast.visible {
    opacity: 1;
    transform: translateY(0);
}

/* External changes notification banner */
.external-changes-notification {
    position: fixed;
    top: 8px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3000;
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 14px;
    background: var(--vscode-editorWarning-foreground, #cca700);
    color: var(--vscode-editor-background);
    border-radius: 6px;
    font-size: 13px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    max-width: 90%;
}

.external-changes-notification strong {
    font-weight: 600;
}

.external-changes-review-btn {
    padding: 4px 12px;
    background: var(--vscode-editor-background);
    color: var(--vscode-editor-foreground);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
}

.external-changes-review-btn:hover {
    opacity: 0.9;
}

.external-changes-dismiss-btn {
    background: none;
    border: none;
    color: var(--vscode-editor-background);
    cursor: pointer;
    font-size: 14px;
    padding: 2px 4px;
    opacity: 0.8;
}

.external-changes-dismiss-btn:hover {
    opacity: 1;
}

.file-manager-panel {
    background: var(--vscode-editor-background);
    border: 1px solid var(--vscode-panel-border);
    border-radius: 4px;
    max-height: 85vh;
    max-width: 80vw;
    min-width: 40vw;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    pointer-events: auto;
}

.file-manager-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--whitespace-div4) var(--whitespace-div2);
    border-bottom: 1px solid var(--vscode-panel-border);
    background: var(--vscode-titleBar-activeBackground);
}

.file-manager-header h3 {
    margin: 0;
    color: var(--vscode-titleBar-activeForeground);
}

.file-manager-header-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-left: auto;
    margin-right: 8px;
}

.file-manager-controls {
    display: flex;
    gap: 4px;
    align-items: center;
}

.file-manager-btn, .file-manager-close {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    gap: 4px;
    margin: 0;
    background: var(--button-background);
    color: var(--button-foreground);
    border: var(--button-border);
    padding: 2px 6px;
    border-radius: 3px;
    cursor: pointer;
    height: 22px;
    min-height: 22px;
    min-width: 22px;
    font-size: 12px;
    line-height: 1;
}

.file-manager-btn:hover, .file-manager-close:hover {
    background: var(--button-secondary-background-hover);
}

.file-manager-btn-danger {
    background: var(--vscode-inputValidation-errorBackground, #5a1d1d);
    border-color: var(--vscode-inputValidation-errorBorder, #be1100);
}

.file-manager-btn-danger:hover {
    background: var(--vscode-inputValidation-errorBorder, #be1100);
}

.file-manager-close {
    font-weight: bold;
    width: 22px;
    min-width: 22px;
    padding: 2px;
}

.file-manager-content {
    padding: var(--vscode-whitespace);
    overflow-y: auto;
    flex: 1;
}

.file-manager-timestamp {
    color: var(--vscode-descriptionForeground);
    font-size: 10px;
    overflow-wrap: break-word;
    opacity: 0.8;
}

.file-manager-snapshot-status {
    font-size: 10px;
    border: 1px solid var(--vscode-panel-border);
    border-radius: 4px;
    padding: 1px 6px;
    overflow-wrap: break-word;
}

.file-manager-snapshot-status.snapshot-ready {
    color: var(--vscode-testing-iconPassed, #4caf50);
    border-color: color-mix(in srgb, var(--vscode-testing-iconPassed, #4caf50) 45%, var(--vscode-panel-border));
}

.file-manager-snapshot-status.snapshot-stale {
    color: var(--vscode-testing-iconQueued, #d29922);
    border-color: color-mix(in srgb, var(--vscode-testing-iconQueued, #d29922) 45%, var(--vscode-panel-border));
}

.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
}

.stat-label {
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
}

.stat-value {
    font-weight: bold;
    color: var(--vscode-foreground);
}

.file-manager-group {
    margin-bottom: 24px;
    border: 1px solid var(--vscode-panel-border);
    border-radius: 6px;
    overflow: hidden;
}

.file-manager-group h4 {
    margin: 0;
    padding: 12px 16px;
    background: var(--vscode-sideBar-background);
    color: var(--vscode-sideBar-foreground);
    font-size: 13px;
    font-weight: 600;
    border-bottom: 1px solid var(--vscode-panel-border);
}

.file-manager-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 16px;
    border-bottom: 1px solid var(--vscode-panel-border);
}

.file-manager-item:last-child {
    border-bottom: none;
}

.file-manager-label {
    font-weight: 500;
    color: var(--vscode-foreground);
}

.file-manager-value {
    font-family: var(--vscode-editor-font-family);
    font-size: 12px;
}

.status-good { color: var(--vscode-gitDecoration-addedResourceForeground); }
.status-warn { color: var(--vscode-gitDecoration-modifiedResourceForeground); }
.status-bad { color: var(--vscode-gitDecoration-deletedResourceForeground); }
.status-unknown { color: var(--vscode-descriptionForeground); }

/* File States Overview Styles */
.file-states-section {
    padding: var(--whitespace-div4) var(--whitespace-div2);
}

.file-states-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    margin-bottom: 10px;
    padding: 8px 4px;
}

.stat-group {
    display: flex;
    gap: 8px;
}

.file-states-actions {
    margin-left: auto;
}

.sync-summary-compact {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 10px;
    color: var(--vscode-descriptionForeground);
    white-space: nowrap;
}

.sync-summary-compact .sync-summary-label {
    font-weight: 600;
    color: var(--vscode-foreground);
}

.sync-summary-compact .sync-summary-item {
    display: inline-flex;
    align-items: center;
    gap: 3px;
}

.watcher-list, .include-list {
    padding: 8px;
}

.watcher-item, .include-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 8px;
    margin: 4px 0;
    background: var(--vscode-list-inactiveSelectionBackground);
    border-radius: 4px;
    font-size: 12px;
}

.include-item {
    flex-direction: column;
    align-items: stretch;
}

.include-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 4px;
}

.include-details {
    display: flex;
    gap: 12px;
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
}

.watcher-type, .include-type {
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
}

.watcher-type.main, .include-type.main {
    background: var(--vscode-gitDecoration-addedResourceForeground);
    color: white;
}
.watcher-type.include, .include-type.include {
    background: var(--vscode-gitDecoration-modifiedResourceForeground);
    color: white;
}
.watcher-type.dependency, .include-type.dependency {
    background: var(--vscode-gitDecoration-untrackedResourceForeground);
    color: white;
}

/* Specific include type styles */
.include-type-label.include-column, .include-type-label.column {
    background: #2196F3 !important;
    color: white !important;
}

.watcher-status.active { color: var(--vscode-gitDecoration-addedResourceForeground); }
.watcher-status.inactive { color: var(--vscode-gitDecoration-deletedResourceForeground); }

.detail-item.unsaved { color: var(--vscode-gitDecoration-modifiedResourceForeground); }
.detail-item.saved { color: var(--vscode-gitDecoration-addedResourceForeground); }

/* Table layout styles */
.files-table-container,
.unified-table-container {
    padding: var(--vscode-whitespace);
    background: var(--vscode-editor-background);
    border-radius: 4px;
    overflow-x: auto;
}

.files-table {
    width: 100%;
    border-collapse: separate;
    /* border-spacing: 4px; */
    font-size: 13px;
    margin-top: 8px;
    table-layout: fixed;
}

.files-table thead {
    border-bottom: 2px solid var(--vscode-panel-border);
}

.files-table th {
    padding: var(--vscode-whitespace);
    text-align: left;
    font-weight: 600;
    color: var(--vscode-foreground);
    background: var(--vscode-list-inactiveSelectionBackground);
    font-size: 12px;
    padding: 4px;
    white-space: nowrap;
}

th {
  text-align: left;
}

.files-table tbody tr.files-table-actions td {
    background: rgba(255, 255, 255, 0.03);
}

.files-table tbody tr {
    border-bottom: 1px solid var(--vscode-panel-border);
}

.files-table tbody tr:last-child {
    border-bottom: none;
}

.files-table tbody tr.main-file {
    background: rgba(135, 206, 235, 0.05);
}

.files-table tbody tr.missing-file {
    background-color: var(--vscode-inputValidation-warningBackground, rgba(255, 200, 0, 0.12));
}

.files-table td,
.files-table-actions td {
    vertical-align: middle;
}

.col-file {
    width: 24%;
    min-width: 160px;
    text-align: left;
}

.col-status {
    width: 14%;
    min-width: 80px;
    white-space: nowrap;
    text-align: left;
}

.col-frontend,
.col-saved {
    width: 6%;
    min-width: 45px;
    max-width: 60px;
    text-align: center;
}

.col-action {
    width: 22%;
    min-width: 180px;
    text-align: left;
}

.col-paths {
    width: 10%;
    min-width: 90px;
    text-align: center;
}

.col-image {
    width: 5%;
    min-width: 36px;
    max-width: 46px;
    text-align: center;
}

.dropdown-exec {
    display: flex;
    align-items: center;
    gap: 2px;
}

.dropdown-exec select {
    flex: 1;
    min-width: 0;
    padding: 2px 4px;
    font-size: 11px;
    background: var(--vscode-dropdown-background);
    color: var(--vscode-dropdown-foreground);
    border: 1px solid var(--vscode-dropdown-border);
    border-radius: 3px;
}

.dropdown-exec .exec-btn {
    flex-shrink: 0;
    padding: 2px 5px;
    font-size: 10px;
    line-height: 1;
}

.action-cell {
    padding-left: 2px;
    padding-right: 2px;
    text-align: center;
}

.sync-status-icon.sync-good {
    color: var(--vscode-gitDecoration-addedResourceForeground);
}

.sync-status-icon.sync-warn {
    color: var(--vscode-gitDecoration-modifiedResourceForeground);
}

.sync-status-icon.sync-unknown {
    color: var(--vscode-descriptionForeground);
    opacity: 0.5;
}

.file-path,
.file-directory-path {
    font-family: var(--vscode-editor-font-family);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
}

.file-path {
    font-size: 10px;
    color: var(--vscode-descriptionForeground);
    margin-bottom: 2px;
}

.file-directory-path {
    font-size: 9px;
    color: var(--vscode-descriptionForeground);
    margin-top: 6px;
    opacity: 0.8;
    font-style: italic;
    display: flex;
    align-items: center;
    gap: 6px;
}

.include-type-label {
    padding: 2px 4px !important;
    border-radius: 3px !important;
    font-size: 8px !important;
    font-weight: bold !important;
    text-transform: uppercase !important;
    flex-shrink: 0 !important;
    margin-left: 6px !important;
    display: inline-block !important;
    background: #666 !important;
    color: white !important;
    z-index: 2000 !important;
    vertical-align: middle !important;
}

.file-name-clickable {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-weight: 500;
    color: var(--vscode-textLink-foreground);
    cursor: pointer;
    text-decoration: underline;
    text-decoration-color: transparent;
    transition: text-decoration-color 0.2s ease;
    flex: 1;
    min-width: 0;
}

.file-name-clickable:hover {
    text-decoration-color: var(--vscode-textLink-foreground);
    color: var(--vscode-textLink-activeForeground);
}

.status-icon {
    font-size: 14px;
    cursor: help;
}

.status-icon.na {
    color: var(--vscode-descriptionForeground);
    opacity: 0.5;
}

.action-buttons {
    display: flex;
    gap: 6px;
    justify-content: left;
    align-items: center;
    flex-wrap: wrap;
}

.action-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    background: var(--button-background);
    border: var(--button-border);
    color: var(--button-foreground);
    padding: 2px 4px;
    margin: 0;
    border-radius: 3px;
    cursor: pointer;
    font-size: 12px;
    line-height: 1;
    white-space: nowrap;
    height: 22px;
    min-height: 22px;
    min-width: 22px;
    transition: opacity 0.15s ease;
}

/* .files-table .action-btn {
    width: 100%;
    gap: 6px;
} */

.action-btn:hover {
    opacity: 0.8;
}

.action-btn:disabled,
.dropdown-exec select:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.save-btn {
    background: var(--button-background);
    border: var(--button-border);
    color: var(--button-foreground);
}

.reload-btn {
    background: var(--button-background);
    border: var(--button-border);
    color: var(--button-foreground);
}

.reload-images-btn {
    background: var(--button-background);
    border: var(--button-border);
    color: var(--button-foreground);
}

/* Icon Legend styles */
.icon-legend {
    padding-top: 4px;
    border-top: 1px solid var(--vscode-panel-border);
    display: grid;
    grid-template-columns: repeat(2, 1fr);
}

.legend-title {
    font-size: 11px;
    font-weight: 600;
    color: var(--vscode-descriptionForeground);
    margin-bottom: 6px;
    text-transform: uppercase;
}

.legend-items {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 4px 12px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
}

.legend-icon {
    font-size: 12px;
}

.legend-section {
    margin-bottom: 8px;
}

.legend-section:last-child {
    margin-bottom: 0;
}

.legend-badge {
    min-width: 35px;
    padding: 1px 3px;
    font-size: 7px;
}

.file-states-list {
    max-height: 600px;
    overflow-y: auto;
    scrollbar-width: thin;
}

/* Force Write & Verification Styles */
.force-write-confirmation-overlay,
.verification-results-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
    z-index: 2001;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--vscode-font-family);
}

.confirmation-dialog,
.verification-dialog {
    background: var(--vscode-editor-background);
    border: 2px solid var(--vscode-panel-border);
    border-radius: 8px;
    max-width: 600px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

.confirmation-header,
.verification-header {
    padding: 16px;
    border-bottom: 1px solid var(--vscode-panel-border);
    background: var(--vscode-titleBar-activeBackground);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.confirmation-header h3,
.verification-header h3 {
    margin: 0;
    color: var(--vscode-titleBar-activeForeground);
}

.confirmation-content,
.verification-content {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
}

.confirmation-content p {
    margin: 8px 0;
}

.confirmation-content ul {
    margin: 8px 0;
    padding-left: 20px;
}

.affected-files {
    margin-top: 16px;
    padding: 12px;
    background: var(--vscode-textBlockQuote-background);
    border-radius: 4px;
    max-height: 200px;
    overflow-y: auto;
}

.affected-files ul {
    margin: 8px 0 0 0;
    padding-left: 20px;
}

.confirmation-actions,
.verification-actions {
    padding: 16px;
    border-top: 1px solid var(--vscode-panel-border);
    display: flex;
    gap: 12px;
    justify-content: flex-end;
}

.btn-cancel,
.btn-close {
    padding: 8px 16px;
    background: var(--button-secondary-background);
    color: var(--button-secondary-foreground);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
}

.btn-cancel:hover,
.btn-close:hover {
    background: var(--button-secondary-background-hover);
}

.btn-confirm,
.btn-force-write {
    padding: 8px 16px;
    background: var(--vscode-gitDecoration-modifiedResourceForeground);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
}

.btn-confirm:hover,
.btn-force-write:hover {
    opacity: 0.9;
}

/* Verification dialog close button - different style from modal .close-btn */
.verification-close-btn {
    background: transparent;
    border: none;
    color: var(--vscode-titleBar-activeForeground);
    font-size: 18px;
    cursor: pointer;
    padding: 4px 8px;
}

.verification-close-btn:hover {
    opacity: 0.7;
}

.verification-summary {
    display: flex;
    gap: 24px;
    margin-bottom: 20px;
    padding: 12px;
    background: var(--vscode-textBlockQuote-background);
    border-radius: 4px;
}

.summary-stat {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.summary-stat .stat-label {
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
}

.summary-stat .stat-value {
    font-size: 20px;
    font-weight: bold;
}

.verification-details {
    margin-top: 16px;
}

.file-results-list {
    margin-top: 12px;
    max-height: 300px;
    overflow-y: auto;
}

.file-result-item {
    padding: 8px;
    margin: 4px 0;
    border-radius: 4px;
    border: 1px solid var(--vscode-panel-border);
}

.file-result-item.match {
    background: rgba(0, 128, 0, 0.1);
}

.file-result-item.mismatch {
    background: rgba(255, 165, 0, 0.1);
}

.file-result-name {
    font-weight: 500;
    margin-bottom: 4px;
}

.file-result-status {
    font-size: 12px;
    margin-bottom: 2px;
}

.file-result-hashes {
    font-size: 10px;
    color: var(--vscode-descriptionForeground);
    font-family: var(--vscode-editor-font-family);
}

.verification-timestamp {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--vscode-panel-border);
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
    text-align: right;
}

.verification-success {
    border-color: var(--vscode-gitDecoration-addedResourceForeground);
}

.verification-warning {
    border-color: var(--vscode-gitDecoration-modifiedResourceForeground);
}

/* Sync Details Section Styles */
.sync-details-section {
    margin-top: 12px;
    border: 1px solid var(--vscode-panel-border);
    border-radius: 4px;
    overflow: hidden;
}

.sync-details-header {
    padding: 8px 12px;
    background: var(--vscode-list-inactiveSelectionBackground);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    user-select: none;
}

.sync-details-header:hover {
    background: var(--vscode-list-hoverBackground);
}

.sync-details-toggle {
    font-size: 10px;
    transition: transform 0.2s ease;
}

.sync-details-section.expanded .sync-details-toggle {
    transform: rotate(90deg);
}

.sync-details-title {
    font-weight: 600;
    font-size: 12px;
    flex: 1;
}

.sync-details-hint {
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
    font-style: italic;
}

.sync-details-status {
    font-size: 11px;
    font-weight: 500;
}

.sync-details-content {
    padding: 12px;
    background: var(--vscode-editor-background);
    border-top: 1px solid var(--vscode-panel-border);
}

.sync-details-summary {
    display: flex;
    gap: 16px;
    margin-bottom: 12px;
    padding: 8px;
    background: var(--vscode-textBlockQuote-background);
    border-radius: 4px;
    flex-wrap: wrap;
}

.sync-stat {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.sync-stat-label {
    font-size: 10px;
    color: var(--vscode-descriptionForeground);
}

.sync-stat-value {
    font-size: 16px;
    font-weight: bold;
}

.sync-stat-good .sync-stat-value {
    color: var(--vscode-gitDecoration-addedResourceForeground);
}

.sync-stat-warn .sync-stat-value {
    color: var(--vscode-gitDecoration-modifiedResourceForeground);
}

.sync-stat-timestamp {
    font-size: 10px;
    color: var(--vscode-descriptionForeground);
    margin-left: auto;
    align-self: center;
}

.sync-details-files {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.sync-file-detail {
    padding: 8px;
    border: 1px solid var(--vscode-panel-border);
    border-radius: 4px;
    background: var(--vscode-editor-background);
}

.sync-file-detail.sync-match {
    border-left: 3px solid var(--vscode-gitDecoration-addedResourceForeground);
}

.sync-file-detail.sync-mismatch {
    border-left: 3px solid var(--vscode-gitDecoration-modifiedResourceForeground);
    background: rgba(255, 165, 0, 0.05);
}

.sync-file-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.sync-file-icon {
    font-size: 14px;
}

.sync-file-name {
    font-weight: 500;
    font-size: 12px;
    font-family: var(--vscode-editor-font-family);
}

.sync-file-stats {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding-left: 22px;
}

.sync-file-stat {
    display: flex;
    gap: 8px;
    font-size: 11px;
    font-family: var(--vscode-editor-font-family);
}

.sync-file-stat-label {
    color: var(--vscode-descriptionForeground);
    min-width: 70px;
}

.sync-file-stat-value {
    color: var(--vscode-foreground);
}

.sync-match-indicator {
    color: var(--vscode-gitDecoration-addedResourceForeground);
}

.sync-mismatch-indicator {
    color: var(--vscode-gitDecoration-modifiedResourceForeground);
}

.sync-unknown-indicator {
    color: var(--vscode-descriptionForeground);
    font-style: italic;
    opacity: 0.7;
}

.sync-details-note {
    padding: 8px 12px;
    margin-bottom: 12px;
    background: rgba(100, 150, 200, 0.1);
    border-left: 3px solid var(--vscode-textLink-foreground);
    border-radius: 4px;
    font-size: 12px;
    color: var(--vscode-foreground);
}

.baseline-stat {
    background: rgba(100, 150, 200, 0.05);
    padding: 4px;
    border-radius: 3px;
    margin-bottom: 4px;
}

.baseline-stat .sync-file-stat-label {
    font-weight: 600;
    color: var(--vscode-textLink-foreground);
}

/* ============= Conflict Mode Styles ============= */

.file-manager-panel.resolve-mode {
    border-color: var(--vscode-gitDecoration-modifiedResourceForeground);
    border-width: 2px;
}

.conflict-subtitle {
    font-size: 12px;
    color: var(--vscode-gitDecoration-modifiedResourceForeground);
    font-weight: 600;
    padding: 2px 0 0 0;
}

/* Conflict file list table */
.conflict-file-list {
    padding: 8px;
}

.conflict-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
}

.conflict-table th {
    text-align: left;
    padding: 6px 8px;
    font-size: 11px;
    color: var(--vscode-descriptionForeground);
    border-bottom: 1px solid var(--vscode-panel-border);
    font-weight: 600;
}

.conflict-table td {
    padding: 8px;
    border-bottom: 1px solid var(--vscode-panel-border);
    vertical-align: middle;
}

.conflict-file-row.has-conflict {
    background: rgba(255, 165, 0, 0.05);
}

.conflict-file-row.no-conflict {
    opacity: 0.6;
}

.col-conflict-badge {
    white-space: nowrap;
}

.col-conflict-action {
    min-width: 180px;
}

.conflict-badge {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 10px;
    font-weight: 600;
}

.conflict-badge.conflict-external {
    background: rgba(210, 153, 34, 0.2);
    color: var(--vscode-gitDecoration-modifiedResourceForeground);
}

.conflict-badge.conflict-unsaved {
    background: rgba(47, 111, 235, 0.2);
    color: var(--vscode-textLink-foreground);
}

.conflict-badge.conflict-both {
    background: rgba(209, 36, 47, 0.2);
    color: var(--vscode-gitDecoration-deletedResourceForeground);
}

.conflict-badge.conflict-none {
    background: rgba(128, 128, 128, 0.1);
    color: var(--vscode-descriptionForeground);
}

.conflict-badge.conflict-running {
    background: rgba(210, 153, 34, 0.2);
    color: var(--vscode-testing-iconQueued, #d29922);
}

.conflict-badge.conflict-stale-action {
    background: rgba(209, 36, 47, 0.18);
    color: var(--vscode-testing-iconFailed, #f85149);
}

.conflict-badge.conflict-resolved {
    background: rgba(63, 185, 80, 0.2);
    color: var(--vscode-testing-iconPassed, #3fb950);
}

.conflict-action-select,
.col-action select {
    width: 100%;
    padding: 4px 6px;
    font-size: 11px;
    background: var(--vscode-dropdown-background);
    color: var(--vscode-dropdown-foreground);
    border: 1px solid var(--vscode-dropdown-border);
    border-radius: 3px;
    cursor: pointer;
}

.conflict-no-action {
    color: var(--vscode-descriptionForeground);
    font-size: 11px;
}

/* Marp Global Settings Button and Menu */
.marp-global-settings-btn {
  background: var(--button-background);
  color: var(--button-foreground);
  border: var(--button-border);
  cursor: pointer;
  padding: 2px 6px;
  font-size: 14px;
  line-height: 1;
  transition: all 0.2s;
  border-radius: 3px;
  height: 20px;
  min-width: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.marp-global-settings-btn:hover {
  background: var(--button-background-hover);
  color: var(--button-foreground-hover);
}

.marp-settings-icon {
  font-size: 13px;
}

.marp-global-settings-menu {
  position: absolute;
  top: 30px;
  left: 0;
  background: var(--vscode-dropdown-background);
  border: 1px solid var(--vscode-dropdown-border);
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  z-index: 5000;
  padding: 8px;
  min-width: 300px;
  max-width: 400px;
  max-height: 600px;
  overflow-y: auto;
}

.marp-settings-section {
  margin-bottom: 12px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--vscode-widget-border, rgba(128, 128, 128, 0.3));
}

.marp-settings-section:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

.marp-settings-header {
  font-weight: 600;
  font-size: 11px;
  color: var(--vscode-descriptionForeground);
  text-transform: uppercase;
  margin-bottom: 8px;
}

.marp-setting-item {
  margin-bottom: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.marp-setting-item label {
  font-size: 12px;
  color: var(--vscode-foreground);
  font-weight: 500;
}

.marp-setting-item input[type="text"],
.marp-setting-item select,
.marp-setting-item textarea {
  background: var(--vscode-input-background);
  color: var(--vscode-input-foreground);
  border: 1px solid var(--vscode-input-border, transparent);
  border-radius: 2px;
  padding: 4px 6px;
  font-size: 12px;
  font-family: var(--vscode-font-family);
  width: 100%;
}

.marp-setting-item input[type="text"]:focus,
.marp-setting-item select:focus,
.marp-setting-item textarea:focus {
  outline: 1px solid var(--vscode-focusBorder);
  outline-offset: -1px;
}

.marp-setting-item textarea {
  resize: vertical;
  min-height: 60px;
}

/* Marp Global Settings Burger Menu */
.marp-global-menu {
  position: relative;
  display: inline-block;
}

.marp-global-menu-btn {
  cursor: pointer;
  padding: 4px 4px;
  margin: 0;
  height: 22px;
  min-height: 22px;
  width: 22px;
  min-width: 22px;
  justify-content: center;
  gap: 4px;
  border-radius: 3px;
  display: flex;
  align-items: center;
  transition: all 0.2s;
}

/* Hide the  text in marp burger button and use CSS icon */
.marp-global-menu-btn .menu-icon {
  font-size: 0;
  width: 7px;
  height: 1px;
  background: currentColor;
  box-shadow: 0 -3px 0 currentColor, 0 3px 0 currentColor;
}

.marp-global-menu-dropdown {
  z-index: 5000;
  padding: 0;
  min-width: 320px;
  max-width: 450px;
  max-height: 70vh;
  overflow-y: auto;
}

.marp-global-menu.active .marp-global-menu-dropdown {
  display: block;
}

.marp-global-menu-item {
  padding: 4px 8px;
  cursor: pointer;
  font-size: 13px;
  color: var(--vscode-dropdown-foreground);
  border: none;
  background: none;
  width: 100%;
  text-align: left;
  position: relative;
  transition: background-color 0.2s;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 8px;
}

.marp-global-menu-item:hover {
  background: var(--vscode-list-hoverBackground);
  color: var(--vscode-list-hoverForeground);
}

.marp-global-menu-item .menu-icon {
  flex-shrink: 0;
  width: 16px;
  text-align: center;
}

.marp-global-menu-divider {
  height: 1px;
  background: var(--vscode-menu-separatorBackground, rgba(128, 128, 128, 0.35));
  margin: 4px 0;
}

/* PDF Slideshow Styles */

/* Wrapper for PDF slideshow with burger menu */
.pdf-slideshow-wrapper {
  position: relative;
  display: block;
  max-width: 100%;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

.pdf-slideshow-wrapper .image-menu-btn {
  position: absolute;
  top: 4px;
  right: 4px;
}

.pdf-slideshow {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin: 10px 0;
  max-width: 100%;
  width: 100%;
  box-sizing: border-box;
}

.pdf-slideshow-image {
  min-height: 100px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--vscode-editor-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 10px;
  max-width: 100%;
  overflow: hidden;
  box-sizing: border-box;
}

.pdf-slideshow-image img {
  max-width: 100%;
  height: auto;
  display: block;
  object-fit: contain;
}

.pdf-slideshow-loading {
  color: var(--vscode-foreground);
  padding: 20px;
  text-align: center;
}

.pdf-slideshow-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 8px;
  background: var(--vscode-editor-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  flex-wrap: wrap;
  max-width: 100%;
  box-sizing: border-box;
}

.image-path-menu-title {
  padding: 6px 10px;
  font-size: 12px;
  font-weight: 600;
  color: var(--vscode-foreground);
  border-bottom: 1px solid var(--vscode-menu-separatorBackground, #454545);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 250px;
}

.pdf-slideshow-btn {
  padding: 6px 12px;
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: none;
  border-radius: 3px;
  cursor: pointer;
  font-size: 13px;
  font-family: var(--vscode-font-family);
  transition: background 0.2s;
}

.pdf-slideshow-btn:hover:not(:disabled) {
  background: var(--vscode-button-hoverBackground);
}

.pdf-slideshow-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.pdf-slideshow-page-info {
  color: var(--vscode-foreground);
  font-size: 13px;
  font-family: var(--vscode-font-family);
  min-width: 100px;
  text-align: center;
}

/* ============================================================================
   TEMPLATE BAR STYLES
   ============================================================================ */

.template-bar {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 16px;
  background: var(--vscode-sideBar-background, #252526);
  border-bottom: 1px solid var(--vscode-panel-border, #3c3c3c);
  min-height: 40px;
  flex-shrink: 0;
}

.template-bar-label {
  color: var(--vscode-descriptionForeground, #888);
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  white-space: nowrap;
}

.template-items {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  align-items: center;
}

.template-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: var(--vscode-button-secondaryBackground, #3a3d41);
  color: var(--vscode-button-secondaryForeground, #fff);
  border: 1px solid var(--vscode-contrastBorder, transparent);
  border-radius: 4px;
  cursor: grab;
  font-size: 13px;
  font-family: var(--vscode-font-family);
  transition: background 0.15s, transform 0.15s, box-shadow 0.15s;
  user-select: none;
}

.template-item:hover {
  background: var(--vscode-button-secondaryHoverBackground, #45494e);
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.template-item:active {
  cursor: grabbing;
  transform: translateY(0);
}

.template-item.dragging {
  opacity: 0.5;
  cursor: grabbing;
}

.template-name {
  white-space: nowrap;
}

/* Template drop indicator - shown when dragging template over board */
.template-drop-indicator {
  position: absolute;
  width: 4px;
  background: var(--vscode-focusBorder, #007acc);
  border-radius: 2px;
  pointer-events: none;
  z-index: 1000;
  box-shadow: 0 0 8px var(--vscode-focusBorder, #007acc);
}

/* Column drop zone highlight when template is being dragged - same as column drag */
.column-drop-zone.template-drag-over {
  background: var(--vscode-editor-selectionBackground);
  border: 2px dashed var(--vscode-editor-selectionForeground);
  border-radius: 4px;
}

/* Template source in file-info header (next to clipboard/empty card) */
.template-source {
  display: flex;
  align-items: center;
  gap: 4px;
  border: var(--button-border);
  padding: 2px 4px;
  margin: 0;
  height: 22px;
  min-height: 22px;
  min-width: 22px;
  background: var(--button-alternative-background);
  color: var(--button-alternative-foreground);
  cursor: pointer;
  border-radius: 3px;
  font-size: 12px;
  white-space: nowrap;
}

.template-icon {
  font-size: 14px;
  line-height: 1;
}

.template-select {
  background: transparent;
  border: none;
  color: inherit;
  font-size: 12px;
  font-family: inherit;
  cursor: pointer;
  padding: 0 2px;
  max-width: 120px;
}

.template-select:focus {
  outline: none;
}

.template-select option {
  background: var(--vscode-dropdown-background, #3c3c3c);
  color: var(--vscode-dropdown-foreground, #fff);
}

.template-drag-handle {
  cursor: grab;
  padding: 0 4px;
  font-size: 12px;
  opacity: 0.6;
  user-select: none;
}

.template-drag-handle:hover {
  opacity: 1;
}

.template-drag-handle.dragging {
  cursor: grabbing;
  opacity: 0.4;
}

/* ============================================================================
   TEMPLATE VARIABLE DIALOG STYLES
   ============================================================================ */

.template-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  backdrop-filter: blur(2px);
}

.template-dialog {
  background: var(--vscode-editor-background, #1e1e1e);
  border: 1px solid var(--vscode-panel-border, #3c3c3c);
  border-radius: 6px;
  min-width: 400px;
  max-width: 600px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.template-dialog-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--vscode-panel-border, #3c3c3c);
}

.template-dialog-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--vscode-foreground);
}

.template-dialog-close {
  background: transparent;
  border: none;
  color: var(--vscode-foreground);
  font-size: 20px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  opacity: 0.7;
  transition: opacity 0.15s;
}

.template-dialog-close:hover {
  opacity: 1;
  background: var(--vscode-toolbar-hoverBackground, rgba(255, 255, 255, 0.1));
}

.template-dialog-form {
  padding: 20px;
  overflow-y: auto;
  flex: 1;
}

.template-dialog-field {
  margin-bottom: 16px;
}

.template-dialog-field:last-child {
  margin-bottom: 0;
}

.template-dialog-field label {
  display: block;
  margin-bottom: 6px;
  font-size: 13px;
  color: var(--vscode-foreground);
  font-weight: 500;
}

.template-dialog-field label .required {
  color: var(--vscode-errorForeground, #f14c4c);
}

.template-dialog-field input {
  width: 100%;
  padding: 8px 12px;
  font-size: 13px;
  font-family: var(--vscode-font-family);
  background: var(--vscode-input-background, #3c3c3c);
  color: var(--vscode-input-foreground, #fff);
  border: 1px solid var(--vscode-input-border, #3c3c3c);
  border-radius: 4px;
  transition: border-color 0.15s;
}

.template-dialog-field input:focus {
  outline: none;
  border-color: var(--vscode-focusBorder, #007acc);
}

.template-dialog-field input::placeholder {
  color: var(--vscode-input-placeholderForeground, #888);
}

.template-dialog-footer {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 16px 20px;
  border-top: 1px solid var(--vscode-panel-border, #3c3c3c);
}

.template-dialog-btn {
  padding: 8px 16px;
  font-size: 13px;
  font-family: var(--vscode-font-family);
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.15s;
}

.template-dialog-cancel {
  background: transparent;
  color: var(--vscode-foreground);
  border: 1px solid var(--vscode-button-secondaryBackground, #3a3d41);
}

.template-dialog-cancel:hover {
  background: var(--vscode-button-secondaryHoverBackground, #45494e);
}

.template-dialog-submit {
  background: var(--vscode-button-background, #0e639c);
  color: var(--vscode-button-foreground, #fff);
  border: none;
}

.template-dialog-submit:hover {
  background: var(--vscode-button-hoverBackground, #1177bb);
}

/* ============================================================================
   Tag Applied Flash Animation
   Used for visual feedback when a tag is applied to a column or task
   ============================================================================ */
@keyframes tag-applied-flash {
  0% { box-shadow: 0 0 8px rgba(0, 255, 0, 0.5); }
  100% { box-shadow: none; }
}

.tag-applied-flash {
  animation: tag-applied-flash 0.3s ease-out forwards;
}

/* ============================================================================
   Menu Count Badges
   Small count indicators shown in dropdown menus
   ============================================================================ */
.menu-count-badge {
  opacity: 0.7;
  margin-left: auto;
  padding-left: 10px;
}

/* ============================================================================
   Submenu Base Styles
   Base positioning for tag and other submenus
   ============================================================================ */
.donut-submenu {
  position: fixed;
  z-index: 5000;
  pointer-events: all;
  visibility: hidden;
  display: flex;
  flex-wrap: wrap;
}

.donut-submenu.visible {
  visibility: visible;
}

/* ============================================================================
   Pre-generated Font Size Classes
   Static font size multipliers for UI scaling
   ============================================================================ */

/* Font Size Classes - 0.5x */
body.font-size-0_5x .column-title,
body.font-size-0_5x .column-title-edit,
body.font-size-0_5x .card-title-display,
body.font-size-0_5x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 0.5) !important;
  line-height: 1.4 !important;
}

body.font-size-0_5x .card-description-display,
body.font-size-0_5x .card-description-edit,
body.font-size-0_5x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 0.45) !important;
  line-height: 1.4 !important;
}

/* Font Size Classes - 0.75x */
body.font-size-0_75x .column-title,
body.font-size-0_75x .column-title-edit,
body.font-size-0_75x .card-title-display,
body.font-size-0_75x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 0.75) !important;
  line-height: 1.4 !important;
}

body.font-size-0_75x .card-description-display,
body.font-size-0_75x .card-description-edit,
body.font-size-0_75x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 0.675) !important;
  line-height: 1.4 !important;
}

/* Font Size Classes - 1x (default) */
body.font-size-1x .column-title,
body.font-size-1x .column-title-edit,
body.font-size-1x .card-title-display,
body.font-size-1x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 1) !important;
  line-height: 1.4 !important;
}

body.font-size-1x .card-description-display,
body.font-size-1x .card-description-edit,
body.font-size-1x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 0.9) !important;
  line-height: 1.4 !important;
}

/* Font Size Classes - 1.25x */
body.font-size-1_25x .column-title,
body.font-size-1_25x .column-title-edit,
body.font-size-1_25x .card-title-display,
body.font-size-1_25x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 1.25) !important;
  line-height: 1.4 !important;
}

body.font-size-1_25x .card-description-display,
body.font-size-1_25x .card-description-edit,
body.font-size-1_25x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 1.125) !important;
  line-height: 1.4 !important;
}

/* Font Size Classes - 1.5x */
body.font-size-1_5x .column-title,
body.font-size-1_5x .column-title-edit,
body.font-size-1_5x .card-title-display,
body.font-size-1_5x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 1.5) !important;
  line-height: 1.2 !important;
}

body.font-size-1_5x .card-description-display,
body.font-size-1_5x .card-description-edit,
body.font-size-1_5x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 1.35) !important;
  line-height: 1.3 !important;
}

/* Font Size Classes - 2x */
body.font-size-2x .column-title,
body.font-size-2x .column-title-edit,
body.font-size-2x .card-title-display,
body.font-size-2x .card-title-edit {
  font-size: calc(var(--vscode-font-size, 14px) * 2) !important;
  line-height: 1.1 !important;
}

body.font-size-2x .card-description-display,
body.font-size-2x .card-description-edit,
body.font-size-2x .card-description-wysiwyg {
  font-size: calc(var(--vscode-font-size, 14px) * 1.8) !important;
  line-height: 1.15 !important;
}

/* ============================================================================
   File Search Modal Styles
   ============================================================================ */

.file-search-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: flex-start;
    z-index: var(--z-search-modal);
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: opacity 0.15s, visibility 0.15s;
}

.file-search-overlay.visible {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

.file-search-dialog {
    width: 80%;
    max-width: 1200px;
    min-width: 400px;
    height: 80vh;
    margin-top: 5vh;
    display: flex;
    flex-direction: column;
    background: var(--vscode-editor-background, #1e1e1e);
    border: 1px solid var(--vscode-widget-border, #454545);
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    transform: translateY(-20px);
    transition: transform 0.15s;
}

.file-search-overlay.visible .file-search-dialog {
    transform: translateY(0);
}

.file-search-header {
    padding: 16px 20px;
    background: var(--vscode-titleBar-activeBackground, #3c3c3c);
    border-bottom: 1px solid var(--vscode-widget-border, #454545);
}

.file-search-title {
    font-size: var(--vscode-font-size, 14px);
    font-weight: 600;
    font-family: var(--vscode-font-family);
    margin-bottom: 8px;
    color: var(--vscode-titleBar-activeForeground, #ffffff);
}

.file-search-subtitle {
    font-size: 12px;
    font-family: var(--vscode-editor-font-family, monospace);
    color: var(--vscode-descriptionForeground, #969696);
    /* Truncate from start, showing filename at end */
    display: block;
    max-height: calc(2 * 1.4em);
    line-height: 1.4em;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    direction: rtl;
    unicode-bidi: plaintext;  /* Preserve LTR text order within RTL container */
    cursor: default;
}

.file-search-subtitle:hover {
    max-height: none;
    overflow: visible;
    white-space: normal;
    word-break: break-all;
}

.file-search-source-file {
    font-size: 11px;
    font-family: var(--vscode-editor-font-family, monospace);
    color: var(--vscode-textLink-foreground, #3794ff);
    margin-top: 4px;
    display: block;
    max-height: 1.4em;
    line-height: 1.4em;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    direction: rtl;
    unicode-bidi: plaintext;
    cursor: default;
}

.file-search-source-file:hover {
    max-height: none;
    overflow: visible;
    white-space: normal;
    word-break: break-all;
}

.file-search-broken-info {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
}

.file-search-badge {
    background: var(--vscode-badge-background, #4d4d4d);
    color: var(--vscode-badge-foreground, #ffffff);
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 500;
}

.file-search-badge.warning {
    background: var(--vscode-inputValidation-warningBackground, #352a05);
    border: 1px solid var(--vscode-inputValidation-warningBorder, #be8c00);
    color: var(--vscode-inputValidation-warningForeground);
}

.file-search-input-container {
    padding: 12px 20px;
    background: var(--vscode-input-background, #3c3c3c);
    border-bottom: 1px solid var(--vscode-widget-border, #454545);
    display: flex;
    gap: 8px;
    align-items: center;
}

.file-search-input {
    flex: 1;
    padding: 8px 12px;
    font-size: var(--vscode-font-size, 14px);
    font-family: var(--vscode-font-family);
    border: 1px solid var(--vscode-input-border, #3c3c3c);
    background: var(--vscode-input-background, #3c3c3c);
    color: var(--vscode-input-foreground, #cccccc);
    border-radius: 4px;
    outline: none;
}

.file-search-input:focus {
    border-color: var(--vscode-focusBorder, #007acc);
}

/* Unified toggle button styles for file search */
.file-search-toggle-btn,
.file-search-preview-toggle {
    padding: 6px 10px;
    font-size: 12px;
    font-family: var(--vscode-font-family);
    border: 1px solid var(--vscode-button-border, transparent);
    background: var(--vscode-button-secondaryBackground, #3c3c3c);
    color: var(--vscode-button-secondaryForeground, #cccccc);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
}

.file-search-toggle-btn:hover,
.file-search-preview-toggle:hover {
    background: var(--vscode-button-secondaryHoverBackground, #4c4c4c);
}

.file-search-toggle-btn.active,
.file-search-preview-toggle.active {
    background: var(--vscode-button-background, #007acc);
    color: var(--vscode-button-foreground, #ffffff);
    border-color: var(--vscode-button-background, #007acc);
}

.file-search-results {
    flex: 1;
    overflow-y: auto;
    padding: 0;
}

.file-search-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
}

.file-search-table th {
    position: relative;
}

/* Column resize handle */
.col-resize-handle {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 8px;
    cursor: col-resize;
    background: transparent;
    border-right: 2px solid var(--vscode-widget-border, #454545);
    transition: border-color 0.15s;
}

.col-resize-handle:hover {
    border-right-color: var(--vscode-button-background, #007acc);
}

/* Disable pointer events on overlay background during resize */
.file-search-overlay.resizing {
    pointer-events: none;
}

.file-search-overlay.resizing .file-search-dialog {
    pointer-events: auto;
}

/* Filename column - compact with word wrap */
.file-search-table th:first-child,
.file-search-table td:first-child {
    word-break: break-word;
}

/* Path column - takes remaining space */
.file-search-table th:nth-child(2),
.file-search-table td:nth-child(2) {
    width: auto;
}

.file-search-table th {
    position: sticky;
    top: 0;
    background: var(--vscode-titleBar-activeBackground, #3c3c3c);
    padding: 8px 12px;
    text-align: left;
    font-size: 11px;
    font-weight: 600;
    font-family: var(--vscode-font-family);
    text-transform: uppercase;
    color: var(--vscode-descriptionForeground, #969696);
    border-bottom: 1px solid var(--vscode-widget-border, #454545);
}

.file-search-table td {
    padding: 8px 12px;
    vertical-align: top;
    border-bottom: 1px solid var(--vscode-widget-border, #333);
}

.file-search-table tr {
    cursor: pointer;
    transition: background 0.1s;
}

.file-search-table tbody tr:hover {
    background: var(--vscode-list-hoverBackground, #2a2d2e);
}

.file-search-table tr.selected {
    background: var(--vscode-list-activeSelectionBackground, #094771);
}

.file-search-result-label {
    font-size: 13px;
    font-weight: 500;
    font-family: var(--vscode-font-family);
    color: var(--vscode-foreground, #cccccc);
    word-break: break-word;
    /* Max 2 lines, show end of text (filename visible) */
    display: block;
    max-height: calc(2 * 1.4em);
    line-height: 1.4em;
    overflow: hidden;
    direction: rtl;
    text-align: left;
}

.file-search-table tr:hover .file-search-result-label {
    max-height: none;
    overflow: visible;
    direction: ltr;
}

.file-search-result-path {
    font-size: 11px;
    color: var(--vscode-descriptionForeground, #969696);
    word-break: break-all;
    font-family: var(--vscode-editor-font-family, monospace);
    margin-top: 2px;
}

.file-search-batch-count {
    text-align: center;
    font-size: 12px;
}

.file-search-batch-count .found {
    color: var(--vscode-charts-green, #89d185);
}

.file-search-batch-count .missing {
    color: var(--vscode-charts-red, #f48771);
}

.file-search-batch-count .scanning {
    color: var(--vscode-descriptionForeground, #969696);
    font-style: italic;
}

.file-search-batch-panel {
    padding: 12px 20px;
    background: var(--vscode-sideBar-background, #252526);
    border-top: 1px solid var(--vscode-widget-border, #454545);
    max-height: 10%;
    overflow-y: auto;
}

.file-search-batch-title {
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--vscode-foreground, #cccccc);
}

.file-search-batch-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.file-search-batch-item {
    font-size: 11px;
    padding: 3px 8px;
    border-radius: 3px;
    background: var(--vscode-badge-background, #4d4d4d);
    color: var(--vscode-badge-foreground, #ffffff);
}

.file-search-batch-item.can-replace {
    color: var(--vscode-inputValidation-infoForeground, #063b49);
    background: var(--vscode-inputValidation-infoBackground, #063b49);
    border: 1px solid var(--vscode-inputValidation-infoBorder, #007acc);
}

.file-search-batch-item.cannot-replace {
    color: var(--vscode-inputValidation-warningForeground, #352a05);
    background: var(--vscode-inputValidation-warningBackground, #352a05);
    border: 1px solid var(--vscode-inputValidation-warningBorder, #be8c00);
}

.file-search-status {
    padding: 20px;
    text-align: center;
    color: var(--vscode-descriptionForeground, #969696);
}

.file-search-status.searching::after {
    content: '';
    display: inline-block;
    width: 12px;
    height: 12px;
    border: 2px solid var(--vscode-progressBar-background, #007acc);
    border-top-color: transparent;
    border-radius: 50%;
    animation: file-search-spin 0.8s linear infinite;
    margin-left: 8px;
    vertical-align: middle;
}

@keyframes file-search-spin {
    to { transform: rotate(360deg); }
}

.file-search-options-row {
    padding: 10px 20px;
    background: var(--vscode-editor-background, #1e1e1e);
    border-top: 1px solid var(--vscode-widget-border, #454545);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    max-height: 10%;
}

.file-search-batch-option {
    display: flex;
    align-items: center;
    gap: 10px;
}

.file-search-batch-option label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-size: 13px;
}

.file-search-batch-option input[type="checkbox"] {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--vscode-button-background, #007acc);
}

.file-search-batch-info {
    font-size: 12px;
    color: var(--vscode-descriptionForeground, #969696);
    margin-left: auto;
    font-style: italic;
}

.file-search-path-format {
    display: flex;
    align-items: center;
    gap: 8px;
}

.file-search-path-format-label {
    font-size: 12px;
    color: var(--vscode-descriptionForeground, #969696);
}

.file-search-path-format-btns {
    display: flex;
    gap: 2px;
}

.file-search-format-btn {
    padding: 4px 10px;
    font-size: 11px;
    font-family: var(--vscode-font-family);
    border: 1px solid var(--vscode-button-secondaryBorder, #454545);
    background: var(--vscode-button-secondaryBackground, #3a3d41);
    color: var(--vscode-button-secondaryForeground, #cccccc);
    cursor: pointer;
    transition: all 0.1s;
}

.file-search-format-btn:first-child {
    border-radius: 3px 0 0 3px;
}

.file-search-format-btn:last-child {
    border-radius: 0 3px 3px 0;
}

.file-search-format-btn:hover {
    background: var(--vscode-button-secondaryHoverBackground, #45494e);
}

.file-search-format-btn.active {
    background: var(--vscode-button-background, #007acc);
    color: var(--vscode-button-foreground, #ffffff);
    border-color: var(--vscode-button-background, #007acc);
}

/* Path Preview */
.file-search-path-preview {
    padding: 10px 20px;
    background: var(--vscode-editor-background, #1e1e1e);
    border-top: 1px solid var(--vscode-widget-border, #454545);
    display: flex;
    align-items: center;
    gap: 8px;
    min-height: 36px;
    max-height: 15%;
}

.file-search-path-preview-label {
    font-size: 12px;
    font-family: var(--vscode-font-family);
    color: var(--vscode-descriptionForeground, #969696);
    flex-shrink: 0;
}

.file-search-path-preview-value {
    font-size: 12px;
    font-family: var(--vscode-editor-font-family, monospace);
    /* color: var(--vscode-textPreformat-foreground, #d7ba7d); */
    word-break: break-all;
    flex: 1;
    /* Max 2 lines with ellipsis */
    max-height: calc(2 * 1.4em);
    line-height: 1.4em;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: default;
}

.file-search-path-preview:hover .file-search-path-preview-value {
    max-height: none;
    overflow: visible;
}

.file-search-path-preview:not(.has-value) .file-search-path-preview-value {
    color: var(--vscode-descriptionForeground, #969696);
    font-style: italic;
    font-family: inherit;
}

.file-search-footer {
    padding: 12px 20px;
    background: var(--vscode-titleBar-activeBackground, #3c3c3c);
    border-top: 1px solid var(--vscode-widget-border, #454545);
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

.file-search-keyboard-hint {
    font-size: 11px;
    color: var(--vscode-descriptionForeground, #969696);
    margin-right: auto;
    display: flex;
    align-items: center;
    gap: 16px;
}

.file-search-keyboard-hint kbd {
    background: var(--vscode-keybindingLabel-background, #333);
    border: 1px solid var(--vscode-keybindingLabel-border, #444);
    border-radius: 3px;
    padding: 2px 6px;
    font-family: inherit;
    font-size: 11px;
}

/* Unified file search button styles - each variant is self-contained */
.file-search-btn,
.file-search-btn-primary,
.file-search-btn-secondary {
    padding: 8px 16px;
    font-size: 13px;
    font-family: var(--vscode-font-family);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
}

.file-search-btn,
.file-search-btn-secondary {
    background: var(--vscode-button-secondaryBackground, #3c3c3c);
    color: var(--vscode-button-secondaryForeground, #cccccc);
}

.file-search-btn:hover,
.file-search-btn-secondary:hover {
    background: var(--vscode-button-secondaryHoverBackground, #4c4c4c);
}

.file-search-btn-primary {
    background: var(--vscode-button-background, #007acc);
    color: var(--vscode-button-foreground, #ffffff);
}

.file-search-btn-primary:hover {
    background: var(--vscode-button-hoverBackground, #0062a3);
}

.file-search-btn:disabled,
.file-search-btn-primary:disabled,
.file-search-btn-secondary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Preview Toggle Button - layout-specific overrides (base styles in unified toggle rule) */
.file-search-preview-toggle {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-right: auto;
    margin-left: 16px;
}

.file-search-preview-toggle .preview-icon {
    font-size: 14px;
}

.file-search-preview-toggle .preview-label {
    font-size: 11px;
}

/* ========================================
   Search Highlight Styles
   Used by Kanban Search sidebar for highlighting search results
   ======================================== */

.search-highlight {
    animation: search-highlight-pulse 2s ease-out;
}

@keyframes search-highlight-pulse {
    0% {
        box-shadow: 0 0 0 4px var(--vscode-focusBorder, #007acc);
    }
    50% {
        box-shadow: 0 0 0 6px var(--vscode-focusBorder, #007acc);
    }
    100% {
        box-shadow: 0 0 0 0 transparent;
    }
}

/* Specific highlight for columns */
.column.search-highlight {
    border-radius: 8px;
}

/* Specific highlight for task cards */
.task-card.search-highlight {
    border-radius: 6px;
}

/* Inline text match highlight */
mark.search-text-match {
    background-color: var(--vscode-editor-findMatchHighlightBackground, #ffeb3b);
    color: var(--vscode-editor-foreground, inherit);
    padding: 1px 2px;
    border-radius: 2px;
    animation: text-match-pulse 1s ease-out 2;
}

@keyframes text-match-pulse {
    0%, 100% {
        background-color: var(--vscode-editor-findMatchHighlightBackground, #ffeb3b);
    }
    50% {
        background-color: var(--vscode-editor-findMatchBackground, #f59e0b);
    }
}

/* ============= Diff Column Styles ============= */

.col-diff {
    text-align: center;
    width: 40px;
    min-width: 40px;
}

.diff-checkbox {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--vscode-button-background);
}
